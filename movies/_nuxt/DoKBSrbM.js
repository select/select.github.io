import{E as y,c as o,o as s,af as V,N as S,r as v,al as T,G as z,k as P,F as b,w as N,a as l,J as n,O as f,z as t,t as c}from"./Ck9VlGs8.js";import{_ as R}from"./D-1NZnAu.js";import{g as D}from"./Bz8FWWbC.js";import{f as B}from"./DMOTkeJ5.js";import{u as E}from"./CrqnEE15.js";import{u as F}from"./PQilDTwg.js";const O={class:"block overflow-hidden"},$=y({__name:"MovieCardSkeleton",setup(e){return(x,d)=>(s(),o("div",O,[...d[0]||(d[0]=[V('<div class="aspect-[2/3] skeleton rounded-xl mb-3"></div><div class="space-y-2"><div class="h-5 skeleton rounded-lg w-3/4"></div><div class="flex items-center gap-2 pt-1"><div class="h-4 skeleton rounded-full w-12"></div><div class="h-4 skeleton rounded-full w-16"></div></div></div>',2)])]))}}),L=Object.assign($,{__name:"MovieCardSkeleton"}),U={class:"aspect-[2/3] bg-theme-selection relative flex-shrink-0 overflow-hidden"},W=["src","alt"],A={key:2,class:"w-full h-full flex items-center justify-center text-gray-400 dark:text-gray-600"},G={key:3,class:"absolute top-1.5 right-1.5 flex flex-col gap-1 items-end"},J={key:0,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-gray-800 dark:text-white font-medium"},Y={key:1,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-red-600 dark:text-red-400 font-bold"},q={key:2,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-gray-800 dark:text-white font-bold"},H={key:4,class:"absolute top-1.5 left-1.5 w-7 h-7 rounded-full glass flex items-center justify-center z-10"},K=["title"],Q={key:0,class:"absolute -bottom-1 -right-1 bg-theme-accent text-black text-[9px] font-black w-3.5 h-3.5 rounded-full flex items-center justify-center border border-theme-surface"},X={class:"p-3 flex-shrink-0"},Z={class:"font-bold text-sm line-clamp-2 mb-1.5 leading-snug min-h-[2.5rem]"},_={class:"flex items-center gap-1.5 text-[11px] text-theme-textmuted font-medium"},ee={key:0},te={key:1,class:"opacity-50"},ie={key:2,class:"flex items-center gap-1"},se={class:"font-bold text-theme-text"},oe={key:0,class:"text-[10px] opacity-70"},le={key:2,class:"flex flex-col border border-red-500/50 rounded-xl overflow-hidden bg-theme-surface text-theme-text opacity-50",title:"Invalid movie data: missing imdbId"},ne={class:"p-3 flex-shrink-0"},ae={class:"font-bold text-sm line-clamp-2 mb-1.5 leading-snug min-h-[2.5rem] text-red-400"},de=y({__name:"MovieCard",props:{movie:{}},setup(e){const x=e,{likedMovieIds:d}=S(E()),{getCollectionsForMovie:k}=F(),u=v(!1),a=v([]),r=v(!1),h=v(null),{start:w,stop:I}=T(async()=>{r.value=!0,x.movie.imdbId&&a.value.length===0&&(a.value=await k(x.movie.imdbId))},200,{immediate:!1}),{stop:p}=z(h,m=>{const i=m[0];i&&(i.isIntersecting?w():I())},{rootMargin:"200px"});P(()=>{p()});const C=m=>{u.value=!0;const i=m.target;i.style.display="none"};return(m,i)=>{const j=L,M=R;return e.movie.title?e.movie.imdbId?(s(),b(M,{key:1,ref_key:"cardRef",ref:h,to:`/movie/${e.movie.imdbId}`,class:"flex flex-col border border-theme-border/50 rounded-xl overflow-hidden hover:shadow-xl hover:-translate-y-1 transition-all duration-300 bg-theme-surface text-theme-text"},{default:N(()=>[l("div",U,[e.movie.imdbId?.startsWith("tt")?(s(),o("div",{key:0,class:f(["absolute inset-0 shimmer z-10 transition-opacity duration-500",{"opacity-0 pointer-events-none":t(u),"opacity-100":!t(u)}])},null,2)):n("",!0),t(r)&&e.movie.imdbId?.startsWith("tt")?(s(),o("img",{key:1,src:("getPosterPath"in m?m.getPosterPath:t(D))(e.movie.imdbId),alt:e.movie.title,class:f(["w-full h-full object-cover object-center transition-opacity duration-700",{"opacity-0":!t(u),"opacity-100":t(u)}]),loading:"lazy",onLoad:i[0]||(i[0]=g=>u.value=!0),onError:C},null,42,W)):(s(),o("div",A,[...i[1]||(i[1]=[l("div",{class:"i-mdi-movie text-6xl"},null,-1)])])),t(r)&&e.movie.sourceType?(s(),o("div",G,[e.movie.sourceType==="archive.org"?(s(),o("span",J," Archive.org ")):e.movie.sourceType==="youtube"?(s(),o("span",Y,c(e.movie.channelName||"YouTube"),1)):n("",!0),e.movie.language?(s(),o("span",q,c(e.movie.language.toUpperCase()),1)):n("",!0)])):n("",!0),t(r)&&e.movie.imdbId&&t(d).includes(e.movie.imdbId)?(s(),o("div",H,[...i[2]||(i[2]=[l("div",{class:"i-mdi-heart text-red-500 text-lg"},null,-1)])])):n("",!0),t(r)&&t(a).length>0?(s(),o("div",{key:5,class:f(["absolute top-1.5 left-1.5 w-7 h-7 rounded-full glass flex items-center justify-center z-10",{"ml-8":e.movie.imdbId&&t(d).includes(e.movie.imdbId)}]),title:t(a).map(g=>g.name).join(", ")},[i[3]||(i[3]=l("div",{class:"i-mdi:movie-roll text-theme-accent text-lg"},null,-1)),t(a).length>1?(s(),o("span",Q,c(t(a).length),1)):n("",!0)],10,K)):n("",!0),t(r)&&e.movie.verified?(s(),o("div",{key:6,class:f(["absolute top-1.5 left-1.5 w-7 h-7 rounded-full flex items-center justify-center z-10",{"ml-8":e.movie.imdbId&&t(d).includes(e.movie.imdbId)&&t(a).length===0||(!e.movie.imdbId||!t(d).includes(e.movie.imdbId))&&t(a).length>0,"ml-16":e.movie.imdbId&&t(d).includes(e.movie.imdbId)&&t(a).length>0}]),title:"Verified Source"},[...i[4]||(i[4]=[l("div",{class:"i-mdi-check-decagram text-green-600 text-2xl"},null,-1)])],2)):n("",!0)]),l("div",X,[l("h3",Z,c(e.movie.title),1),l("div",_,[e.movie.year?(s(),o("span",ee,c(e.movie.year),1)):n("",!0),t(r)&&e.movie.year&&e.movie.imdbRating?(s(),o("span",te,"â€¢")):n("",!0),t(r)&&e.movie.imdbRating?(s(),o("span",ie,[i[5]||(i[5]=l("div",{class:"i-mdi-star text-theme-accent text-xs"},null,-1)),l("span",se,c(e.movie.imdbRating),1),e.movie.imdbVotes?(s(),o("span",oe," ("+c(("formatVotes"in m?m.formatVotes:t(B))(e.movie.imdbVotes))+") ",1)):n("",!0)])):n("",!0)])])]),_:1},8,["to"])):(s(),o("div",le,[i[7]||(i[7]=l("div",{class:"aspect-[2/3] bg-theme-selection relative flex-shrink-0 overflow-hidden"},[l("div",{class:"w-full h-full flex items-center justify-center text-red-400"},[l("div",{class:"i-mdi-alert-circle text-6xl"})])],-1)),l("div",ne,[l("h3",ae,c(e.movie.title||"Unknown Movie"),1),i[6]||(i[6]=l("div",{class:"text-[11px] text-red-400 font-medium"},"Missing ID",-1))])])):(s(),b(j,{key:0}))}}}),xe=Object.assign(de,{__name:"MovieCard"});export{L as _,xe as a};
