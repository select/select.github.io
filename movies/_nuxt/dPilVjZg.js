import{_ as de}from"./CREm91b_.js";import{E as X,H as ce,e as B,r as R,B as we,J as me,c as o,a as e,L as F,t as h,z as t,d as A,M as z,N as G,a7 as oe,T as J,X as q,V as ae,W as fe,o as i,P as W,a2 as H,v as ve,l as ue,n as le,b as $,w as K,aj as pe,Y as he,G as xe,ak as $e,al as ke,am as ge,u as Se,an as Ce}from"./DGvbdLlG.js";import{u as te,g as be}from"./-HjnySIk.js";import{_ as Ie,a as Re,b as Te,c as Ve,d as Ae,e as Me,g as Fe,h as Ye,i as Ee,j as je,f as ie,F as ee}from"./BhthdBF0.js";import{f as ye}from"./DMOTkeJ5.js";import{i as Le}from"./BH85bPq3.js";import"./DhzU-HZj.js";const De={class:"space-y-4"},Qe={class:"flex items-center justify-between"},Oe={class:"flex items-center gap-3"},Ne={class:"px-2 py-0.5 text-sm font-mono text-theme-text"},Pe={class:"flex flex-wrap gap-2"},Ue=["onClick","onDragstart","onDragover","onDrop"],Be={key:0,class:"i-mdi-eye-off text-xs opacity-70"},Ke={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"},He={class:"bg-theme-surface rounded-2xl w-full max-w-lg shadow-2xl border border-theme-border overflow-hidden"},ze={class:"p-6 border-b border-theme-border flex items-center justify-between"},Ge={class:"text-xl font-bold"},We=["disabled"],Xe={class:"flex flex-wrap gap-2 p-3 bg-theme-background border border-theme-border rounded-lg min-h-[50px]"},Ze=["onClick"],Je={class:"relative flex-1 min-w-[120px]"},qe=["onKeydown"],et={key:0,class:"absolute z-10 left-0 right-0 mt-2 bg-theme-surface border border-theme-border rounded-lg shadow-xl max-h-48 overflow-y-auto"},tt=["onMousedown"],st={class:"pt-4 flex gap-3"},ot=["disabled"],it={key:0,class:"i-mdi-loading animate-spin mx-auto"},lt={key:1},nt=X({__name:"AdminCollectionSelector",emits:["select"],setup(P,{expose:D,emit:a}){const S=te(),{collections:M}=ce(S),r=B(()=>Array.from(M.value.values())),T=B(()=>r.value.filter(v=>v.enabled!==!1).length),x=R(""),k=a,Y=v=>{x.value=v,k("select",v)},s=R(null),c=R(null),m=v=>{s.value=v},C=v=>{c.value=v},Q=async v=>{if(s.value===null||s.value===v)return;const f=[...r.value],[w]=f.splice(s.value,1);if(!w)return;f.splice(v,0,w),await S.reorderCollections(f.map(Z=>Z.id))?H().showToast("Collections reordered"):H().showToast("Failed to reorder collections","error")},O=()=>{s.value=null,c.value=null},d=R(!1),N=R(null),b=R(!1),n=we({id:"",name:"",description:"",tags:[]}),_=R(""),p=R(!1),j=B(()=>{const v=new Set;return M.value.forEach(f=>{f.tags&&f.tags.forEach(w=>v.add(w))}),Array.from(v).sort()}),y=B(()=>{const v=_.value.toLowerCase().trim();return j.value.filter(f=>f.toLowerCase().includes(v)&&!n.tags.includes(f))}),I=()=>{const v=_.value.trim();v&&!n.tags.includes(v)&&(n.tags.push(v),_.value="")},u=v=>{n.tags=n.tags.filter(f=>f!==v)},l=()=>{_.value===""&&n.tags.length>0&&n.tags.pop()},g=v=>{n.tags.includes(v)||n.tags.push(v),_.value="",p.value=!1},E=()=>{setTimeout(()=>{p.value=!1},200)},se=v=>{N.value=v,n.id=v.id,n.name=v.name,n.description=v.description,n.tags=[...v.tags||[]]},L=()=>{d.value=!1,N.value=null,n.id="",n.name="",n.description="",n.tags=[],_.value="",p.value=!1},U=async()=>{b.value=!0;try{N.value?(await $fetch("/api/admin/collections/update-collection",{method:"POST",body:{collectionId:n.id,updates:{name:n.name,description:n.description,tags:{action:"set",values:n.tags}}}})).success&&(await S.loadCollections(),L()):(await $fetch("/api/admin/collections/create",{method:"POST",body:n})).success&&(await S.loadCollections(),L())}catch{}finally{b.value=!1}},ne=async v=>{if(confirm(`Are you sure you want to delete the collection "${v.name}"? This cannot be undone.`))try{(await $fetch("/api/admin/collections/delete",{method:"POST",body:{id:v.id}})).success&&(x.value===v.id&&(x.value="",k("select","")),await S.loadCollections())}catch{}},re=async v=>{const f=v.enabled===!1;try{(await $fetch("/api/admin/collections/update-collection",{method:"POST",body:{collectionId:v.id,updates:{enabled:f}}})).success&&await S.loadCollections()}catch{}};return me(async()=>{S.isLoaded||await S.loadCollections()}),D({editCollection:se,toggleEnabled:re,confirmDelete:ne,openCreateModal:()=>d.value=!0}),(v,f)=>(i(),o("div",De,[e("div",Qe,[e("div",Oe,[f[6]||(f[6]=e("label",{class:"block text-sm font-bold text-theme-textmuted uppercase tracking-wider"}," Select Collection ",-1)),e("span",Ne,h(t(T))+"/"+h(t(r).length),1)]),e("button",{class:"px-3 py-1.5 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-xs font-bold transition-colors flex items-center gap-2",onClick:f[0]||(f[0]=w=>d.value=!0)},[...f[7]||(f[7]=[e("div",{class:"i-mdi-plus"},null,-1),A(" Create New ",-1)])])]),e("div",Pe,[(i(!0),o(z,null,G(t(r),(w,V)=>(i(),o("button",{key:w.id,draggable:"true",class:W(["px-4 py-2 rounded-xl border transition-all text-sm font-bold flex items-center gap-2 cursor-move",[t(x)===w.id?"bg-blue-600 text-white border-blue-600 shadow-lg shadow-blue-600/20":"bg-theme-surface border-theme-border hover:border-theme-textmuted text-theme-text",w.enabled===!1?"opacity-60":"",t(s)===V?"opacity-20":"",t(c)===V?"border-blue-500 border-2":""]]),onClick:Z=>Y(w.id),onDragstart:Z=>m(V),onDragover:oe(Z=>C(V),["prevent"]),onDrop:Z=>Q(V),onDragend:O},[A(h(w.name)+" ",1),w.enabled===!1?(i(),o("div",Be)):F("",!0)],42,Ue))),128))]),t(d)||t(N)?(i(),o("div",Ke,[e("div",He,[e("div",ze,[e("h3",Ge,h(t(N)?"Edit Collection":"Create New Collection"),1),e("button",{class:"p-2 hover:bg-theme-selection rounded-full transition-colors",onClick:L},[...f[8]||(f[8]=[e("div",{class:"i-mdi-close text-xl"},null,-1)])])]),e("form",{class:"p-6 space-y-4",onSubmit:oe(U,["prevent"])},[e("div",null,[f[9]||(f[9]=e("label",{class:"block text-sm font-bold mb-1"},"ID (URL Slug)",-1)),J(e("input",{"onUpdate:modelValue":f[1]||(f[1]=w=>t(n).id=w),type:"text",placeholder:"e.g. charlie-chaplin",class:"w-full px-4 py-2 rounded-lg border border-theme-border bg-theme-surface text-sm font-mono",disabled:!!t(N),required:""},null,8,We),[[q,t(n).id]])]),e("div",null,[f[10]||(f[10]=e("label",{class:"block text-sm font-bold mb-1"},"Name",-1)),J(e("input",{"onUpdate:modelValue":f[2]||(f[2]=w=>t(n).name=w),type:"text",placeholder:"e.g. Charlie Chaplin",class:"w-full px-4 py-2 rounded-lg border border-theme-border bg-theme-surface text-sm",required:""},null,512),[[q,t(n).name]])]),e("div",null,[f[11]||(f[11]=e("label",{class:"block text-sm font-bold mb-1"},"Description",-1)),J(e("textarea",{"onUpdate:modelValue":f[3]||(f[3]=w=>t(n).description=w),rows:"3",placeholder:"Describe this collection...",class:"w-full px-4 py-2 rounded-lg border border-theme-border bg-theme-surface text-sm"},null,512),[[q,t(n).description]])]),e("div",null,[f[13]||(f[13]=e("label",{class:"block text-sm font-bold mb-1"},"Tags",-1)),e("div",Xe,[(i(!0),o(z,null,G(t(n).tags,w=>(i(),o("div",{key:w,class:"flex items-center gap-1.5 px-3 py-1 bg-blue-600/10 text-blue-600 dark:text-blue-400 border border-blue-600/20 rounded-full text-sm font-medium group"},[A(h(w)+" ",1),e("button",{type:"button",class:"p-0.5 hover:bg-blue-600/20 rounded-full transition-colors",onClick:V=>u(w)},[...f[12]||(f[12]=[e("div",{class:"i-mdi-close text-xs"},null,-1)])],8,Ze)]))),128)),e("div",Je,[J(e("input",{"onUpdate:modelValue":f[4]||(f[4]=w=>fe(_)?_.value=w:null),type:"text",placeholder:"Add tag...",class:"w-full bg-transparent border-none focus:ring-0 text-sm py-1",onKeydown:[ae(oe(I,["prevent"]),["enter"]),ae(l,["backspace"])],onFocus:f[5]||(f[5]=w=>p.value=!0),onBlur:E},null,40,qe),[[q,t(_)]]),t(p)&&t(y).length>0?(i(),o("div",et,[(i(!0),o(z,null,G(t(y),w=>(i(),o("button",{key:w,type:"button",class:"w-full text-left px-4 py-2 text-sm hover:bg-theme-selection transition-colors",onMousedown:oe(V=>g(w),["prevent"])},h(w),41,tt))),128))])):F("",!0)])])]),e("div",st,[e("button",{type:"button",class:"flex-1 px-4 py-2 border border-theme-border rounded-lg font-bold hover:bg-theme-selection transition-colors",onClick:L}," Cancel "),e("button",{type:"submit",class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-500 transition-colors disabled:opacity-50",disabled:t(b)},[t(b)?(i(),o("div",it)):(i(),o("span",lt,h(t(N)?"Update":"Create"),1))],8,ot)])],32)])])):F("",!0)]))}}),rt=Object.assign(nt,{__name:"AdminCollectionSelector"}),at={class:"space-y-4"},dt={class:"flex items-center gap-4"},ct={class:"relative flex-1"},ut={class:"absolute inset-y-0 left-2 flex items-center z-10"},mt={key:0,class:"pl-2 pr-1"},ft=["placeholder"],vt={class:"absolute inset-y-0 right-0 flex items-center pr-2 z-10"},pt={class:"flex flex-wrap items-center gap-2 pb-1"},ht=X({__name:"AdminSearchHeader",props:{filters:{},isFiltering:{type:Boolean}},emits:["search"],setup(P,{emit:D}){const a=P,S=D,r=ue(ee,null)||ve(a,"filters");pe(ee,r);const T=R(null),x=R(r.value.searchQuery),k=R(null),Y=R(null),s=(u,l)=>{k.value===u?(k.value=null,Y.value=null):(k.value=u,Y.value=l.currentTarget)},c=()=>{k.value=null,Y.value=null},m=B(()=>a.filters.sort.field==="year"&&a.filters.sort.direction==="desc"),C=B(()=>{if(m.value)return"";const u=a.filters.sort.field,l=a.filters.sort.direction;return u==="relevance"?"Relevance":u==="year"?l==="desc"?"Newest":"Oldest":u==="rating"?l==="desc"?"High":"Low":u==="title"?l==="asc"?"A-Z":"Z-A":u==="votes"?"Popular":""}),Q=B(()=>{const u=a.filters.minYear,l=a.filters.maxYear;return u&&l&&u!==1910&&l!==2025?`${u}-${l}`:u&&u!==1910?`${u}+`:l&&l!==2025?`Up to ${l}`:""}),O=B(()=>{const u=a.filters.minVotes,l=a.filters.maxVotes;return u&&l&&l<1e6?`${ie(u)}-${ie(l)}`:u?`${ie(u)}+`:l&&l<1e6?`< ${ie(l)}`:""}),d=B(()=>a.filters.searchMode==="semantic"?"Describe what you want to watch...":"Search movies... (try: actor:Roy Rogers, director:Dave Fleischer)"),N=B(()=>{const u=a.filters;return u.sources.length>0||u.minRating>0||u.minYear>0||u.minVotes>0||u.genres.length>0||u.countries.length>0}),b=()=>{r.value.sort={field:"year",direction:"desc"}},n=()=>{r.value.minYear=0,r.value.maxYear=0},_=()=>{r.value.minVotes=0,r.value.maxVotes=0},p=()=>{Object.assign(r.value,{sort:{field:"year",direction:"desc"},sources:[],minRating:0,minYear:0,maxYear:0,minVotes:0,maxVotes:0,genres:[],countries:[],searchQuery:"",searchMode:"exact"}),x.value=""},j=he(u=>{r.value.searchQuery=u,u&&r.value.sort.field!=="relevance"&&(r.value.sort={field:"relevance",direction:"desc"}),S("search")},500);le(x,u=>{j(u)}),le(()=>r.value.searchQuery,u=>{u!==x.value&&(x.value=u)});const y=()=>{S("search")},I=()=>{x.value=""};return(u,l)=>{const g=Ie,E=Re,se=Te,L=Ve,U=Ae,ne=Me,re=Fe,v=Ye,f=Ee,w=je;return i(),o("div",at,[e("div",dt,[e("div",ct,[e("div",ut,[P.isFiltering?(i(),o("div",mt,[...l[13]||(l[13]=[e("div",{class:"i-mdi-loading animate-spin text-lg text-theme-primary"},null,-1)])])):F("",!0),$(g)]),J(e("input",{ref_key:"searchInput",ref:T,"onUpdate:modelValue":l[0]||(l[0]=V=>fe(x)?x.value=V:null),type:"text",class:"block w-full pl-32 md:pl-36 pr-12 py-3 bg-theme-background border-2 border-theme-border/50 focus:border-theme-primary rounded-2xl text-lg text-theme-text placeholder-theme-text-muted focus:outline-none transition-all shadow-sm",placeholder:t(d),onKeydown:ae(y,["enter"])},null,40,ft),[[q,t(x)]]),e("div",vt,[t(x)?(i(),o("button",{key:0,class:"p-2 hover:bg-theme-surface rounded-full transition-colors",title:"Clear search",onClick:I},[...l[14]||(l[14]=[e("div",{class:"i-mdi-close text-xl text-theme-textmuted hover:text-theme-text"},null,-1)])])):F("",!0),e("button",{class:"p-2 hover:bg-theme-surface rounded-full transition-colors group",title:"Search tips",onClick:l[1]||(l[1]=V=>s("help",V))},[...l[15]||(l[15]=[e("div",{class:"i-mdi-help-circle-outline text-xl text-theme-textmuted group-hover:text-theme-primary transition-colors"},null,-1)])])])])]),e("div",pt,[$(E,{category:"Sort",icon:"i-mdi-sort","active-value":t(C),"is-active":!t(m),onClick:l[2]||(l[2]=V=>s("sort",V)),onClear:b},null,8,["active-value","is-active"]),$(E,{category:"Rating",icon:"i-mdi-star","active-value":t(r).minRating>0?`${t(r).minRating.toFixed(1)}+`:"","is-active":t(r).minRating>0,onClick:l[3]||(l[3]=V=>s("rating",V)),onClear:l[4]||(l[4]=()=>{t(r).minRating=0})},null,8,["active-value","is-active"]),$(E,{category:"Year",icon:"i-mdi-calendar","active-value":t(Q),"is-active":t(r).minYear>0||(t(r).maxYear??0)>0,onClick:l[5]||(l[5]=V=>s("year",V)),onClear:n},null,8,["active-value","is-active"]),$(E,{category:"Votes",icon:"i-mdi-account-group","active-value":t(O),"is-active":t(r).minVotes>0||(t(r).maxVotes??0)>0&&(t(r).maxVotes??0)<1e6,onClick:l[6]||(l[6]=V=>s("votes",V)),onClear:_},null,8,["active-value","is-active"]),$(E,{category:"Genres",icon:"i-mdi-movie-filter","active-value":t(r).genres.length>0?t(r).genres.length:"","is-active":t(r).genres.length>0,onClick:l[7]||(l[7]=V=>s("genres",V)),onClear:l[8]||(l[8]=()=>{t(r).genres=[]})},null,8,["active-value","is-active"]),$(E,{category:"Countries",icon:"i-mdi-earth","active-value":t(r).countries.length>0?t(r).countries.length:"","is-active":t(r).countries.length>0,onClick:l[9]||(l[9]=V=>s("countries",V)),onClear:l[10]||(l[10]=()=>{t(r).countries=[]})},null,8,["active-value","is-active"]),$(E,{category:"Source",icon:"i-mdi-source-branch","active-value":t(r).sources.length>0?t(r).sources.length:"","is-active":t(r).sources.length>0,onClick:l[11]||(l[11]=V=>s("source",V)),onClear:l[12]||(l[12]=()=>{t(r).sources=[]})},null,8,["active-value","is-active"]),t(N)?(i(),o("button",{key:0,class:"text-xs font-bold text-theme-primary hover:bg-theme-primary/10 px-3 py-1.5 rounded-full transition-colors whitespace-nowrap md:ml-auto",onClick:p}," Clear All ")):F("",!0)]),$(L,{"is-open":t(k)==="sort",title:"Sort By","anchor-el":t(Y),onClose:c},{default:K(()=>[$(se)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="rating",title:"Minimum Rating","anchor-el":t(Y),onClose:c},{default:K(()=>[$(U)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="year",title:"Year Range","anchor-el":t(Y),onClose:c},{default:K(()=>[$(ne)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="votes",title:"Votes Range","anchor-el":t(Y),onClose:c},{default:K(()=>[$(re)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="genres",title:"Genres","anchor-el":t(Y),onClose:c},{default:K(()=>[$(v)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="countries",title:"Countries","anchor-el":t(Y),onClose:c},{default:K(()=>[$(f)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="source",title:"Sources","anchor-el":t(Y),onClose:c},{default:K(()=>[$(w)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="help",title:"Search Tips","anchor-el":t(Y),onClose:c},{default:K(()=>[...l[16]||(l[16]=[e("div",{class:"p-4 max-w-xs space-y-3 text-sm"},[e("p",{class:"text-theme-textmuted"},"Use keywords for field-specific search:"),e("ul",{class:"space-y-2"},[e("li",{class:"flex items-center gap-2"},[e("code",{class:"bg-theme-background px-1.5 py-0.5 rounded text-theme-primary font-mono"},"actor:"),e("span",{class:"text-theme-text"},"Search by actor")]),e("li",{class:"flex items-center gap-2"},[e("code",{class:"bg-theme-background px-1.5 py-0.5 rounded text-theme-primary font-mono"},"director:"),e("span",{class:"text-theme-text"},"Search by director")]),e("li",{class:"flex items-center gap-2"},[e("code",{class:"bg-theme-background px-1.5 py-0.5 rounded text-theme-primary font-mono"},"writer:"),e("span",{class:"text-theme-text"},"Search by writer")]),e("li",{class:"flex items-center gap-2"},[e("code",{class:"bg-theme-background px-1.5 py-0.5 rounded text-theme-primary font-mono"},"title:"),e("span",{class:"text-theme-text"},"Search by title")])]),e("div",{class:"pt-2 border-t border-theme-border"},[e("p",{class:"text-theme-textmuted mb-1"},"Use quotes for spaces:"),e("code",{class:"block bg-theme-background p-2 rounded text-theme-primary font-mono"},'actor:"Roy Rogers"')]),e("div",{class:"pt-2 border-t border-theme-border"},[e("p",{class:"text-theme-textmuted mb-1"},"Combine multiple keywords:"),e("code",{class:"block bg-theme-background p-2 rounded text-theme-primary font-mono"},"actor:Keanu title:Matrix")])],-1)])]),_:1},8,["is-open","anchor-el"])])}}}),xt=Object.assign(ht,{__name:"AdminSearchHeader"}),_e=()=>{const P={sort:{field:"year",direction:"desc"},sources:[],minRating:0,minYear:0,maxYear:0,minVotes:0,maxVotes:0,genres:[],countries:[],searchQuery:"",searchMode:"exact"},D=R({...P}),a=B(()=>{let r=0;return D.value.sources.length>0&&r++,D.value.minRating>0&&r++,D.value.minYear>0&&r++,D.value.minVotes>0&&r++,D.value.genres.length>0&&r++,D.value.countries.length>0&&r++,r}),S=B(()=>a.value>0);return{filters:D,activeFiltersCount:a,hasActiveFilters:S,resetFilters:()=>{D.value={...P}}}},gt={class:"space-y-4"},bt={key:0,class:"bg-theme-surface border border-theme-border rounded-2xl overflow-hidden"},yt={class:"p-4 border-b border-theme-border flex items-center justify-between bg-theme-bg/30"},_t={class:"text-sm text-theme-textmuted"},wt={class:"font-semibold text-theme-text"},$t={key:0,class:"text-xs"},kt=["disabled"],St={key:0,class:"i-mdi-loading animate-spin"},Ct={key:1,class:"i-mdi-plus-box-multiple"},It={class:"divide-y divide-theme-border"},Rt={class:"w-12 h-16 rounded bg-theme-selection relative overflow-hidden flex-shrink-0"},Tt=["src","alt"],Vt={key:1,class:"w-full h-full flex items-center justify-center text-gray-400 dark:text-gray-600"},At={class:"flex-1 min-w-0"},Mt={class:"flex items-center gap-2"},Ft={class:"font-bold truncate"},Yt={class:"text-xs text-theme-textmuted font-mono"},Et={class:"text-xs text-theme-textmuted truncate"},jt={class:"flex items-center gap-2 text-[10px] text-theme-textmuted mt-0.5"},Lt={class:"font-mono"},Dt={key:0,class:"flex items-center gap-1"},Qt={class:"font-bold text-theme-text"},Ot={key:0,class:"opacity-70"},Nt=["disabled","onClick"],Pt={key:0,class:"i-mdi-loading animate-spin"},Ut={key:1,class:"p-8 text-center text-theme-textmuted bg-theme-surface border border-theme-border border-dashed rounded-2xl"},Bt=X({__name:"AdminMovieSearch",props:{collectionId:{},filters:{}},emits:["add"],setup(P,{expose:D,emit:a}){const S=P,M=a,r=te(),T=xe(),x=H(),k=ue(ee,null),{filters:Y}=_e(),s=B(()=>S.filters||k?.value||Y.value),c=B(()=>{const y=s.value;return y.sources.length>0||y.minRating>0||y.minYear>0||y.minVotes>0||y.genres.length>0||y.countries.length>0}),m=R([]),C=R(!1),Q=R(""),O=R(!1),d=R(!1),N=y=>{m.value=y,d.value=!0,s.value.searchQuery=""};$e("/",y=>{const I=window.document.activeElement,u=I?.tagName==="INPUT"||I?.tagName==="TEXTAREA";y.preventDefault(),u||document.querySelector('input[type="text"]')?.focus()});const b=async()=>{const y=s.value.searchQuery.length>=3,I=c.value;if(!y&&!I){m.value=[];return}C.value=!0,d.value=!1;try{let u=[];if(s.value.searchMode==="semantic"&&s.value.searchQuery){const l=ke(),g=[],E=[];if(s.value.minRating>0&&(g.push("m.imdbRating >= ?"),E.push(s.value.minRating)),s.value.minYear>0&&(g.push("m.year >= ?"),E.push(s.value.minYear)),(s.value.maxYear??0)>0&&(g.push("m.year <= ?"),E.push(s.value.maxYear)),s.value.minVotes>0&&(g.push("m.imdbVotes >= ?"),E.push(s.value.minVotes)),(s.value.maxVotes??0)>0&&(g.push("m.imdbVotes <= ?"),E.push(s.value.maxVotes)),s.value.genres.length>0){const L=s.value.genres.map(()=>"(m.genre LIKE ? OR m.genre LIKE ? OR m.genre LIKE ? OR m.genre = ?)");g.push(`(${L.join(" OR ")})`),s.value.genres.forEach(U=>{E.push(`${U},%`,`%, ${U},%`,`%, ${U}`,U)})}if(s.value.countries.length>0){const L=s.value.countries.map(()=>"(m.country LIKE ? OR m.country LIKE ? OR m.country LIKE ? OR m.country = ?)");g.push(`(${L.join(" OR ")})`),s.value.countries.forEach(U=>{E.push(`${U},%`,`%, ${U},%`,`%, ${U}`,U)})}if(s.value.sources.length>0){const L=[];s.value.sources.forEach(U=>{U==="archive.org"?(L.push("m.primarySourceType = ?"),E.push("archive.org")):(L.push("(m.primarySourceType = ? AND m.primaryChannelName = ?)"),E.push("youtube",U))}),g.push(`(${L.join(" OR ")})`)}u=await l.search(s.value.searchQuery,300,g.length>0?g.join(" AND "):void 0,g.length>0?E:void 0)}else u=await $fetch("/api/admin/movies/search",{query:{q:s.value.searchQuery,minRating:s.value.minRating||void 0,minYear:s.value.minYear||void 0,maxYear:s.value.maxYear||void 0,minVotes:s.value.minVotes||void 0,maxVotes:s.value.maxVotes||void 0,genres:s.value.genres.join(",")||void 0,countries:s.value.countries.join(",")||void 0,sources:s.value.sources.join(",")||void 0}});m.value=u.slice(0,300).map(T.mapMovieToLightweight)}catch{x.showToast("Search failed","error")}finally{C.value=!1}},n=he(b,300);le(()=>s.value,()=>{n()},{deep:!0});const _=y=>r.isMovieInCollection(y,S.collectionId),p=async y=>{Q.value=y;try{await r.addMovieToCollection(S.collectionId,y)?(x.showToast("Movie added to collection"),M("add")):x.showToast("Failed to add movie","error")}catch{x.showToast("Error adding movie","error")}finally{Q.value=""}},j=async()=>{O.value=!0;let y=0,I=0;try{const u=m.value.filter(l=>!_(l.movieId));if(u.length===0){x.showToast("All movies are already in the collection","info");return}for(const l of u)try{await r.addMovieToCollection(S.collectionId,l.movieId)?y++:I++}catch{I++}y>0&&(x.showToast(`Added ${y} movie${y>1?"s":""} to collection`),M("add")),I>0&&x.showToast(`Failed to add ${I} movie${I>1?"s":""}`,"error")}finally{O.value=!1}};return D({setExternalResults:N}),(y,I)=>{const u=xt,l=de;return i(),o("div",gt,[$(u,{filters:t(s),"is-filtering":t(C),onSearch:b},null,8,["filters","is-filtering"]),t(m).length>0?(i(),o("div",bt,[e("div",yt,[e("div",_t,[e("span",wt,h(t(m).length),1),A(" "+h(t(d)?"similar movies found":"results")+" ",1),t(m).length===300?(i(),o("span",$t,"(limited to 300)")):F("",!0)]),e("button",{class:W(["px-4 py-2 rounded-lg text-sm font-bold transition-all flex items-center gap-2 disabled:opacity-50",t(O)?"bg-theme-selection text-theme-textmuted cursor-wait":"bg-blue-600 hover:bg-blue-500 text-white"]),disabled:t(O)||t(Q)!=="",onClick:j},[t(O)?(i(),o("div",St)):(i(),o("div",Ct)),I[1]||(I[1]=A(" Add All to Collection ",-1))],10,kt)]),e("div",It,[(i(!0),o(z,null,G(t(m),g=>(i(),o("div",{key:g.movieId,class:"p-4 flex items-center gap-4 hover:bg-theme-bg/50 transition-colors"},[e("div",Rt,[g.movieId?.startsWith("tt")?(i(),o("img",{key:0,src:("getPosterPath"in y?y.getPosterPath:t(be))(g.movieId),alt:g.title,class:"w-full h-full object-cover",onError:I[0]||(I[0]=E=>E.target.style.display="none")},null,40,Tt)):(i(),o("div",Vt,[...I[2]||(I[2]=[e("div",{class:"i-mdi-movie text-2xl"},null,-1)])]))]),e("div",At,[e("div",Mt,[e("h4",Ft,[$(l,{to:`/movie/${g.movieId}`,target:"_blank",class:"hover:text-blue-600 transition-colors"},{default:K(()=>[A(h(g.title),1)]),_:2},1032,["to"])]),e("span",Yt,h(g.year),1)]),e("p",Et,h(g.genre||"Unknown Genre"),1),e("div",jt,[e("span",Lt,h(g.movieId),1),g.imdbRating?(i(),o("span",Dt,[I[3]||(I[3]=e("span",{class:"opacity-50"},"•",-1)),I[4]||(I[4]=e("div",{class:"i-mdi-star text-theme-accent text-xs"},null,-1)),e("span",Qt,h(g.imdbRating),1),g.imdbVotes?(i(),o("span",Ot," ("+h(("formatVotes"in y?y.formatVotes:t(ye))(g.imdbVotes))+") ",1)):F("",!0)])):F("",!0)])]),e("button",{class:W(["px-3 py-1.5 rounded-lg text-xs font-bold transition-all flex items-center gap-1.5 disabled:opacity-50",_(g.movieId)?"bg-theme-selection text-theme-textmuted cursor-default":"bg-blue-600 hover:bg-blue-500 text-white"]),disabled:_(g.movieId)||t(Q)===g.movieId,onClick:E=>p(g.movieId)},[t(Q)===g.movieId?(i(),o("div",Pt)):(i(),o("div",{key:1,class:W(_(g.movieId)?"i-mdi-check":"i-mdi-plus")},null,2)),A(" "+h(_(g.movieId)?"Added":"Add"),1)],10,Nt)]))),128))])])):(t(s).searchQuery.length>=3||t(c))&&!t(C)?(i(),o("div",Ut," No movies found"+h(t(s).searchQuery?` for "${t(s).searchQuery}"`:"")+h(t(c)?" with current filters":""),1)):F("",!0)])}}}),Kt=Object.assign(Bt,{__name:"AdminMovieSearch"}),Ht={class:"space-y-4"},zt={key:0,class:"text-sm text-theme-textmuted italic p-4 bg-theme-surface border border-theme-border border-dashed rounded-xl text-center"},Gt={key:1,class:"space-y-3"},Wt={class:"flex items-start justify-between gap-4"},Xt={class:"flex-1 space-y-2"},Zt={class:"flex items-center gap-2"},Jt={class:"font-bold text-sm"},qt={key:0,class:"px-2 py-0.5 bg-blue-600/10 text-blue-600 border border-blue-600/20 rounded text-[10px] font-bold flex items-center gap-1"},es={class:"flex flex-wrap gap-2"},ts={key:0,class:"px-2 py-0.5 bg-theme-bg border border-theme-border rounded text-[10px] font-mono flex items-center gap-1"},ss={key:1,class:"px-2 py-0.5 bg-theme-bg border border-theme-border rounded text-[10px] font-mono flex items-center gap-1"},os={key:2,class:"px-2 py-0.5 bg-theme-bg border border-theme-border rounded text-[10px] font-mono flex items-center gap-1"},is={key:3,class:"px-2 py-0.5 bg-theme-bg border border-theme-border rounded text-[10px] font-mono flex items-center gap-1"},ls={key:4,class:"px-2 py-0.5 bg-theme-bg border border-theme-border rounded text-[10px] font-mono flex items-center gap-1"},ns={key:5,class:"px-2 py-0.5 bg-theme-bg border border-theme-border rounded text-[10px] font-mono flex items-center gap-1"},rs={class:"flex items-center gap-1"},as=["onClick"],ds=["onClick"],cs=X({__name:"AdminSavedQueryManager",props:{collectionId:{},queries:{},filters:{}},emits:["filtersApplied"],setup(P,{emit:D}){const a=P,S=D,M=te(),T=ue(ee,null)||ve(a,"filters"),x=async()=>{const s={field:"year",direction:"desc"},c="exact",m=a.filters.sort.field===s.field&&a.filters.sort.direction===s.direction,C={searchQuery:a.filters.searchQuery};m||(C.sort={...a.filters.sort}),a.filters.searchMode!==c&&(C.searchMode=a.filters.searchMode),a.filters.sources.length>0&&(C.sources=[...a.filters.sources]),a.filters.minRating>0&&(C.minRating=a.filters.minRating),a.filters.minYear>0&&(C.minYear=a.filters.minYear),a.filters.maxYear&&a.filters.maxYear>0&&(C.maxYear=a.filters.maxYear),a.filters.minVotes>0&&(C.minVotes=a.filters.minVotes),a.filters.maxVotes&&a.filters.maxVotes>0&&(C.maxVotes=a.filters.maxVotes),a.filters.genres.length>0&&(C.genres=[...a.filters.genres]),a.filters.countries.length>0&&(C.countries=[...a.filters.countries]);const Q={searchQuery:a.filters.searchQuery,filterState:C};await M.addQueryToCollection(a.collectionId,Q)},k=async s=>{confirm("Are you sure you want to remove this saved query?")&&await M.removeQueryFromCollection(a.collectionId,s)},Y=s=>{Object.assign(T.value,{sort:{field:"year",direction:"desc"},sources:[],minRating:0,minYear:0,maxYear:0,minVotes:0,maxVotes:0,genres:[],countries:[],searchQuery:"",searchMode:"exact"}),s.searchQuery&&(T.value.searchQuery=s.searchQuery),s.filterState.searchMode&&(T.value.searchMode=s.filterState.searchMode),s.filterState.sort&&(T.value.sort=s.filterState.sort),s.filterState.minRating&&(T.value.minRating=s.filterState.minRating),s.filterState.minYear&&(T.value.minYear=s.filterState.minYear),s.filterState.maxYear&&(T.value.maxYear=s.filterState.maxYear),s.filterState.minVotes&&(T.value.minVotes=s.filterState.minVotes),s.filterState.maxVotes&&(T.value.maxVotes=s.filterState.maxVotes),s.filterState.genres&&(T.value.genres=[...s.filterState.genres]),s.filterState.countries&&(T.value.countries=[...s.filterState.countries]),s.filterState.sources&&(T.value.sources=[...s.filterState.sources]),S("filtersApplied")};return(s,c)=>(i(),o("div",Ht,[e("div",{class:"flex items-center justify-between"},[c[1]||(c[1]=e("label",{class:"block text-sm font-bold text-theme-textmuted uppercase tracking-wider"}," Saved Queries ",-1)),e("button",{class:"px-3 py-1.5 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-xs font-bold transition-colors flex items-center gap-2",onClick:x},[...c[0]||(c[0]=[e("div",{class:"i-mdi-plus"},null,-1),A(" Save Current Search ",-1)])])]),!P.queries||P.queries.length===0?(i(),o("div",zt," No saved queries for this collection. ")):(i(),o("div",Gt,[(i(!0),o(z,null,G(P.queries,(m,C)=>(i(),o("div",{key:C,class:"p-4 bg-theme-surface border border-theme-border rounded-xl group hover:border-theme-textmuted transition-all"},[e("div",Wt,[e("div",Xt,[e("div",Zt,[c[3]||(c[3]=e("div",{class:"i-mdi-magnify text-theme-textmuted"},null,-1)),e("span",Jt,h(m.searchQuery||"All Movies"),1),m.filterState.searchMode&&m.filterState.searchMode!=="exact"?(i(),o("div",qt,[...c[2]||(c[2]=[e("div",{class:"i-mdi-sparkles"},null,-1),A(" Semantic ",-1)])])):F("",!0)]),e("div",es,[m.filterState.sort?(i(),o("div",ts,[c[4]||(c[4]=e("div",{class:"i-mdi-sort"},null,-1)),A(" "+h(m.filterState.sort.field)+" ("+h(m.filterState.sort.direction)+") ",1)])):F("",!0),m.filterState.minYear&&m.filterState.minYear>0||m.filterState.maxYear?(i(),o("div",ss,[c[5]||(c[5]=e("div",{class:"i-mdi-calendar"},null,-1)),A(" "+h(m.filterState.minYear||1910)+" - "+h(m.filterState.maxYear||2025),1)])):F("",!0),m.filterState.minRating&&m.filterState.minRating>0?(i(),o("div",os,[c[6]||(c[6]=e("div",{class:"i-mdi-star"},null,-1)),A(" "+h(m.filterState.minRating)+"+ ",1)])):F("",!0),m.filterState.minVotes&&m.filterState.minVotes>0||m.filterState.maxVotes?(i(),o("div",is,[c[7]||(c[7]=e("div",{class:"i-mdi-account-group"},null,-1)),A(" "+h((m.filterState.minVotes||0).toLocaleString())+" - "+h(m.filterState.maxVotes?m.filterState.maxVotes.toLocaleString():"Any"),1)])):F("",!0),m.filterState.genres?.length?(i(),o("div",ls,[c[8]||(c[8]=e("div",{class:"i-mdi-movie-filter"},null,-1)),A(" "+h(m.filterState.genres.join(", ")),1)])):F("",!0),m.filterState.sources?.length?(i(),o("div",ns,[c[9]||(c[9]=e("div",{class:"i-mdi-source-branch"},null,-1)),A(" "+h(m.filterState.sources.join(", ")),1)])):F("",!0)])]),e("div",rs,[e("button",{class:"p-2 hover:bg-blue-600/10 text-blue-600 rounded-lg transition-colors",title:"Apply Filters",onClick:Q=>Y(m)},[...c[10]||(c[10]=[e("div",{class:"i-mdi-filter-variant"},null,-1)])],8,as),e("button",{class:"p-2 hover:bg-red-600/10 text-red-600 rounded-lg transition-colors",title:"Remove Query",onClick:Q=>k(C)},[...c[11]||(c[11]=[e("div",{class:"i-mdi-delete"},null,-1)])],8,ds)])])]))),128))]))]))}}),us=Object.assign(cs,{__name:"AdminSavedQueryManager"}),ms={class:"space-y-4"},fs={key:0,class:"p-12 flex justify-center"},vs={key:1,class:"space-y-4"},ps={class:"flex justify-end"},hs=["disabled"],xs={key:0,class:"i-mdi-loading animate-spin"},gs={key:1,class:"i-mdi-auto-fix"},bs={class:"overflow-hidden divide-y divide-theme-border"},ys={class:"w-12 h-16 rounded bg-theme-selection relative overflow-hidden flex-shrink-0"},_s=["src","alt"],ws={key:1,class:"w-full h-full flex items-center justify-center text-gray-400 dark:text-gray-600"},$s={class:"flex-1 min-w-0"},ks={class:"flex items-center gap-2"},Ss={class:"text-xs text-theme-textmuted font-mono"},Cs={class:"text-xs text-theme-textmuted truncate"},Is={class:"flex items-center gap-2 text-[10px] text-theme-textmuted mt-0.5"},Rs={class:"font-mono"},Ts={key:0,class:"flex items-center gap-1"},Vs={class:"font-bold text-theme-text"},As={key:0,class:"opacity-70"},Ms={class:"flex items-center gap-1"},Fs=["disabled","onClick"],Ys={key:0,class:"i-mdi-loading animate-spin text-xl"},Es={key:1,class:"i-mdi-auto-fix text-xl"},js=["disabled","onClick"],Ls={key:0,class:"i-mdi-loading animate-spin text-xl"},Ds={key:1,class:"i-mdi-trash-can-outline text-xl"},Qs={key:2,class:"p-12 text-center text-theme-textmuted bg-theme-surface border border-theme-border border-dashed rounded-2xl"},Os=X({__name:"AdminCollectionMoviesList",props:{collectionId:{}},emits:["find-similar"],setup(P,{expose:D,emit:a}){const S=P,M=te(),r=xe(),{lightweightMovieCache:T}=ce(r),x=H(),k=R([]),Y=R(!1),s=R(""),c=R(""),m=R(!1),C=a,Q=async()=>{if(S.collectionId){Y.value=!0;try{const b=await M.getCollectionById(S.collectionId);if(!b||!b.movieIds||!b.movieIds.length){k.value=[];return}const n=ge(b.movieIds);await r.fetchMoviesByIds(n),k.value=n.map(_=>{const p=T.value.get(_);return p||{movieId:_,title:`Missing: ${_}`,year:0}})}catch(b){window.console.error("Failed to load collection movies:",b),x.showToast("Failed to load collection movies","error")}finally{Y.value=!1}}},O=async b=>{c.value=b.movieId;try{const n=await r.getSimilarMovies(b.movieId,20);C("find-similar",n),x.showToast(`Found ${n.length} similar movies`)}catch{x.showToast("Failed to find similar movies","error")}finally{c.value=""}},d=async()=>{if(k.value.length!==0){m.value=!0;try{const b=new Map;for(const _ of k.value)(await r.getSimilarMovies(_.movieId,10)).forEach(j=>{if(k.value.some(I=>I.movieId===j.movieId))return;const y=b.get(j.movieId);y?y.count++:b.set(j.movieId,{movie:j,count:1})});const n=Array.from(b.values()).sort((_,p)=>p.count-_.count).map(_=>_.movie).slice(0,50);C("find-similar",n),x.showToast(`Suggested ${n.length} related movies`)}catch{x.showToast("Failed to suggest related movies","error")}finally{m.value=!1}}},N=async b=>{if(confirm(`Remove "${b.title}" from this collection?`)){s.value=b.movieId;try{await M.removeMovieFromCollection(S.collectionId,b.movieId)?(x.showToast("Movie removed from collection"),await Q()):x.showToast("Failed to remove movie","error")}catch{x.showToast("Error removing movie","error")}finally{s.value=""}}};return D({refresh:Q}),le(()=>S.collectionId,()=>{Q()},{immediate:!0}),(b,n)=>{const _=de;return i(),o("div",ms,[t(Y)?(i(),o("div",fs,[...n[1]||(n[1]=[e("div",{class:"i-mdi-loading animate-spin text-4xl text-blue-600"},null,-1)])])):t(k).length>0?(i(),o("div",vs,[e("div",ps,[e("button",{class:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-xl text-sm font-bold transition-all flex items-center gap-2 shadow-lg shadow-blue-600/20 disabled:opacity-50",disabled:t(m),onClick:d},[t(m)?(i(),o("div",xs)):(i(),o("div",gs)),n[2]||(n[2]=A(" Auto-suggest Related ",-1))],8,hs)]),e("div",bs,[(i(!0),o(z,null,G(t(k),p=>(i(),o("div",{key:p.movieId,class:"py-4 flex items-center gap-4 hover:bg-theme-bg/50 transition-colors"},[e("div",ys,[p.movieId?.startsWith("tt")?(i(),o("img",{key:0,src:("getPosterPath"in b?b.getPosterPath:t(be))(p.movieId),alt:p.title,class:"w-full h-full object-cover",onError:n[0]||(n[0]=j=>j.target.style.display="none")},null,40,_s)):(i(),o("div",ws,[...n[3]||(n[3]=[e("div",{class:"i-mdi-movie text-2xl"},null,-1)])]))]),e("div",$s,[e("div",ks,[$(_,{to:`/movie/${p.movieId}`,target:"_blank",class:"font-bold truncate hover:text-blue-600 transition-colors"},{default:K(()=>[A(h(p.title),1)]),_:2},1032,["to"]),e("span",Ss,h(p.year),1)]),e("p",Cs,h(p.genre||"Unknown Genre"),1),e("div",Is,[e("span",Rs,h(p.movieId),1),p.imdbRating?(i(),o("span",Ts,[n[4]||(n[4]=e("span",{class:"opacity-50"},"•",-1)),n[5]||(n[5]=e("div",{class:"i-mdi-star text-theme-accent text-xs"},null,-1)),e("span",Vs,h(p.imdbRating),1),p.imdbVotes?(i(),o("span",As," ("+h(("formatVotes"in b?b.formatVotes:t(ye))(p.imdbVotes))+") ",1)):F("",!0)])):F("",!0)])]),e("div",Ms,[e("button",{class:"p-2 text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Find similar movies",disabled:t(c)===p.movieId,onClick:j=>O(p)},[t(c)===p.movieId?(i(),o("div",Ys)):(i(),o("div",Es))],8,Fs),e("button",{class:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Remove from collection",disabled:t(s)===p.movieId,onClick:j=>N(p)},[t(s)===p.movieId?(i(),o("div",Ls)):(i(),o("div",Ds))],8,js)])]))),128))])])):(i(),o("div",Qs,[...n[6]||(n[6]=[e("div",{class:"i-mdi-movie-off-outline text-4xl mx-auto mb-2 opacity-20"},null,-1),e("p",null,"No movies in this collection yet.",-1)])]))])}}}),Ns=Object.assign(Os,{__name:"AdminCollectionMoviesList"}),Ps={class:"min-h-screen bg-theme-background text-theme-text p-4 md:ml-16 transition-colors duration-300"},Us={class:"max-w-7xl mx-auto space-y-8"},Bs={key:0,class:"flex flex-col items-center justify-center h-[60vh] text-center"},Ks={key:1,class:"flex flex-col gap-8"},Hs={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},zs={class:"bg-theme-surface border border-theme-border rounded-2xl p-6"},Gs={key:0,class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},Ws={class:"space-y-8"},Xs={key:0,class:"bg-theme-surface border border-theme-border rounded-2xl p-6 space-y-4"},Zs={class:"flex items-start justify-between gap-4"},Js={class:"space-y-2"},qs={class:"flex items-center gap-3"},eo={class:"text-2xl font-bold"},to={key:0,class:"px-2 py-0.5 bg-yellow-600/10 text-yellow-600 dark:text-yellow-400 border border-yellow-600/20 rounded text-xs font-bold uppercase"},so={key:0,class:"flex flex-wrap gap-2"},oo={class:"text-theme-textmuted max-w-3xl"},io={class:"flex items-center gap-2 text-sm font-mono text-theme-textmuted"},lo={class:"text-theme-text"},no={class:"flex items-center gap-2"},ro={class:"space-y-6"},ao={class:"space-y-6"},co={class:"bg-theme-surface border border-theme-border rounded-2xl p-6 space-y-6"},uo={class:"flex items-center justify-between gap-2"},bo=X({__name:"index",setup(P){Se({title:"Collection Editor - Movies Deluxe Admin",meta:[{name:"robots",content:"noindex, nofollow"}]});const D=_e(),{filters:a}=D;pe(ee,a);const S=R(!1),M=R(""),r=R(null),T=R(null),x=R(null),k=te(),{collections:Y}=ce(k),s=B(()=>M.value&&Y.value.get(M.value)||null);me(async()=>{S.value=Le()});const c=()=>{T.value&&T.value.refresh()},m=O=>{x.value&&(x.value.setExternalResults(O),window.scrollTo({top:0,behavior:"smooth"}))},C=()=>{},Q=async()=>{if(!(!M.value||!s.value)&&confirm("This will remove all movies from this collection that are no longer in the database. Continue?"))try{const O=ge(s.value.movieIds);if(!O.length){H().showToast("Collection is already empty");return}const d=Ce();if(!d.isReady.value){H().showToast("Database not ready","error");return}const N=await d.queryByIds(O),b=new Set(N.map(p=>p.movieId)),n=O.filter(p=>!b.has(p));if(n.length===0){H().showToast("No missing movies found in this collection");return}await k.removeMoviesFromCollection(M.value,n)?(H().showToast(`Removed ${n.length} missing movies from collection`),T.value&&T.value.refresh()):H().showToast("Failed to remove missing movies","error")}catch{H().showToast("Error during cleanup","error")}};return(O,d)=>{const N=de,b=rt,n=Kt,_=us,p=Ns;return i(),o("div",Ps,[e("main",Us,[t(S)?(i(),o("div",Ks,[e("header",Hs,[d[9]||(d[9]=e("div",null,[e("h1",{class:"text-3xl font-bold flex items-center gap-3"},[e("div",{class:"i-mdi-movie-edit text-blue-600"}),A(" Collection Editor ")]),e("p",{class:"text-theme-textmuted mt-1"},"Add and remove movies from collections")],-1)),$(N,{to:"/admin",class:"px-4 py-2 text-sm bg-theme-surface border border-theme-border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors flex items-center gap-2"},{default:K(()=>[...d[8]||(d[8]=[e("div",{class:"i-mdi-arrow-left"},null,-1),A(" Back to Dashboard ",-1)])]),_:1})]),e("section",zs,[$(b,{ref_key:"collectionSelector",ref:r,onSelect:d[0]||(d[0]=j=>M.value=j)},null,512)]),t(M)?(i(),o("section",Gs,[e("div",Ws,[t(s)?(i(),o("div",Xs,[e("div",Zs,[e("div",Js,[e("div",qs,[e("h2",eo,h(t(s).name),1),t(s).enabled===!1?(i(),o("span",to," Hidden ")):F("",!0)]),t(s).tags?.length?(i(),o("div",so,[(i(!0),o(z,null,G(t(s).tags,j=>(i(),o("span",{key:j,class:"px-2 py-1 bg-blue-600/10 text-blue-600 dark:text-blue-400 border border-blue-600/20 rounded-lg text-xs font-medium"},h(j),1))),128))])):F("",!0),e("p",oo,h(t(s).description||"No description provided."),1),e("div",io,[d[10]||(d[10]=e("div",{class:"i-mdi-movie text-theme-text"},null,-1)),e("span",lo,h(t(s).movieIds.length),1),d[11]||(d[11]=A(" movies in collection ",-1))])]),e("div",no,[e("button",{class:W(["p-2 rounded-xl border border-theme-border hover:bg-theme-background transition-colors",t(s).enabled===!1?"text-green-600":"text-yellow-600"]),title:"Toggle Visibility",onClick:d[1]||(d[1]=j=>t(r)?.toggleEnabled(t(s)))},[e("div",{class:W([t(s).enabled===!1?"i-mdi-eye":"i-mdi-eye-off","text-xl"])},null,2)],2),e("button",{class:"p-2 rounded-xl border border-theme-border hover:bg-theme-background text-blue-600 transition-colors",title:"Edit Collection",onClick:d[2]||(d[2]=j=>t(r)?.editCollection(t(s)))},[...d[12]||(d[12]=[e("div",{class:"i-mdi-pencil text-xl"},null,-1)])]),e("button",{class:"p-2 rounded-xl border border-theme-border hover:bg-theme-background text-red-600 transition-colors",title:"Delete Collection",onClick:d[3]||(d[3]=j=>t(r)?.confirmDelete(t(s)))},[...d[13]||(d[13]=[e("div",{class:"i-mdi-delete text-xl"},null,-1)])])])])])):F("",!0),e("div",ro,[d[14]||(d[14]=e("h2",{class:"text-xl font-bold flex items-center gap-2"},[e("div",{class:"i-mdi-magnify text-blue-600"}),A(" Search Library ")],-1)),$(n,{ref_key:"movieSearch",ref:x,"collection-id":t(M),filters:t(a),onAdd:c},null,8,["collection-id","filters"])])]),e("div",ao,[e("div",co,[d[15]||(d[15]=e("h2",{class:"text-xl font-bold flex items-center gap-2"},[e("div",{class:"i-mdi-database-clock text-blue-600"}),A(" Dynamic Queries ")],-1)),$(_,{"collection-id":t(M),queries:t(s)?.savedQueries,filters:t(a),onFiltersApplied:C},null,8,["collection-id","queries","filters"])]),e("div",uo,[d[17]||(d[17]=e("h2",{class:"text-xl font-bold flex items-center gap-2"},[e("div",{class:"i-mdi-playlist-play text-blue-600"}),A(" Collection Movies ")],-1)),t(M)?(i(),o("button",{key:0,class:"px-3 py-1 text-xs bg-theme-surface border border-theme-border rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 transition-colors flex items-center gap-2",title:"Remove movies that are no longer in the database",onClick:Q},[...d[16]||(d[16]=[e("div",{class:"i-mdi-broom"},null,-1),A(" Cleanup ",-1)])])):F("",!0)]),$(p,{ref_key:"moviesList",ref:T,"collection-id":t(M),onFindSimilar:m},null,8,["collection-id"])])])):F("",!0)])):(i(),o("div",Bs,[d[5]||(d[5]=e("div",{class:"i-mdi-lock text-64px text-gray-300 dark:text-gray-700 mb-4"},null,-1)),d[6]||(d[6]=e("h1",{class:"text-2xl font-bold mb-2"},"Access Denied",-1)),d[7]||(d[7]=e("p",{class:"text-theme-textmuted"},"The admin interface is only available on localhost.",-1)),$(N,{to:"/",class:"mt-6 px-6 py-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors"},{default:K(()=>[...d[4]||(d[4]=[A(" Back to Home ",-1)])]),_:1})]))])])}}});export{bo as default};
