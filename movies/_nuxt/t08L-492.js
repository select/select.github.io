import{E as y,c as i,o,a6 as P,H as S,G as T,e as z,r as f,ai as R,I as D,k as L,F as _,z as e,w as N,a as l,L as n,P as p,t as r}from"./BjH_is5i.js";import{_ as B}from"./BUWSRdAD.js";import{u as E,g as F}from"./D0CfZfOz.js";import{f as $}from"./DMOTkeJ5.js";const O={class:"block overflow-hidden"},U=y({__name:"MovieCardSkeleton",setup(x){return(v,d)=>(o(),i("div",O,[...d[0]||(d[0]=[P('<div class="aspect-[2/3] skeleton rounded-xl mb-3"></div><div class="space-y-2"><div class="h-5 skeleton rounded-lg w-3/4"></div><div class="flex items-center gap-2 pt-1"><div class="h-4 skeleton rounded-full w-12"></div><div class="h-4 skeleton rounded-full w-16"></div></div></div>',2)])]))}}),W=Object.assign(U,{__name:"MovieCardSkeleton"}),A={class:"aspect-[2/3] bg-theme-selection relative flex-shrink-0 overflow-hidden"},G=["src","alt"],H={key:2,class:"w-full h-full flex items-center justify-center text-gray-400 dark:text-gray-600"},Y={key:3,class:"absolute top-1.5 right-1.5 flex flex-col gap-1 items-end"},q={key:0,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-gray-800 dark:text-white font-medium"},J={key:1,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-red-600 dark:text-red-400 font-bold"},K={key:2,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-gray-800 dark:text-white font-bold"},Q={key:4,class:"absolute top-1.5 left-1.5 w-7 h-7 rounded-full glass flex items-center justify-center z-10"},X=["title"],Z={key:0,class:"absolute -bottom-1 -right-1 bg-theme-accent text-black text-[9px] font-black w-3.5 h-3.5 rounded-full flex items-center justify-center border border-theme-surface"},ee={class:"p-3 flex-shrink-0"},te={class:"font-bold text-sm line-clamp-2 mb-1.5 leading-snug min-h-[2.5rem]"},se={class:"flex items-center gap-1.5 text-[11px] text-theme-textmuted font-medium"},oe={key:0},ie={key:1,class:"opacity-50"},le={key:2,class:"flex items-center gap-1"},ne={class:"font-bold text-theme-text"},ae={key:0,class:"text-[10px] opacity-70"},re={key:2,class:"flex flex-col border border-red-500/50 rounded-xl overflow-hidden bg-theme-surface text-theme-text opacity-50",title:"Invalid movie data: missing movieId or movie not loaded"},de={class:"p-3 flex-shrink-0"},ce={class:"font-bold text-sm line-clamp-2 mb-1.5 leading-snug min-h-[2.5rem] text-red-400"},me={class:"text-[11px] text-red-400 font-medium"},ue=y({__name:"MovieCard",props:{movieId:{}},setup(x){const v=x,{likedMovieIds:d,lightweightMovieCache:k}=S(T()),{getCollectionsForMovie:b}=E(),t=z(()=>v.movieId&&k.value.get(v.movieId)||null),u=f(!1),a=f([]),c=f(!1),h=f(null),{start:I,stop:w}=R(async()=>{c.value=!0,t.value?.movieId&&a.value.length===0&&(a.value=await b(t.value.movieId))},200,{immediate:!1}),{stop:C}=D(h,m=>{const s=m[0];s&&(s.isIntersecting?I():w())},{rootMargin:"200px"});L(()=>{C()});const M=m=>{u.value=!0;const s=m.target;s.style.display="none"};return(m,s)=>{const j=W,V=B;return!e(t)||!e(t).title?(o(),_(j,{key:0})):e(t).movieId?(o(),_(V,{key:1,ref_key:"cardRef",ref:h,to:`/movie/${e(t).movieId}`,class:"flex flex-col border border-theme-border/50 rounded-xl overflow-hidden hover:shadow-xl hover:-translate-y-1 transition-all duration-300 bg-theme-surface text-theme-text"},{default:N(()=>[l("div",A,[e(t).movieId?.startsWith("tt")?(o(),i("div",{key:0,class:p(["absolute inset-0 shimmer z-10 transition-opacity duration-500",{"opacity-0 pointer-events-none":e(u),"opacity-100":!e(u)}])},null,2)):n("",!0),e(c)&&e(t).movieId?.startsWith("tt")?(o(),i("img",{key:1,src:("getPosterPath"in m?m.getPosterPath:e(F))(e(t).movieId),alt:e(t).title,class:p(["w-full h-full object-cover object-center transition-opacity duration-700",{"opacity-0":!e(u),"opacity-100":e(u)}]),loading:"lazy",onLoad:s[0]||(s[0]=g=>u.value=!0),onError:M},null,42,G)):(o(),i("div",H,[...s[1]||(s[1]=[l("div",{class:"i-mdi-movie text-6xl"},null,-1)])])),e(c)&&e(t).sourceType?(o(),i("div",Y,[e(t).sourceType==="archive.org"?(o(),i("span",q," Archive.org ")):e(t).sourceType==="youtube"?(o(),i("span",J,r(e(t).channelName||"YouTube"),1)):n("",!0),e(t).language?(o(),i("span",K,r(e(t).language.toUpperCase()),1)):n("",!0)])):n("",!0),e(c)&&e(t).movieId&&e(d).includes(e(t).movieId)?(o(),i("div",Q,[...s[2]||(s[2]=[l("div",{class:"i-mdi-heart text-red-500 text-lg"},null,-1)])])):n("",!0),e(c)&&e(a).length>0?(o(),i("div",{key:5,class:p(["absolute top-1.5 left-1.5 w-7 h-7 rounded-full glass flex items-center justify-center z-10",{"ml-8":e(t).movieId&&e(d).includes(e(t).movieId)}]),title:e(a).map(g=>g.name).join(", ")},[s[3]||(s[3]=l("div",{class:"i-mdi:movie-roll text-theme-accent text-lg"},null,-1)),e(a).length>1?(o(),i("span",Z,r(e(a).length),1)):n("",!0)],10,X)):n("",!0),e(c)&&e(t).verified?(o(),i("div",{key:6,class:p(["absolute top-1.5 left-1.5 w-7 h-7 rounded-full flex items-center justify-center z-10",{"ml-8":e(t).movieId&&e(d).includes(e(t).movieId)&&e(a).length===0||(!e(t).movieId||!e(d).includes(e(t).movieId))&&e(a).length>0,"ml-16":e(t).movieId&&e(d).includes(e(t).movieId)&&e(a).length>0}]),title:"Verified Source"},[...s[4]||(s[4]=[l("div",{class:"i-mdi-check-decagram text-green-600 text-2xl"},null,-1)])],2)):n("",!0)]),l("div",ee,[l("h3",te,r(e(t).title),1),l("div",se,[e(t).year?(o(),i("span",oe,r(e(t).year),1)):n("",!0),e(c)&&e(t).year&&e(t).imdbRating?(o(),i("span",ie,"â€¢")):n("",!0),e(c)&&e(t).imdbRating?(o(),i("span",le,[s[5]||(s[5]=l("div",{class:"i-mdi-star text-theme-accent text-xs"},null,-1)),l("span",ne,r(e(t).imdbRating),1),e(t).imdbVotes?(o(),i("span",ae," ("+r(("formatVotes"in m?m.formatVotes:e($))(e(t).imdbVotes))+") ",1)):n("",!0)])):n("",!0)])])]),_:1},8,["to"])):(o(),i("div",re,[s[6]||(s[6]=l("div",{class:"aspect-[2/3] bg-theme-selection relative flex-shrink-0 overflow-hidden"},[l("div",{class:"w-full h-full flex items-center justify-center text-red-400"},[l("div",{class:"i-mdi-alert-circle text-6xl"})])],-1)),l("div",de,[l("h3",ce,r(e(t)?.title||v.movieId||"Unknown Movie"),1),l("div",me,r(e(t)?"Missing ID":"Loading..."),1)])]))}}}),he=Object.assign(ue,{__name:"MovieCard"});export{W as _,he as a};
