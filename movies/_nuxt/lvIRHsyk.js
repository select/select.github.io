import{E as k,c as o,o as s,a6 as S,H as T,G as z,e as R,r as v,ak as D,I as E,k as L,F as y,z as e,w as N,a as l,L as n,P as p,t as r}from"./B1tWgybf.js";import{_ as B}from"./LRFP58BA.js";import{u as F,g as $}from"./DWvaHTd9.js";import{f as O}from"./DMOTkeJ5.js";const U={class:"block overflow-hidden"},W=k({__name:"MovieCardSkeleton",setup(x){return(f,d)=>(s(),o("div",U,[...d[0]||(d[0]=[S('<div class="aspect-[2/3] skeleton rounded-xl mb-3"></div><div class="space-y-2"><div class="h-5 skeleton rounded-lg w-3/4"></div><div class="flex items-center gap-2 pt-1"><div class="h-4 skeleton rounded-full w-12"></div><div class="h-4 skeleton rounded-full w-16"></div></div></div>',2)])]))}}),A=Object.assign(W,{__name:"MovieCardSkeleton"}),G={class:"aspect-[2/3] bg-theme-selection relative flex-shrink-0 overflow-hidden"},H=["src","alt"],Y={key:2,class:"w-full h-full flex items-center justify-center bg-gradient-to-br from-theme-surface to-theme-selection"},q={key:3,class:"absolute top-1.5 right-1.5 flex flex-col gap-1 items-end"},J={key:0,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-gray-800 dark:text-white font-medium"},K={key:1,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-red-600 dark:text-red-400 font-bold"},Q={key:2,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-gray-800 dark:text-white font-bold"},X={key:4,class:"absolute top-1.5 left-1.5 w-7 h-7 rounded-full glass flex items-center justify-center z-10"},Z=["title"],ee={key:0,class:"absolute -bottom-1 -right-1 bg-theme-accent text-black text-[9px] font-black w-3.5 h-3.5 rounded-full flex items-center justify-center border border-theme-surface"},te={class:"p-3 flex-shrink-0"},se={class:"font-bold text-sm line-clamp-2 mb-1.5 leading-snug min-h-[2.5rem]"},oe={class:"flex items-center gap-1.5 text-[11px] text-theme-textmuted font-medium"},ie={key:0},le={key:1,class:"opacity-50"},ne={key:2,class:"flex items-center gap-1"},ae={class:"font-bold text-theme-text"},re={key:0,class:"text-[10px] opacity-70"},de={key:2,class:"flex flex-col border border-red-500/50 rounded-xl overflow-hidden bg-theme-surface text-theme-text opacity-50",title:"Invalid movie data: missing movieId or movie not loaded"},ce={class:"p-3 flex-shrink-0"},me={class:"font-bold text-sm line-clamp-2 mb-1.5 leading-snug min-h-[2.5rem] text-red-400"},ue={class:"text-[11px] text-red-400 font-medium"},ve=k({__name:"MovieCard",props:{movieId:{}},setup(x){const f=x,{likedMovieIds:d,lightweightMovieCache:b}=T(z()),{getCollectionsForMovie:I}=F(),t=R(()=>f.movieId&&b.value.get(f.movieId)||null),m=v(!1),h=v(!1),a=v([]),c=v(!1),_=v(null),{start:w,stop:C}=D(async()=>{c.value=!0,t.value?.movieId&&a.value.length===0&&(a.value=await I(t.value.movieId))},200,{immediate:!1}),{stop:M}=E(_,u=>{const i=u[0];i&&(i.isIntersecting?w():C())},{rootMargin:"200px"});L(()=>{M()});const j=()=>{h.value=!0,m.value=!0};return(u,i)=>{const V=A,P=B;return!e(t)||!e(t).title?(s(),y(V,{key:0})):e(t).movieId?(s(),y(P,{key:1,ref_key:"cardRef",ref:_,to:`/movie/${e(t).movieId}`,class:"flex flex-col border border-theme-border/50 rounded-xl overflow-hidden hover:shadow-xl hover:-translate-y-1 transition-all duration-300 bg-theme-surface text-theme-text"},{default:N(()=>[l("div",G,[e(t).movieId?.startsWith("tt")&&!e(h)?(s(),o("div",{key:0,class:p(["absolute inset-0 shimmer z-10 transition-opacity duration-500",{"opacity-0 pointer-events-none":e(m),"opacity-100":!e(m)}])},null,2)):n("",!0),e(c)&&e(t).movieId?.startsWith("tt")&&!e(h)?(s(),o("img",{key:1,src:("getPosterPath"in u?u.getPosterPath:e($))(e(t).movieId),alt:e(t).title,class:p(["w-full h-full object-cover object-center transition-opacity duration-700",{"opacity-0":!e(m),"opacity-100":e(m)}]),loading:"lazy",onLoad:i[0]||(i[0]=g=>m.value=!0),onError:j},null,42,H)):(s(),o("div",Y)),e(c)&&e(t).sourceType?(s(),o("div",q,[e(t).sourceType==="archive.org"?(s(),o("span",J," Archive.org ")):e(t).sourceType==="youtube"?(s(),o("span",K,r(e(t).channelName||"YouTube"),1)):n("",!0),e(t).language?(s(),o("span",Q,r(e(t).language.toUpperCase()),1)):n("",!0)])):n("",!0),e(c)&&e(t).movieId&&e(d).includes(e(t).movieId)?(s(),o("div",X,[...i[1]||(i[1]=[l("div",{class:"i-mdi-heart text-red-500 text-lg"},null,-1)])])):n("",!0),e(c)&&e(a).length>0?(s(),o("div",{key:5,class:p(["absolute top-1.5 left-1.5 w-7 h-7 rounded-full glass flex items-center justify-center z-10",{"ml-8":e(t).movieId&&e(d).includes(e(t).movieId)}]),title:e(a).map(g=>g.name).join(", ")},[i[2]||(i[2]=l("div",{class:"i-mdi:movie-roll text-theme-accent text-lg"},null,-1)),e(a).length>1?(s(),o("span",ee,r(e(a).length),1)):n("",!0)],10,Z)):n("",!0),e(c)&&e(t).verified?(s(),o("div",{key:6,class:p(["absolute top-1.5 left-1.5 w-7 h-7 rounded-full flex items-center justify-center z-10",{"ml-8":e(t).movieId&&e(d).includes(e(t).movieId)&&e(a).length===0||(!e(t).movieId||!e(d).includes(e(t).movieId))&&e(a).length>0,"ml-16":e(t).movieId&&e(d).includes(e(t).movieId)&&e(a).length>0}]),title:"Verified Source"},[...i[3]||(i[3]=[l("div",{class:"i-mdi-check-decagram text-green-600 text-2xl"},null,-1)])],2)):n("",!0)]),l("div",te,[l("h3",se,r(e(t).title),1),l("div",oe,[e(t).year?(s(),o("span",ie,r(e(t).year),1)):n("",!0),e(c)&&e(t).year&&e(t).imdbRating?(s(),o("span",le,"â€¢")):n("",!0),e(c)&&e(t).imdbRating?(s(),o("span",ne,[i[4]||(i[4]=l("div",{class:"i-mdi-star text-theme-accent text-xs"},null,-1)),l("span",ae,r(e(t).imdbRating),1),e(t).imdbVotes?(s(),o("span",re," ("+r(("formatVotes"in u?u.formatVotes:e(O))(e(t).imdbVotes))+") ",1)):n("",!0)])):n("",!0)])])]),_:1},8,["to"])):(s(),o("div",de,[i[5]||(i[5]=l("div",{class:"aspect-[2/3] bg-theme-selection relative flex-shrink-0 overflow-hidden"},[l("div",{class:"w-full h-full flex items-center justify-center text-red-400"},[l("div",{class:"i-mdi-alert-circle text-6xl"})])],-1)),l("div",ce,[l("h3",me,r(e(t)?.title||f.movieId||"Unknown Movie"),1),l("div",ue,r(e(t)?"Missing ID":"Loading..."),1)])]))}}}),_e=Object.assign(ve,{__name:"MovieCard"});export{A as _,_e as a};
