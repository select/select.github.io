import{_ as ke}from"./D7z85Pj3.js";import{L as $e,M as _e,y as I,e as w,c as n,a as e,k as b,t as a,q as _,d as x,N as y,o as r,F as A,r as R,O as we,m as $,A as N,f as O,P,Q as Y,s as j,l as t,v as Se,x as Ce,R as Ae,b as f,u as Re,h as Pe,w as de,j as ie}from"./gTEv6Ct-.js";import{i as Oe}from"./BH85bPq3.js";const De="$s";function X(...l){const i=typeof l[l.length-1]=="string"?l.pop():void 0;typeof l[0]!="string"&&l.unshift(i);const[s,o]=l;if(!s||typeof s!="string")throw new TypeError("[nuxt] [useState] key must be a string: "+s);if(o!==void 0&&typeof o!="function")throw new Error("[nuxt] [useState] init must be a function: "+o);const d=De+s,u=$e(),p=_e(u.payload.state,d);if(p.value===void 0&&o){const v=o();if(I(v))return u.payload.state[d]=v,v;p.value=v}return p}const Ve={class:"p-4 rounded-xl shadow-sm border border-theme-border bg-theme-surface"},Me={class:"flex items-center justify-between mb-2"},Te={class:"text-xs font-medium text-theme-textmuted uppercase tracking-wider"},Ee={class:"text-2xl font-bold flex items-baseline gap-2"},je=["title"],Fe={key:0,class:"mt-1 flex items-center gap-2"},Be={class:"flex-1 h-1 bg-theme-border rounded-full overflow-hidden flex"},qe={class:"text-[10px] font-medium"},Ie={key:1,class:"flex items-center justify-between text-[10px] mt-1"},Ue={key:0,class:"text-theme-textmuted"},Le=w({__name:"AdminStatsCard",props:{title:{},value:{},icon:{},iconColor:{default:"text-blue-500"},subtitle:{default:void 0},showProgress:{type:Boolean,default:!1},percent:{default:0},progressColor:{default:"bg-blue-500"},percentPrecision:{default:0},failed:{default:void 0},failedPercent:{default:void 0},failureRate:{default:void 0}},setup(l){return(i,s)=>(r(),n("div",Ve,[e("div",Me,[e("span",Te,a(l.title),1),e("div",{class:_(["text-xl",[l.icon,l.iconColor]])},null,2)]),e("div",Ee,[x(a(l.value.toLocaleString())+" ",1),l.failed&&l.failed>0?(r(),n("span",{key:0,class:"text-xs font-medium text-orange-500",title:`${l.failed} failed`}," +"+a(l.failed)+" failed ",9,je)):b("",!0)]),l.showProgress?(r(),n("div",Fe,[e("div",Be,[e("div",{class:_(["h-full transition-all duration-1000",l.progressColor]),style:y({width:`${l.percent}%`})},null,6),l.failed&&l.failed>0&&l.failedPercent!==void 0?(r(),n("div",{key:0,class:"h-full bg-orange-400 transition-all duration-1000",style:y({width:`${l.failedPercent}%`})},null,4)):b("",!0)]),e("span",qe,a(l.percent?.toFixed(l.percentPrecision))+"%",1)])):b("",!0),l.subtitle||l.failureRate!==void 0&&l.failureRate>0?(r(),n("div",Ie,[l.subtitle?(r(),n("span",Ue,a(l.subtitle),1)):b("",!0),l.failureRate!==void 0&&l.failureRate>0?(r(),n("span",{key:1,class:_(l.failureRate>20?"text-red-500 font-bold":"text-orange-500")},a(l.failureRate.toFixed(1))+"% fail ",3)):b("",!0)])):b("",!0)]))}}),Ne=Object.assign(Le,{__name:"AdminStatsCard"}),Ye={class:"space-y-4"},ze={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Qe={class:"flex items-center justify-between mb-2"},We={class:"text-sm font-bold truncate pr-2"},He=["title"],Ke={class:"text-xl font-bold flex items-baseline gap-2"},Ge=["title"],Je={class:"mt-1 flex items-center gap-2"},Xe={class:"flex-1 h-1 bg-theme-border rounded-full overflow-hidden flex"},Ze={class:"text-[10px] font-medium"},et={class:"flex items-center justify-between text-[10px] text-theme-textmuted mt-1"},tt=w({__name:"AdminYouTubeChannelStats",props:{channels:{}},setup(l){return(i,s)=>(r(),n("section",Ye,[s[0]||(s[0]=e("h2",{class:"text-xl font-bold flex items-center gap-2"},[e("div",{class:"i-mdi-youtube text-red-500"}),x(" YouTube Channel Statistics ")],-1)),e("div",ze,[(r(!0),n(A,null,R(l.channels,o=>(r(),n("div",{key:o.id,class:"p-4 rounded-xl shadow-sm border border-theme-border bg-theme-surface"},[e("div",Qe,[e("span",We,a(o.name),1),e("div",{class:_(["w-2 h-2 rounded-full",o.enabled?"bg-green-500":"bg-gray-300"]),title:o.enabled?"Enabled":"Disabled"},null,10,He)]),e("div",Ke,[x(a(o.scraped)+" ",1),o.failed?(r(),n("span",{key:0,class:"text-xs font-medium text-orange-500",title:`${o.failed} failed videos`}," +"+a(o.failed)+" failed ",9,Ge)):b("",!0)]),e("div",Je,[e("div",Xe,[e("div",{class:"h-full bg-red-500 transition-all duration-1000",style:y({width:`${o.total>0?o.scraped/o.total*100:0}%`})},null,4),o.failed?(r(),n("div",{key:0,class:"h-full bg-orange-400 transition-all duration-1000",style:y({width:`${o.total>0?o.failed/o.total*100:0}%`})},null,4)):b("",!0)]),e("span",Ze,a(o.total>0?(o.scraped/o.total*100).toFixed(0):0)+"%",1)]),e("div",et,[e("span",null,a(o.scraped)+" / "+a(o.total||"?")+" videos",1),o.failureRate?(r(),n("span",{key:0,class:_(o.failureRate>20?"text-red-500 font-bold":"text-orange-500")},a(o.failureRate.toFixed(1))+"% fail ",3)):b("",!0)])]))),128))])]))}}),st=Object.assign(tt,{__name:"AdminYouTubeChannelStats"}),M=we("admin",()=>{const l=$(!1),i=$(!1),s=$(!1),o=$(!1),d=$(!1),u=$(null),p=$(null),v=$(null),c=$(null),S=$(null),D=$([]),T=$({}),z=N({collections:["feature_films"]}),F=N({limit:10,allPages:!1,channels:[]}),B=N({limit:50,force:!1}),q=N({limit:50,onlyUnmatched:!0,forceRetryFailed:!1}),Q=N({limit:100,onlyUnmatched:!0,forceReExtract:!1}),Z=g=>{T.value[g.type]=g},ee=g=>{delete T.value[g]},te=async()=>{try{const g=await $fetch("/api/admin/scrape/youtube-channels");D.value=g.channels}catch(g){window.console.error("Failed to load YouTube channels",g)}},C=async()=>{l.value=!0;try{u.value=await $fetch("/api/admin/scrape/stats")}catch(g){window.console.error("Failed to fetch stats",g)}finally{l.value=!1}},W=async()=>{i.value=!0,p.value=null;try{p.value=await $fetch("/api/admin/scrape/archive",{method:"POST",body:z}),await C()}catch(g){window.console.error("Archive scrape failed",g),p.value={processed:0,added:0,updated:0,errors:[g instanceof Error?g.message:String(g)]}}finally{i.value=!1}},h=async()=>{i.value=!0,p.value=null;try{p.value=await $fetch("/api/admin/scrape/youtube",{method:"POST",body:F}),await C()}catch(g){window.console.error("YouTube scrape failed",g),p.value={processed:0,added:0,updated:0,errors:[g instanceof Error?g.message:String(g)]}}finally{i.value=!1}},se=async()=>{i.value=!0,v.value=null;try{v.value=await $fetch("/api/admin/posters/download",{method:"POST",body:B}),await C()}catch(g){window.console.error("Poster download failed",g),v.value={processed:0,successful:0,failed:0,errors:[g instanceof Error?g.message:String(g)]}}finally{i.value=!1}},le=async()=>{i.value=!0,p.value=null;try{p.value=await $fetch("/api/admin/omdb/enrich",{method:"POST",body:q}),await C()}catch(g){window.console.error("OMDB enrichment failed",g),p.value={processed:0,added:0,updated:0,errors:[g instanceof Error?g.message:String(g)]}}finally{i.value=!1}},H=async()=>{i.value=!0;try{(await $fetch("/api/admin/ai/extract-batch",{method:"POST",body:Q})).success&&await C()}catch(g){window.console.error("AI extraction failed:",g)}finally{i.value=!1}},oe=async()=>{s.value=!0;try{await $fetch("/api/admin/sqlite/generate",{method:"POST"})}catch(g){window.console.error("SQLite generation failed",g)}finally{s.value=!1}},U=O(()=>{if(!u.value)return 0;const g=u.value.external.archiveOrg.total||0,ne=u.value.external.youtube.totalAvailable||0;return g+ne}),K=O(()=>u.value&&u.value.external.youtube.totalScraped||0),E=O(()=>u.value&&u.value.external.youtube.totalAvailable||0),ae=O(()=>E.value===0?0:K.value/E.value*100),G=O(()=>!u.value||U.value===0?0:u.value.database.total/U.value*100),re=O(()=>!u.value||E.value===0?0:(u.value.external.youtube.totalFailed||0)/E.value*100),L=O(()=>!u.value||u.value.omdb.total===0?0:(u.value.omdb.failed||0)/u.value.omdb.total*100),m=O(()=>!u.value||u.value.posters.withPosterUrl===0?0:(u.value.posters.failed||0)/u.value.posters.withPosterUrl*100);return{loading:l,scraping:i,generatingSqlite:s,deduplicating:o,cleaningCollections:d,stats:u,results:p,posterResults:v,deduplicationResults:c,collectionCleanupResults:S,youtubeChannels:D,progress:T,archiveOptions:z,youtubeOptions:F,posterOptions:B,omdbOptions:q,aiOptions:Q,updateProgress:Z,clearProgress:ee,loadYouTubeChannels:te,refreshStats:C,startArchiveScrape:W,startYouTubeScrape:h,startPosterDownload:se,startOMDBEnrichment:le,startAIExtraction:H,generateSqlite:oe,deduplicateDescriptions:async()=>{o.value=!0,c.value=null;try{c.value=await $fetch("/api/admin/data/deduplicate-descriptions",{method:"POST"}),await C()}catch(g){window.console.error("Description deduplication failed",g),c.value={totalSources:0,sourcesWithDescriptions:0,boilerplateRemoved:0,sourcesProcessed:0,descriptionsRemoved:0,patterns:[]}}finally{o.value=!1}},cleanupCollections:async()=>{d.value=!0,S.value=null;try{S.value=await $fetch("/api/admin/collections/cleanup",{method:"POST"}),await C()}catch(g){window.console.error("Collection cleanup failed",g),S.value={success:!1,stats:{collectionsProcessed:0,moviesRemoved:0,moviesUpdated:0,collectionsModified:0},details:[]}}finally{d.value=!1}},totalExternalVideos:U,youtubeTotalScraped:K,youtubeTotalAvailable:E,youtubePercent:ae,databasePercentOfTotal:G,youtubeFailedPercent:re,omdbFailedPercent:L,postersFailedPercent:m}}),lt={class:"p-8 rounded-3xl shadow-lg border border-theme-border bg-theme-surface"},ot={class:"space-y-6"},at=["disabled"],rt={key:0,class:"i-mdi-loading animate-spin"},nt={key:1,class:"i-mdi-play"},dt={key:0,class:"mt-4 space-y-2"},it={class:"flex items-center justify-between text-xs"},ut={class:"text-theme-textmuted truncate mr-2"},ct={class:"font-mono text-nowrap"},mt={class:"h-2 bg-theme-border rounded-full overflow-hidden"},bt=w({__name:"AdminArchiveScraper",props:P({loading:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:P(["start"],["update:modelValue"]),setup(l){Y(l,"modelValue");const{progress:i}=j(M());return(s,o)=>(r(),n("div",lt,[o[2]||(o[2]=e("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[e("div",{class:"i-mdi-archive text-amber-500"}),x(" Archive.org Scraper ")],-1)),e("div",ot,[o[1]||(o[1]=e("p",{class:"text-theme-textmuted text-sm"},` Scrapes all available movies from Archive.org's "Feature Films" collection. Always fetches 500 rows per page to minimize API calls and scrapes all pages until completion. `,-1)),e("button",{class:"w-full py-3 bg-amber-500 hover:bg-amber-600 text-white font-bold rounded-2xl shadow-lg shadow-amber-500/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l.loading,onClick:o[0]||(o[0]=d=>s.$emit("start"))},[l.loading?(r(),n("div",rt)):(r(),n("div",nt)),x(" "+a(l.loading?"Scraping in progress...":"Start Archive.org Scrape"),1)],8,at),t(i).archive&&t(i).archive.status==="in_progress"?(r(),n("div",dt,[e("div",it,[e("span",ut,a(t(i).archive.message),1),e("span",ct,a(t(i).archive.current)+" / "+a(t(i).archive.total),1)]),e("div",mt,[e("div",{class:"h-full bg-amber-500 transition-all duration-300",style:y({width:`${t(i).archive.current/t(i).archive.total*100}%`})},null,4)])])):b("",!0)])]))}}),gt=Object.assign(bt,{__name:"AdminArchiveScraper"}),xt={class:"p-8 rounded-3xl shadow-lg border border-theme-border bg-theme-surface"},pt={class:"space-y-6"},vt={class:"space-y-2"},ft=["value"],ht={class:"text-xs text-theme-textmuted"},yt=["disabled"],kt={key:0,class:"i-mdi-loading animate-spin"},$t={key:1,class:"i-mdi-play"},_t={key:0,class:"mt-4 space-y-3"},wt={class:"flex items-center justify-between text-xs"},St={class:"text-theme-textmuted truncate mr-2"},Ct={class:"font-mono text-nowrap"},At={class:"h-3 bg-theme-border rounded-full overflow-hidden flex"},Rt={class:"grid grid-cols-2 gap-2 text-[10px] font-medium"},Pt={class:"flex items-center gap-1 text-green-600 dark:text-green-400"},Ot={class:"flex items-center gap-1 text-orange-600 dark:text-orange-400"},Dt=w({__name:"AdminYouTubeScraper",props:P({channels:{},loading:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:P(["start"],["update:modelValue"]),setup(l){const i=Y(l,"modelValue"),{progress:s}=j(M());return(o,d)=>(r(),n("div",xt,[d[6]||(d[6]=e("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[e("div",{class:"i-mdi-youtube text-red-500"}),x(" YouTube Scraper ")],-1)),e("div",pt,[e("div",vt,[d[2]||(d[2]=e("label",{class:"text-sm font-medium text-theme-textmuted"},"Select Channels",-1)),(r(!0),n(A,null,R(l.channels,u=>(r(),n("label",{key:u.id,class:"flex items-center gap-2 px-2 py-1 hover:bg-theme-selection rounded cursor-pointer text-sm"},[Se(e("input",{"onUpdate:modelValue":d[0]||(d[0]=p=>i.value.channels=p),type:"checkbox",value:u.id,class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,8,ft),[[Ce,i.value.channels]]),e("span",null,a(u.name),1),e("span",ht,"("+a(u.language)+")",1)]))),128)),d[3]||(d[3]=e("p",{class:"text-[10px] text-theme-textmuted"}," If none selected, all enabled channels will be processed. ",-1))]),e("button",{class:"w-full py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-2xl shadow-lg shadow-red-600/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l.loading,onClick:d[1]||(d[1]=u=>o.$emit("start"))},[l.loading?(r(),n("div",kt)):(r(),n("div",$t)),x(" "+a(l.loading?"Scraping in progress...":"Start YouTube Scrape"),1)],8,yt),t(s).youtube&&t(s).youtube.status==="in_progress"?(r(),n("div",_t,[e("div",wt,[e("span",St,a(t(s).youtube.message),1),e("span",Ct,a(t(s).youtube.current)+" / "+a(t(s).youtube.total||"?"),1)]),e("div",At,[t(s).youtube.total?(r(),n("div",{key:0,class:"h-full bg-green-500 transition-all duration-300",style:y({width:`${(t(s).youtube.successCurrent||0)/t(s).youtube.total*100}%`}),title:"Success"},null,4)):b("",!0),t(s).youtube.total?(r(),n("div",{key:1,class:"h-full bg-orange-500 transition-all duration-300",style:y({width:`${(t(s).youtube.failedCurrent||0)/t(s).youtube.total*100}%`}),title:"Failed"},null,4)):b("",!0),t(s).youtube.total?(r(),n("div",{key:2,class:"h-full bg-red-600/20 transition-all duration-300",style:y({width:`${Math.max(0,t(s).youtube.current-(t(s).youtube.successCurrent||0)-(t(s).youtube.failedCurrent||0))/t(s).youtube.total*100}%`})},null,4)):b("",!0)]),e("div",Rt,[e("div",Pt,[d[4]||(d[4]=e("div",{class:"i-mdi-check-circle"},null,-1)),x(" Success: "+a((t(s).youtube.successCurrent||0)+(t(s).youtube.successPrevious||0)),1)]),e("div",Ot,[d[5]||(d[5]=e("div",{class:"i-mdi-alert-circle"},null,-1)),x(" Failed: "+a((t(s).youtube.failedCurrent||0)+(t(s).youtube.failedPrevious||0)),1)])])])):b("",!0)])]))}}),Vt=Object.assign(Dt,{__name:"AdminYouTubeScraper"}),Mt={class:"space-y-2"},Tt={key:0,class:"text-sm font-medium text-theme-textmuted"},Et=["value","min","max","step","disabled","placeholder"],jt=w({__name:"AppInputNumber",props:{modelValue:{},label:{default:void 0},min:{default:void 0},max:{default:void 0},step:{default:1},disabled:{type:Boolean,default:!1},placeholder:{default:void 0}},emits:["update:modelValue"],setup(l,{emit:i}){const s=i,o=d=>{const u=d.target;s("update:modelValue",Number(u.value))};return(d,u)=>(r(),n("div",Mt,[l.label?(r(),n("label",Tt,a(l.label),1)):b("",!0),e("input",{value:l.modelValue,type:"number",min:l.min,max:l.max,step:l.step,disabled:l.disabled,placeholder:l.placeholder,class:_(["w-full px-4 py-2 bg-theme-surface border border-theme-border rounded-xl focus:ring-2 focus:ring-theme-primary outline-none transition-colors [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",{"opacity-50 cursor-not-allowed":l.disabled}]),onInput:o},null,42,Et)]))}}),ue=Object.assign(jt,{__name:"AppInputNumber"}),Ft={class:"relative"},Bt=["checked","disabled"],qt=w({__name:"AppInputSwitch",props:{checked:{type:Boolean},label:{default:void 0},disabled:{type:Boolean,default:!1}},emits:["change"],setup(l,{emit:i}){const s=i,o=d=>{const u=d.target;s("change",u.checked)};return(d,u)=>(r(),n("label",{class:_(["flex items-center gap-3 cursor-pointer group",{"opacity-50 cursor-not-allowed":l.disabled}])},[e("div",Ft,[e("input",{checked:l.checked,type:"checkbox",disabled:l.disabled,class:"sr-only peer",onChange:o},null,40,Bt),u[0]||(u[0]=e("div",{class:"w-10 h-6 bg-theme-border rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-1 after:left-1 after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-theme-primary"},null,-1))]),l.label?(r(),n("span",{key:0,class:_(["text-sm font-medium text-theme-text group-hover:text-theme-primary transition-colors",{"text-gray-500":l.disabled}])},a(l.label),3)):b("",!0),Ae(d.$slots,"default")],2))}}),ce=Object.assign(qt,{__name:"AppInputSwitch"}),It={class:"p-8 rounded-3xl shadow-lg border border-theme-border bg-theme-surface"},Ut={class:"space-y-6"},Lt={class:"flex flex-col gap-3"},Nt=["disabled"],Yt={key:0,class:"i-mdi-loading animate-spin"},zt={key:1,class:"i-mdi-database-sync"},Qt={key:0,class:"mt-4 space-y-3"},Wt={class:"flex items-center justify-between text-xs"},Ht={class:"text-theme-textmuted truncate mr-2"},Kt={class:"font-mono text-nowrap"},Gt={class:"h-3 bg-theme-border rounded-full overflow-hidden flex"},Jt={class:"grid grid-cols-2 gap-2 text-[10px] font-medium"},Xt={class:"flex items-center gap-1 text-green-600 dark:text-green-400"},Zt={class:"flex items-center gap-1 text-orange-600 dark:text-orange-400"},es=w({__name:"AdminOMDBEnrichment",props:P({loading:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:P(["start"],["update:modelValue"]),setup(l){const i=Y(l,"modelValue"),{progress:s}=j(M());return(o,d)=>{const u=ue,p=ce;return r(),n("div",It,[d[6]||(d[6]=e("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[e("div",{class:"i-mdi-database-sync text-green-600"}),x(" OMDB Enrichment ")],-1)),e("div",Ut,[f(u,{modelValue:i.value.limit,"onUpdate:modelValue":d[0]||(d[0]=v=>i.value.limit=v),label:"Enrichment limit"},null,8,["modelValue"]),e("div",Lt,[f(p,{checked:i.value.onlyUnmatched,label:"Only unmatched movies",onChange:d[1]||(d[1]=v=>i.value.onlyUnmatched=v)},null,8,["checked"]),f(p,{checked:i.value.forceRetryFailed,label:"Force retry failed matches",onChange:d[2]||(d[2]=v=>i.value.forceRetryFailed=v)},null,8,["checked"])]),e("button",{class:"w-full py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-2xl shadow-lg shadow-green-600/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l.loading,onClick:d[3]||(d[3]=v=>o.$emit("start"))},[l.loading?(r(),n("div",Yt)):(r(),n("div",zt)),x(" "+a(l.loading?"Enriching...":"Enrich with OMDB"),1)],8,Nt),t(s).omdb&&(t(s).omdb.status==="in_progress"||t(s).omdb.status==="starting")?(r(),n("div",Qt,[e("div",Wt,[e("span",Ht,a(t(s).omdb.message),1),e("span",Kt,a(t(s).omdb.current)+" / "+a(t(s).omdb.total||"?"),1)]),e("div",Gt,[t(s).omdb.total?(r(),n("div",{key:0,class:"h-full bg-green-500 transition-all duration-300",style:y({width:`${(t(s).omdb.successCurrent||0)/t(s).omdb.total*100}%`}),title:"Success"},null,4)):b("",!0),t(s).omdb.total?(r(),n("div",{key:1,class:"h-full bg-orange-500 transition-all duration-300",style:y({width:`${(t(s).omdb.failedCurrent||0)/t(s).omdb.total*100}%`}),title:"Failed"},null,4)):b("",!0),t(s).omdb.total?(r(),n("div",{key:2,class:"h-full bg-red-600/20 transition-all duration-300",style:y({width:`${Math.max(0,t(s).omdb.current-(t(s).omdb.successCurrent||0)-(t(s).omdb.failedCurrent||0))/t(s).omdb.total*100}%`})},null,4)):b("",!0)]),e("div",Jt,[e("div",Xt,[d[4]||(d[4]=e("div",{class:"i-mdi-check-circle"},null,-1)),x(" Success: "+a(t(s).omdb.successCurrent||0),1)]),e("div",Zt,[d[5]||(d[5]=e("div",{class:"i-mdi-alert-circle"},null,-1)),x(" Failed: "+a(t(s).omdb.failedCurrent||0),1)])])])):b("",!0)])])}}}),ts=Object.assign(es,{__name:"AdminOMDBEnrichment"}),ss={class:"p-8 rounded-3xl shadow-lg border border-theme-border bg-theme-surface"},ls={class:"space-y-6"},os={class:"flex flex-col gap-3"},as=["disabled"],rs={key:0,class:"i-mdi-loading animate-spin"},ns={key:1,class:"i-mdi-robot"},ds={key:0,class:"mt-4 space-y-3"},is={class:"flex items-center justify-between text-xs"},us={class:"text-theme-textmuted truncate mr-2"},cs={class:"font-mono text-nowrap"},ms={class:"h-3 bg-theme-border rounded-full overflow-hidden flex"},bs={class:"grid grid-cols-2 gap-2 text-[10px] font-medium"},gs={class:"flex items-center gap-1 text-purple-600 dark:text-purple-400"},xs={class:"flex items-center gap-1 text-orange-600 dark:text-orange-400"},ps=w({__name:"AdminAIExtractor",props:P({loading:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:P(["start"],["update:modelValue"]),setup(l){const i=Y(l,"modelValue"),s=M(),{progress:o}=j(s);return(d,u)=>{const p=ue,v=ce;return r(),n("div",ss,[u[6]||(u[6]=e("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[e("div",{class:"i-mdi-robot text-purple-600"}),x(" AI Metadata Extraction ")],-1)),e("div",ls,[f(p,{modelValue:i.value.limit,"onUpdate:modelValue":u[0]||(u[0]=c=>i.value.limit=c),label:"Extraction limit"},null,8,["modelValue"]),e("div",os,[f(v,{checked:i.value.onlyUnmatched,label:"Only unmatched movies",onChange:u[1]||(u[1]=c=>i.value.onlyUnmatched=c)},null,8,["checked"]),f(v,{checked:i.value.forceReExtract,label:"Force re-extract existing AI data",onChange:u[2]||(u[2]=c=>i.value.forceReExtract=c)},null,8,["checked"])]),e("button",{class:"w-full py-3 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-2xl shadow-lg shadow-purple-600/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l.loading,onClick:u[3]||(u[3]=c=>d.$emit("start"))},[l.loading?(r(),n("div",rs)):(r(),n("div",ns)),x(" "+a(l.loading?"Extracting...":"Extract with AI"),1)],8,as),t(o).ai&&(t(o).ai.status==="in_progress"||t(o).ai.status==="starting")?(r(),n("div",ds,[e("div",is,[e("span",us,a(t(o).ai.message),1),e("span",cs,a(t(o).ai.current)+" / "+a(t(o).ai.total||"?"),1)]),e("div",ms,[t(o).ai.total?(r(),n("div",{key:0,class:"h-full bg-purple-500 transition-all duration-300",style:y({width:`${(t(o).ai.successCurrent||0)/t(o).ai.total*100}%`}),title:"Success"},null,4)):b("",!0),t(o).ai.total?(r(),n("div",{key:1,class:"h-full bg-orange-500 transition-all duration-300",style:y({width:`${(t(o).ai.failedCurrent||0)/t(o).ai.total*100}%`}),title:"Failed"},null,4)):b("",!0)]),e("div",bs,[e("div",gs,[u[4]||(u[4]=e("div",{class:"i-mdi-check-circle"},null,-1)),x(" Success: "+a(t(o).ai.successCurrent||0),1)]),e("div",xs,[u[5]||(u[5]=e("div",{class:"i-mdi-alert-circle"},null,-1)),x(" Failed: "+a(t(o).ai.failedCurrent||0),1)])])])):b("",!0)])])}}}),vs=Object.assign(ps,{__name:"AdminAIExtractor"}),fs={class:"p-8 rounded-3xl shadow-lg border border-theme-border bg-theme-surface"},hs={class:"space-y-6"},ys={class:"flex flex-col gap-3"},ks=["disabled"],$s={key:0,class:"i-mdi-loading animate-spin"},_s={key:1,class:"i-mdi-download"},ws={key:0,class:"mt-4 space-y-2"},Ss={class:"flex items-center justify-between text-xs"},Cs={class:"text-theme-textmuted truncate mr-2"},As={class:"font-mono text-nowrap"},Rs={class:"h-2 bg-theme-border rounded-full overflow-hidden"},Ps=w({__name:"AdminPosterDownloader",props:P({loading:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:P(["start"],["update:modelValue"]),setup(l){const i=Y(l,"modelValue"),{progress:s}=j(M());return(o,d)=>{const u=ue,p=ce;return r(),n("div",fs,[d[3]||(d[3]=e("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[e("div",{class:"i-mdi-image-multiple text-purple-500"}),x(" Poster Downloader ")],-1)),e("div",hs,[f(u,{modelValue:i.value.limit,"onUpdate:modelValue":d[0]||(d[0]=v=>i.value.limit=v),label:"Download limit"},null,8,["modelValue"]),e("div",ys,[f(p,{checked:i.value.force,label:"Force re-download",onChange:d[1]||(d[1]=v=>i.value.force=v)},null,8,["checked"])]),e("button",{class:"w-full py-3 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-2xl shadow-lg shadow-purple-600/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l.loading,onClick:d[2]||(d[2]=v=>o.$emit("start"))},[l.loading?(r(),n("div",$s)):(r(),n("div",_s)),x(" "+a(l.loading?"Downloading...":"Download Posters"),1)],8,ks),t(s).posters&&t(s).posters.status==="in_progress"?(r(),n("div",ws,[e("div",Ss,[e("span",Cs,a(t(s).posters.message),1),e("span",As,a(t(s).posters.current)+" / "+a(t(s).posters.total),1)]),e("div",Rs,[e("div",{class:"h-full bg-purple-500 transition-all duration-300",style:y({width:`${t(s).posters.current/t(s).posters.total*100}%`})},null,4)])])):b("",!0)])])}}}),Os=Object.assign(Ps,{__name:"AdminPosterDownloader"}),Ds={class:"bg-theme-surface p-6 rounded-xl border border-theme-border shadow-sm"},Vs={class:"space-y-4"},Ms={key:0,class:"space-y-2"},Ts={class:"flex items-center justify-between text-xs"},Es={class:"text-theme-textmuted truncate mr-2"},js={class:"font-mono text-nowrap"},Fs={class:"h-2 bg-theme-border rounded-full overflow-hidden"},Bs={key:0,class:"space-y-3"},qs={class:"flex items-start gap-2"},Is={class:"flex-1"},Us={class:"text-sm text-green-700 dark:text-green-300 mt-1"},Ls={key:0,class:"mt-3 space-y-2"},Ns={class:"space-y-1"},Ys={class:"font-mono text-green-700 dark:text-green-300"},zs={class:"text-green-600 dark:text-green-400"},Qs={key:1,class:"flex items-start gap-2"},Ws={class:"text-sm text-red-700 dark:text-red-300 mt-1"},Hs=["disabled"],Ks=w({__name:"AdminPosterArchiver",setup(l){const i=$(!1),s=$(null),{progress:o}=j(M());async function d(){i.value=!0,s.value=null;try{const u=await $fetch("/api/admin/posters/archive",{method:"POST"});s.value=u}catch(u){s.value={success:!1,archivesCreated:0,totalPosters:0,totalSize:"0 B",archives:[],error:u instanceof Error?u.message:"Unknown error occurred"}}finally{i.value=!1}}return(u,p)=>(r(),n("div",Ds,[p[6]||(p[6]=e("h3",{class:"text-xl font-semibold mb-4 flex items-center gap-2"},[e("div",{class:"i-mdi-archive text-purple-600"}),x(" Poster Archiver ")],-1)),e("div",Vs,[p[5]||(p[5]=e("p",{class:"text-sm text-theme-textmuted"},[x(" Create tar.gz archives of all posters. Archives are split into <50MB chunks and saved to the "),e("code",{class:"px-1 py-0.5 bg-theme-background rounded text-xs"},"/data"),x(" directory. ")],-1)),t(o).posterArchive&&t(o).posterArchive.status==="in_progress"?(r(),n("div",Ms,[e("div",Ts,[e("span",Es,a(t(o).posterArchive.message),1),e("span",js,a(t(o).posterArchive.current)+" / "+a(t(o).posterArchive.total),1)]),e("div",Fs,[e("div",{class:"h-full bg-purple-500 transition-all duration-300",style:y({width:`${t(o).posterArchive.current/t(o).posterArchive.total*100}%`})},null,4)])])):b("",!0),t(s)?(r(),n("div",{key:1,class:_(["p-4 rounded-lg border",t(s).success?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"])},[t(s).success?(r(),n("div",Bs,[e("div",qs,[p[1]||(p[1]=e("div",{class:"i-mdi-check-circle text-green-600 dark:text-green-400 text-xl flex-shrink-0 mt-0.5"},null,-1)),e("div",Is,[p[0]||(p[0]=e("p",{class:"font-semibold text-green-800 dark:text-green-200"}," Archives Created Successfully ",-1)),e("p",Us," Created "+a(t(s).archivesCreated)+" archive"+a(t(s).archivesCreated!==1?"s":"")+" containing "+a(t(s).totalPosters)+" posters ("+a(t(s).totalSize)+") ",1)])]),t(s).archives.length>0?(r(),n("div",Ls,[p[2]||(p[2]=e("p",{class:"text-xs font-semibold text-green-800 dark:text-green-200 uppercase"}," Archives: ",-1)),e("div",Ns,[(r(!0),n(A,null,R(t(s).archives,v=>(r(),n("div",{key:v.filename,class:"flex items-center justify-between text-xs bg-white dark:bg-gray-800 p-2 rounded border border-green-200 dark:border-green-700"},[e("span",Ys,a(v.filename),1),e("span",zs,a(v.posterCount)+" posters • "+a(v.size),1)]))),128))])])):b("",!0)])):(r(),n("div",Qs,[p[4]||(p[4]=e("div",{class:"i-mdi-alert-circle text-red-600 dark:text-red-400 text-xl flex-shrink-0 mt-0.5"},null,-1)),e("div",null,[p[3]||(p[3]=e("p",{class:"font-semibold text-red-800 dark:text-red-200"}," Archive Creation Failed ",-1)),e("p",Ws,a(t(s).error),1)])]))],2)):b("",!0),e("button",{class:"w-full px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-300 dark:disabled:bg-gray-700 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2 font-medium",disabled:t(i),onClick:d},[e("div",{class:_(["i-mdi-archive",{"animate-spin":t(i)}])},null,2),x(" "+a(t(i)?"Creating Archives...":"Create Poster Archives"),1)],8,Hs)])]))}}),Gs=Object.assign(Ks,{__name:"AdminPosterArchiver"}),Js={class:"bg-theme-surface rounded-3xl border border-theme-border p-6"},Xs={class:"mb-4"},Zs=["disabled"],el={key:0,class:"space-y-4"},tl={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},sl={class:"bg-theme-background rounded-lg p-3"},ll={class:"text-xl font-semibold"},ol={class:"bg-theme-background rounded-lg p-3"},al={class:"text-xl font-semibold"},rl={class:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-3"},nl={class:"text-xl font-semibold text-orange-700 dark:text-orange-300"},dl={class:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3"},il={class:"text-xl font-semibold text-green-700 dark:text-green-300"},ul={class:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3"},cl={class:"text-xl font-semibold text-blue-700 dark:text-blue-300"},ml={class:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-3"},bl={class:"text-xl font-semibold text-purple-700 dark:text-purple-300"},gl={key:0,class:"space-y-2"},xl={class:"space-y-2 max-h-64 overflow-y-auto"},pl={class:"flex items-center justify-between mb-2"},vl={class:"text-sm font-medium text-theme-text"},fl={class:"text-xs text-theme-textmuted font-mono bg-theme-surface px-2 py-1 rounded"},hl={class:"text-sm text-theme-textmuted"},yl={key:1,class:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4"},kl={class:"flex items-center gap-2"},$l={class:"text-green-800 dark:text-green-200"},_l={key:2,class:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},wl=w({__name:"AdminDataDeduplication",props:{loading:{type:Boolean},results:{}},emits:["start"],setup(l){return(i,s)=>(r(),n("div",Js,[e("div",Xs,[s[1]||(s[1]=e("div",null,[e("h3",{class:"text-lg font-semibold flex items-center gap-2"},[e("div",{class:"i-mdi-broom text-orange-500"}),x(" Smart Description Cleanup ")]),e("p",{class:"text-sm text-theme-textmuted mt-1"}," Remove boilerplate and promotional descriptions using pattern detection ")],-1)),e("button",{class:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:l.loading,onClick:s[0]||(s[0]=o=>i.$emit("start"))},[e("div",{class:_(["i-mdi-broom",{"animate-pulse":l.loading}])},null,2),x(" "+a(l.loading?"Processing...":"Clean Descriptions"),1)],8,Zs)]),l.results?(r(),n("div",el,[e("div",tl,[e("div",sl,[s[2]||(s[2]=e("div",{class:"text-sm text-theme-textmuted"},"Total Sources",-1)),e("div",ll,a(l.results.totalSources.toLocaleString()),1)]),e("div",ol,[s[3]||(s[3]=e("div",{class:"text-sm text-theme-textmuted"},"With Descriptions",-1)),e("div",al,a(l.results.sourcesWithDescriptions.toLocaleString()),1)]),e("div",rl,[s[4]||(s[4]=e("div",{class:"text-sm text-orange-600 dark:text-orange-400"},"Patterns Found",-1)),e("div",nl,a(l.results.patterns.length),1)]),e("div",dl,[s[5]||(s[5]=e("div",{class:"text-sm text-green-600 dark:text-green-400"},"Sources Processed",-1)),e("div",il,a(l.results.sourcesProcessed.toLocaleString()),1)]),e("div",ul,[s[6]||(s[6]=e("div",{class:"text-sm text-blue-600 dark:text-blue-400"},"Boilerplate Removed",-1)),e("div",cl,a(l.results.boilerplateRemoved.toLocaleString()),1)]),e("div",ml,[s[7]||(s[7]=e("div",{class:"text-sm text-purple-600 dark:text-purple-400"},"Cleanup Rate",-1)),e("div",bl,a((l.results.boilerplateRemoved/l.results.sourcesWithDescriptions*100).toFixed(1))+"% ",1)])]),l.results.patterns.length>0?(r(),n("div",gl,[s[8]||(s[8]=e("h4",{class:"font-medium text-theme-text"}," Boilerplate Patterns Detected & Removed ",-1)),e("div",xl,[(r(!0),n(A,null,R(l.results.patterns,(o,d)=>(r(),n("div",{key:d,class:"bg-theme-background rounded-lg p-3"},[e("div",pl,[e("span",vl,a(o.count.toLocaleString())+" instances removed ",1),e("span",fl,a(o.pattern),1)]),e("div",hl,a(o.description),1)]))),128))])])):b("",!0),l.results.boilerplateRemoved>0?(r(),n("div",yl,[e("div",kl,[s[9]||(s[9]=e("div",{class:"i-mdi-check-circle text-green-500"},null,-1)),e("div",$l," Successfully removed "+a(l.results.boilerplateRemoved.toLocaleString())+" boilerplate descriptions using "+a(l.results.patterns.length)+" detection patterns. ",1)])])):l.results.boilerplateRemoved===0?(r(),n("div",_l,[...s[10]||(s[10]=[e("div",{class:"flex items-center gap-2"},[e("div",{class:"i-mdi-information text-blue-500"}),e("div",{class:"text-blue-800 dark:text-blue-200"}," No boilerplate descriptions detected for removal. ")],-1)])])):b("",!0)])):b("",!0)]))}}),Sl=Object.assign(wl,{__name:"AdminDataDeduplication"}),Cl={class:"bg-theme-surface rounded-3xl border border-theme-border p-6"},Al={class:"mb-4"},Rl=["disabled"],Pl={key:0,class:"space-y-4"},Ol={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Dl={class:"bg-theme-background rounded-lg p-3"},Vl={class:"text-xl font-semibold"},Ml={class:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-3"},Tl={class:"text-xl font-semibold text-purple-700 dark:text-purple-300"},El={class:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3"},jl={class:"text-xl font-semibold text-red-700 dark:text-red-300"},Fl={class:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3"},Bl={class:"text-xl font-semibold text-blue-700 dark:text-blue-300"},ql={key:0,class:"space-y-2"},Il={class:"space-y-2 max-h-96 overflow-y-auto"},Ul={class:"font-medium text-theme-text mb-2"},Ll={key:0,class:"text-sm text-red-600 dark:text-red-400 mb-1"},Nl={key:1,class:"text-sm text-blue-600 dark:text-blue-400"},Yl={key:1,class:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4"},zl={class:"flex items-center gap-2"},Ql={class:"text-green-800 dark:text-green-200"},Wl={key:2,class:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},Hl={key:3,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4"},Kl=w({__name:"AdminCollectionCleanup",props:{loading:{type:Boolean},results:{}},emits:["start"],setup(l){return(i,s)=>(r(),n("div",Cl,[e("div",Al,[s[1]||(s[1]=e("div",null,[e("h3",{class:"text-lg font-semibold flex items-center gap-2"},[e("div",{class:"i-mdi-folder-sync text-purple-500"}),x(" Collection Cleanup ")]),e("p",{class:"text-sm text-theme-textmuted mt-1"}," Remove non-existent movies and update outdated IDs in collections ")],-1)),e("button",{class:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed mt-3",disabled:l.loading,onClick:s[0]||(s[0]=o=>i.$emit("start"))},[e("div",{class:_(["i-mdi-folder-sync",{"animate-pulse":l.loading}])},null,2),x(" "+a(l.loading?"Cleaning...":"Clean Collections"),1)],8,Rl)]),l.results?(r(),n("div",Pl,[e("div",Ol,[e("div",Dl,[s[2]||(s[2]=e("div",{class:"text-sm text-theme-textmuted"},"Collections Processed",-1)),e("div",Vl,a(l.results.stats.collectionsProcessed),1)]),e("div",Ml,[s[3]||(s[3]=e("div",{class:"text-sm text-purple-600 dark:text-purple-400"},"Collections Modified",-1)),e("div",Tl,a(l.results.stats.collectionsModified),1)]),e("div",El,[s[4]||(s[4]=e("div",{class:"text-sm text-red-600 dark:text-red-400"},"Movies Removed",-1)),e("div",jl,a(l.results.stats.moviesRemoved),1)]),e("div",Fl,[s[5]||(s[5]=e("div",{class:"text-sm text-blue-600 dark:text-blue-400"},"IDs Updated",-1)),e("div",Bl,a(l.results.stats.moviesUpdated),1)])]),l.results.details.length>0?(r(),n("div",ql,[s[6]||(s[6]=e("h4",{class:"font-medium text-theme-text"}," Modified Collections ",-1)),e("div",Il,[(r(!0),n(A,null,R(l.results.details,(o,d)=>(r(),n("div",{key:d,class:"bg-theme-background rounded-lg p-3"},[e("div",Ul,a(o.collectionName),1),o.removedMovies.length>0?(r(),n("div",Ll," Removed "+a(o.removedMovies.length)+" movie(s): "+a(o.removedMovies.slice(0,3).join(", "))+a(o.removedMovies.length>3?"...":""),1)):b("",!0),o.updatedMovies.length>0?(r(),n("div",Nl," Updated "+a(o.updatedMovies.length)+" ID(s) ",1)):b("",!0)]))),128))])])):b("",!0),l.results.success&&l.results.stats.collectionsModified>0?(r(),n("div",Yl,[e("div",zl,[s[7]||(s[7]=e("div",{class:"i-mdi-check-circle text-green-500"},null,-1)),e("div",Ql," Successfully cleaned "+a(l.results.stats.collectionsModified)+" collection(s). Removed "+a(l.results.stats.moviesRemoved)+" non-existent movie(s) and updated "+a(l.results.stats.moviesUpdated)+" ID(s). ",1)])])):l.results.success&&l.results.stats.collectionsModified===0?(r(),n("div",Wl,[...s[8]||(s[8]=[e("div",{class:"flex items-center gap-2"},[e("div",{class:"i-mdi-information text-blue-500"}),e("div",{class:"text-blue-800 dark:text-blue-200"}," All collections are clean. No changes needed. ")],-1)])])):l.results.success?b("",!0):(r(),n("div",Hl,[...s[9]||(s[9]=[e("div",{class:"flex items-center gap-2"},[e("div",{class:"i-mdi-alert-circle text-red-500"}),e("div",{class:"text-red-800 dark:text-red-200"}," Collection cleanup failed. Please check the console for details. ")],-1)])]))])):b("",!0)]))}}),Gl=Object.assign(Kl,{__name:"AdminCollectionCleanup"}),Jl={class:"p-8 rounded-3xl shadow-lg border border-theme-border bg-theme-surface"},Xl={class:"flex items-center justify-between mb-6"},Zl={class:"text-xl font-bold"},eo={key:0,class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},to={class:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-2xl border border-blue-100 dark:border-blue-800"},so={class:"text-2xl font-bold text-blue-700 dark:text-blue-300"},lo={class:"p-4 bg-green-50 dark:bg-green-900/20 rounded-2xl border border-green-100 dark:border-green-800"},oo={class:"text-2xl font-bold text-green-700 dark:text-green-300"},ao={class:"text-[10px] text-green-600/70 dark:text-green-400/70 mt-1"},ro={class:"p-4 bg-orange-50 dark:bg-orange-900/20 rounded-2xl border border-orange-100 dark:border-orange-800"},no={class:"text-2xl font-bold text-orange-700 dark:text-orange-300"},io={class:"p-4 bg-gray-50 dark:bg-gray-900/20 rounded-2xl border border-gray-100 dark:border-gray-800"},uo={class:"text-2xl font-bold text-theme-text"},co={key:1,class:"mb-6 p-4 bg-orange-50/50 dark:bg-orange-900/10 rounded-2xl border border-orange-100 dark:border-orange-900/30"},mo={class:"flex flex-wrap gap-4"},bo={class:"text-xs font-medium text-theme-text capitalize"},go={class:"text-sm font-bold text-orange-600 dark:text-orange-400"},xo={key:2,class:"grid grid-cols-2 gap-4 mb-6"},po={class:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-2xl border border-blue-100 dark:border-blue-800"},vo={class:"text-2xl font-bold text-blue-700 dark:text-blue-300"},fo={class:"p-4 bg-red-50 dark:bg-red-900/20 rounded-2xl border border-red-100 dark:border-red-800"},ho={class:"text-2xl font-bold text-red-700 dark:text-red-300"},yo={key:3,class:"mb-6 space-y-3"},ko={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},$o={class:"font-bold text-sm mb-1 truncate"},_o={class:"flex flex-wrap gap-x-3 gap-y-1 text-xs text-theme-textmuted"},wo={class:"text-blue-600 dark:text-blue-400 font-medium"},So={class:"text-green-600 dark:text-green-400 font-medium"},Co={key:0},Ao={class:"text-orange-600 dark:text-orange-400 font-medium"},Ro={key:1},Po={class:"text-theme-textmuted font-medium"},Oo={key:4,class:"space-y-2"},Do={class:"text-sm font-bold text-red-500 uppercase tracking-wider"},Vo={class:"max-h-40 overflow-y-auto bg-red-50 dark:bg-red-900/10 p-4 rounded-xl text-xs font-mono text-red-600 dark:text-red-400 border border-red-100 dark:border-red-900/30"},Mo={key:5,class:"space-y-2 mt-6"},To={class:"text-sm font-bold text-blue-500 uppercase tracking-wider"},Eo={class:"max-h-60 overflow-y-auto bg-blue-50 dark:bg-blue-900/10 p-4 rounded-xl text-xs font-mono text-blue-600 dark:text-blue-400 border border-blue-100 dark:border-blue-900/30"},jo=w({__name:"AdminResultsLog",props:{results:{},posterResults:{}},emits:["clear"],setup(l){return(i,s)=>(r(),n("section",Jl,[e("div",Xl,[e("h2",Zl,a(l.posterResults?"Poster Download Results":"Scrape Results"),1),e("button",{class:"text-sm text-theme-textmuted hover:text-gray-700 dark:hover:text-gray-300",onClick:s[0]||(s[0]=o=>i.$emit("clear"))}," Clear ")]),l.results?(r(),n("div",eo,[e("div",to,[s[1]||(s[1]=e("div",{class:"text-xs text-blue-600 dark:text-blue-400 uppercase font-bold tracking-wider mb-1"}," Processed ",-1)),e("div",so,a(l.results.processed),1)]),e("div",lo,[s[2]||(s[2]=e("div",{class:"text-xs text-green-600 dark:text-green-400 uppercase font-bold tracking-wider mb-1"}," Success ",-1)),e("div",oo,a(l.results.added+l.results.updated),1),e("div",ao,a(l.results.added)+" added, "+a(l.results.updated)+" updated ",1)]),e("div",ro,[s[3]||(s[3]=e("div",{class:"text-xs text-orange-600 dark:text-orange-400 uppercase font-bold tracking-wider mb-1"}," Failed ",-1)),e("div",no,a(l.results.failed||0),1)]),e("div",io,[s[4]||(s[4]=e("div",{class:"text-xs text-theme-textmuted uppercase font-bold tracking-wider mb-1"}," Skipped ",-1)),e("div",uo,a(l.results.skipped||0),1)])])):b("",!0),l.results?.failureReasons&&Object.keys(l.results.failureReasons).length>0?(r(),n("div",co,[s[5]||(s[5]=e("h3",{class:"text-xs font-bold uppercase tracking-wider text-orange-600 dark:text-orange-400 mb-3"}," Failure Reasons ",-1)),e("div",mo,[(r(!0),n(A,null,R(l.results.failureReasons,(o,d)=>(r(),n("div",{key:d,class:"flex items-center gap-2"},[e("span",bo,a(d.replace("_"," "))+":",1),e("span",go,a(o),1)]))),128))])])):b("",!0),l.posterResults?(r(),n("div",xo,[e("div",po,[s[6]||(s[6]=e("div",{class:"text-xs text-blue-600 dark:text-blue-400 uppercase font-bold tracking-wider mb-1"}," Successful ",-1)),e("div",vo,a(l.posterResults.successful),1)]),e("div",fo,[s[7]||(s[7]=e("div",{class:"text-xs text-red-600 dark:text-red-400 uppercase font-bold tracking-wider mb-1"}," Failed ",-1)),e("div",ho,a(l.posterResults.failed),1)])])):b("",!0),l.results?.channels&&l.results.channels.length>0?(r(),n("div",yo,[s[12]||(s[12]=e("h3",{class:"text-sm font-bold uppercase tracking-wider text-theme-textmuted"}," Per-Channel Progress ",-1)),e("div",ko,[(r(!0),n(A,null,R(l.results.channels,o=>(r(),n("div",{key:o.id,class:"p-3 bg-gray-50 dark:bg-gray-900/40 rounded-xl border border-gray-100 dark:border-gray-800"},[e("div",$o,a(o.id),1),e("div",_o,[e("span",null,[s[8]||(s[8]=x("Processed: ",-1)),e("span",wo,a(o.processed),1)]),e("span",null,[s[9]||(s[9]=x("Success: ",-1)),e("span",So,a(o.added+o.updated),1)]),o.failed?(r(),n("span",Co,[s[10]||(s[10]=x("Failed: ",-1)),e("span",Ao,a(o.failed),1)])):b("",!0),o.skipped?(r(),n("span",Ro,[s[11]||(s[11]=x("Skipped: ",-1)),e("span",Po,a(o.skipped),1)])):b("",!0)])]))),128))])])):b("",!0),(l.results?.errors.length||0)>0||(l.posterResults?.errors.length||0)>0?(r(),n("div",Oo,[e("h3",Do," Errors ("+a((l.results?.errors.length||0)+(l.posterResults?.errors.length||0))+") ",1),e("div",Vo,[(r(!0),n(A,null,R(l.results?.errors||l.posterResults?.errors||[],(o,d)=>(r(),n("div",{key:d,class:"mb-1"}," • "+a(o),1))),128))])])):b("",!0),l.results?.debug&&l.results.debug.length>0?(r(),n("div",Mo,[e("h3",To," Debug Log ("+a(l.results.debug.length)+") ",1),e("div",Eo,[(r(!0),n(A,null,R(l.results.debug,(o,d)=>(r(),n("div",{key:d,class:"mb-1"},a(o),1))),128))])])):b("",!0)]))}}),Fo=Object.assign(jo,{__name:"AdminResultsLog"}),Bo=()=>{const l=M(),i=X("eventSource",()=>null),s=X("eventSourceConnected",()=>!1),o=X("eventSourceReconnecting",()=>!1),d=X("reconnectTimer",()=>null),u=()=>{if(i.value)return;const v=new EventSource("/api/admin/progress");v.onopen=()=>{s.value=!0,o.value=!1},v.onmessage=c=>{try{const S=JSON.parse(c.data);l.updateProgress(S)}catch(S){console.error("[SSE] Failed to parse message",S)}},v.onerror=c=>{console.error("[SSE] Connection error",c),s.value=!1,v.close(),i.value=null,d.value&&(clearTimeout(d.value),d.value=null),o.value=!0,d.value=setTimeout(()=>{d.value=null,u()},5e3)},i.value=v};return{connect:u,disconnect:()=>{d.value&&(clearTimeout(d.value),d.value=null),i.value&&(i.value.close(),i.value=null,s.value=!1,o.value=!1)},isConnected:s,isReconnecting:o}},qo={class:"min-h-screen bg-theme-background text-theme-text p-4 md:ml-16 transition-colors duration-300"},Io={key:0,class:"flex flex-col items-center justify-center h-[60vh] text-center"},Uo={key:1,class:"max-w-7xl mx-auto space-y-8"},Lo={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},No={class:"text-theme-textmuted mt-1 flex items-center gap-2"},Yo={key:0,class:"flex items-center gap-1 text-xs text-green-600 dark:text-green-400",title:"EventSource connected"},zo={key:1,class:"flex items-center gap-1 text-xs text-amber-600 dark:text-amber-400",title:"Reconnecting..."},Qo={key:2,class:"flex items-center gap-1 text-xs text-red-600 dark:text-red-400",title:"EventSource disconnected"},Wo={class:"flex flex-col items-end gap-3"},Ho={class:"flex items-center gap-3"},Ko=["disabled"],Go=["disabled"],Jo={key:0,class:"w-full max-w-md space-y-2"},Xo={class:"flex items-center justify-between text-xs"},Zo={class:"text-theme-textmuted truncate mr-2"},ea={class:"font-mono text-nowrap"},ta={class:"h-2 bg-theme-border rounded-full overflow-hidden"},sa={key:1,class:"w-full max-w-md space-y-2"},la={class:"flex items-center justify-between text-xs"},oa={class:"text-theme-textmuted truncate mr-2"},aa={class:"font-mono text-nowrap"},ra={class:"h-2 bg-theme-border rounded-full overflow-hidden"},na={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3"},da={key:1,class:"bg-theme-surface p-6 rounded-xl border border-theme-border shadow-sm"},ia={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"},ua={class:"text-[10px] text-theme-textmuted uppercase font-bold truncate"},ca={class:"text-2xl font-black text-theme-text"},ma={class:"space-y-6 grid grid-cols-1 lg:grid-cols-2 gap-8"},ba={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},ga={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},xa={class:"space-y-4"},ha=w({__name:"index",setup(l){Re({title:"Admin Dashboard - Movies Deluxe",meta:[{name:"robots",content:"noindex, nofollow"}]});const i=$(!1),s=M(),{connect:o,isConnected:d,isReconnecting:u}=Bo(),{loading:p,generatingSqlite:v,stats:c,archiveOptions:S,scraping:D,youtubeOptions:T,youtubeChannels:z,omdbOptions:F,aiOptions:B,posterOptions:q,deduplicating:Q,deduplicationResults:Z,cleaningCollections:ee,collectionCleanupResults:te,results:C,posterResults:W,progress:h,databasePercentOfTotal:se,totalExternalVideos:le,youtubeTotalScraped:H,youtubeFailedPercent:oe,youtubePercent:U,youtubeTotalAvailable:K,omdbFailedPercent:E,postersFailedPercent:ae}=j(s),G=O(()=>h.value.stats?.status==="in_progress"||p.value),re=()=>{s.results=null,s.posterResults=null,s.deduplicationResults=null,s.collectionCleanupResults=null};return Pe(async()=>{if(i.value=Oe(),i.value){o();try{const L=await $fetch("/data/stats.json");L&&(s.stats=L)}catch{await s.refreshStats()}await s.loadYouTubeChannels()}}),(L,m)=>{const J=ke,V=Ne,g=st,ne=gt,be=Vt,ge=ts,xe=vs,pe=Os,ve=Gs,fe=Sl,he=Gl,ye=Fo;return r(),n("div",qo,[t(i)?(r(),n("div",Uo,[e("header",Lo,[e("div",null,[m[15]||(m[15]=e("h1",{class:"text-3xl font-bold flex items-center gap-3"},[e("div",{class:"i-mdi-shield-crown text-blue-600"}),x(" Admin Dashboard ")],-1)),e("p",No,[m[14]||(m[14]=x(" Manage movie scraping and curation ",-1)),t(d)?(r(),n("span",Yo,[...m[11]||(m[11]=[e("div",{class:"i-mdi-circle text-8px animate-pulse"},null,-1),x(" Live ",-1)])])):t(u)?(r(),n("span",zo,[...m[12]||(m[12]=[e("div",{class:"i-mdi-circle text-8px animate-pulse"},null,-1),x(" Reconnecting ",-1)])])):(r(),n("span",Qo,[...m[13]||(m[13]=[e("div",{class:"i-mdi-circle text-8px"},null,-1),x(" Offline ",-1)])]))])]),e("div",Wo,[e("div",Ho,[f(J,{to:"/",class:"px-4 py-2 text-sm bg-theme-surface border border-theme-border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors flex items-center gap-2"},{default:de(()=>[...m[16]||(m[16]=[e("div",{class:"i-mdi-home"},null,-1),x(" View Site ",-1)])]),_:1}),f(J,{to:"/admin/collections",class:"px-4 py-2 text-sm bg-theme-surface border border-theme-border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors flex items-center gap-2"},{default:de(()=>[...m[17]||(m[17]=[e("div",{class:"i-mdi-movie-edit"},null,-1),x(" Collection Editor ",-1)])]),_:1}),e("button",{class:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",disabled:t(p)||t(v),onClick:m[0]||(m[0]=(...k)=>t(s).generateSqlite&&t(s).generateSqlite(...k))},[e("div",{class:_(["i-mdi-database-export",{"animate-spin":t(v)}])},null,2),m[18]||(m[18]=x(" Generate SQLite ",-1))],8,Ko),e("button",{class:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",disabled:t(p)||t(G),onClick:m[1]||(m[1]=(...k)=>t(s).refreshStats&&t(s).refreshStats(...k))},[e("div",{class:_(["i-mdi-refresh",{"animate-spin":t(G)}])},null,2),m[19]||(m[19]=x(" Refresh Stats ",-1))],8,Go)]),t(h).sqlite&&t(h).sqlite.status==="in_progress"?(r(),n("div",Jo,[e("div",Xo,[e("span",Zo,a(t(h).sqlite.message),1),e("span",ea,a(t(h).sqlite.current)+" / "+a(t(h).sqlite.total),1)]),e("div",ta,[e("div",{class:"h-full bg-blue-500 transition-all duration-300",style:y({width:`${t(h).sqlite.current/t(h).sqlite.total*100}%`})},null,4)])])):b("",!0),t(h).stats&&t(h).stats.status==="in_progress"?(r(),n("div",sa,[e("div",la,[e("span",oa,a(t(h).stats.message),1),e("span",aa,a(t(h).stats.current)+" / "+a(t(h).stats.total),1)]),e("div",ra,[e("div",{class:"h-full bg-green-500 transition-all duration-300",style:y({width:`${t(h).stats.current/t(h).stats.total*100}%`})},null,4)])])):b("",!0)])]),t(c)?(r(),n("section",na,[f(V,{title:"Total Movies",value:t(c).database.total,icon:"i-mdi-movie-open","icon-color":"text-blue-500","show-progress":"",percent:t(se),"progress-color":"bg-blue-500","percent-precision":1,subtitle:`of ${t(le).toLocaleString()} available`},null,8,["value","percent","subtitle"]),f(V,{title:"Archive.org",value:t(c).external.archiveOrg.scraped,failed:t(c).external.archiveOrg.failed,"failure-rate":t(c).external.archiveOrg.failureRate,icon:"i-mdi-archive","icon-color":"text-amber-500","show-progress":"",percent:t(c).external.archiveOrg.percent,"progress-color":"bg-amber-500",subtitle:`${t(c).external.archiveOrg.scraped} / ${t(c).external.archiveOrg.total||"?"} videos`},null,8,["value","failed","failure-rate","percent","subtitle"]),f(V,{title:"YouTube",value:t(H),failed:t(c).external.youtube.totalFailed,"failure-rate":t(c).external.youtube.failureRate,"failed-percent":t(oe),icon:"i-mdi-youtube","icon-color":"text-red-500","show-progress":"",percent:t(U),"progress-color":"bg-red-500",subtitle:`${t(H)} / ${t(K)||"?"} videos`},null,8,["value","failed","failure-rate","failed-percent","percent","subtitle"]),f(V,{title:"OMDB",value:t(c).omdb.matched,failed:t(c).omdb.failed,"failure-rate":t(c).omdb.failureRate,"failed-percent":t(E),icon:"i-mdi-database-sync","icon-color":"text-green-500","show-progress":"",percent:t(c).omdb.percent,"progress-color":"bg-green-500",subtitle:`${t(c).omdb.matched} / ${t(c).omdb.total} movies`},null,8,["value","failed","failure-rate","failed-percent","percent","subtitle"]),f(V,{title:"Posters",value:t(c).posters.downloaded,failed:t(c).posters.failed,"failure-rate":t(c).posters.failureRate,"failed-percent":t(ae),icon:"i-mdi-image-multiple","icon-color":"text-purple-500","show-progress":"",percent:t(c).posters.percentOfMoviesWithUrl,"progress-color":"bg-purple-500",subtitle:`${t(c).posters.downloaded} / ${t(c).posters.withPosterUrl} posters`},null,8,["value","failed","failure-rate","failed-percent","percent","subtitle"]),f(V,{title:"AI Extracted",value:t(c).ai.withAiData,icon:"i-mdi-robot","icon-color":"text-purple-500","show-progress":"",percent:t(c).ai.percent,"progress-color":"bg-purple-500",subtitle:`${t(c).ai.withAiData} / ${t(c).ai.totalUnmatched} unmatched`},null,8,["value","percent","subtitle"]),t(c)&&t(c).quality?(r(),ie(V,{key:0,title:"Low Quality",value:t(c).quality.totalMarked,icon:"i-mdi-quality-low","icon-color":"text-orange-600","show-progress":"",percent:t(c).quality.percent,"progress-color":"bg-orange-600",subtitle:`${t(c).quality.totalMarked} marked as low quality`},null,8,["value","percent","subtitle"])):b("",!0)])):b("",!0),e("section",null,[t(c)?.external.youtube.channels.length?(r(),ie(g,{key:0,channels:t(c).external.youtube.channels},null,8,["channels"])):b("",!0)]),t(c)&&t(c).quality&&t(c).quality.totalMarked>0?(r(),n("section",da,[m[20]||(m[20]=e("h2",{class:"text-xl font-bold mb-4 flex items-center gap-2 text-theme-text"},[e("div",{class:"i-mdi-quality-low text-orange-600"}),x(" Quality Label Breakdown ")],-1)),e("div",ia,[(r(!0),n(A,null,R(t(c).quality.breakdown,(k,me)=>(r(),n("div",{key:me,class:"flex flex-col p-3 rounded-lg bg-theme-background border border-gray-100 dark:border-gray-700"},[e("span",ua,a(me),1),e("span",ca,a(k),1)]))),128))])])):b("",!0),e("div",ma,[e("section",null,[m[21]||(m[21]=e("h2",{class:"text-2xl font-bold mb-4 flex items-center gap-2"},[e("div",{class:"i-mdi-database-import text-amber-600"}),x(" Data Collection ")],-1)),e("div",ba,[f(ne,{modelValue:t(S),"onUpdate:modelValue":m[2]||(m[2]=k=>I(S)?S.value=k:null),loading:t(D),onStart:t(s).startArchiveScrape},null,8,["modelValue","loading","onStart"]),f(be,{modelValue:t(T),"onUpdate:modelValue":m[3]||(m[3]=k=>I(T)?T.value=k:null),channels:t(z),loading:t(D),onStart:t(s).startYouTubeScrape},null,8,["modelValue","channels","loading","onStart"])])]),e("section",null,[m[23]||(m[23]=e("h2",{class:"text-2xl font-bold mb-4 flex items-center gap-2"},[e("div",{class:"i-mdi-database-sync text-green-600"}),x(" Data Enrichment ")],-1)),e("div",ga,[f(ge,{modelValue:t(F),"onUpdate:modelValue":m[4]||(m[4]=k=>I(F)?F.value=k:null),loading:t(D),onStart:t(s).startOMDBEnrichment},null,8,["modelValue","loading","onStart"]),f(xe,{modelValue:t(B),"onUpdate:modelValue":m[5]||(m[5]=k=>I(B)?B.value=k:null),loading:t(D),onStart:t(s).startAIExtraction},null,8,["modelValue","loading","onStart"]),f(pe,{modelValue:t(q),"onUpdate:modelValue":m[6]||(m[6]=k=>I(q)?q.value=k:null),loading:t(D),onStart:t(s).startPosterDownload},null,8,["modelValue","loading","onStart"]),f(ve),e("div",null,[m[22]||(m[22]=e("h3",{class:"text-xl font-semibold mb-4 flex items-center gap-2"},[e("div",{class:"i-mdi-broom text-orange-600"}),x(" Data Cleanup ")],-1)),e("div",xa,[f(fe,{loading:t(Q),results:t(Z),onStart:t(s).deduplicateDescriptions},null,8,["loading","results","onStart"]),f(he,{loading:t(ee),results:t(te),onStart:t(s).cleanupCollections},null,8,["loading","results","onStart"])])])])])]),t(C)||t(W)?(r(),ie(ye,{key:2,results:t(C),"poster-results":t(W),onClear:re},null,8,["results","poster-results"])):b("",!0)])):(r(),n("div",Io,[m[8]||(m[8]=e("div",{class:"i-mdi-lock text-64px text-gray-300 dark:text-gray-700 mb-4"},null,-1)),m[9]||(m[9]=e("h1",{class:"text-2xl font-bold mb-2"}," Access Denied ",-1)),m[10]||(m[10]=e("p",{class:"text-theme-textmuted"}," The admin interface is only available on localhost. ",-1)),f(J,{to:"/",class:"mt-6 px-6 py-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors"},{default:de(()=>[...m[7]||(m[7]=[x(" Back to Home ",-1)])]),_:1})]))])}}});export{ha as default};
