import{_ as j}from"./B-qhTGpT.js";import{g as z}from"./CZfkSF8C.js";import{f as V}from"./DMOTkeJ5.js";import{u as M}from"./CfQ1CYlZ.js";import{u as P}from"./CFWjqK0N.js";import{E as S,r as C,e as c,G as N,F as A,c as r,o as n,w as R,a,I as l,z as e,P as y,t as u,_ as T}from"./02OeVUp7.js";const B={english:"en",german:"de",french:"fr",spanish:"es",italian:"it",portuguese:"pt",russian:"ru",japanese:"ja",chinese:"zh",korean:"ko",arabic:"ar",hindi:"hi",dutch:"nl",polish:"pl",swedish:"sv",norwegian:"no",danish:"da",finnish:"fi",czech:"cs",hungarian:"hu",turkish:"tr",greek:"el",hebrew:"he",thai:"th",vietnamese:"vi"};function E(i){if(!i)return null;let t;if(Array.isArray(i)){if(i.length===0)return null;const x=i[0];if(!x)return null;t=x}else t=typeof i=="string"?i:String(i);const d=t.split(",")[0]?.trim().toLowerCase();return!d||d==="n/a"||d==="none"?null:d.length===2&&/^[a-z]{2}$/.test(d)?d:B[d]||null}function F(i){const t=E(i);return t?t.toUpperCase():""}const U={class:"aspect-[2/3] bg-theme-selection relative flex-shrink-0 overflow-hidden"},D=["src","alt"],$={key:2,class:"w-full h-full flex items-center justify-center text-gray-400 dark:text-gray-600"},G={key:3,class:"absolute top-1.5 right-1.5 flex flex-col gap-1 items-end"},O={key:0,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-gray-800 dark:text-white font-medium"},W={key:1,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-red-600 dark:text-red-400 font-bold"},Y={key:2,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-gray-800 dark:text-white font-bold"},q={key:4,class:"absolute top-1.5 left-1.5 w-7 h-7 rounded-full glass flex items-center justify-center z-10"},H=["title"],J={key:0,class:"absolute -bottom-1 -right-1 bg-theme-accent text-black text-[9px] font-black w-3.5 h-3.5 rounded-full flex items-center justify-center border border-theme-surface"},K={class:"p-3 flex-shrink-0"},Q={class:"font-bold text-sm line-clamp-2 mb-1.5 leading-snug min-h-[2.5rem]"},X={class:"flex items-center gap-1.5 text-[11px] text-theme-textmuted font-medium"},Z={key:0},ee={key:1,class:"opacity-50"},te={key:2,class:"flex items-center gap-1"},se={class:"font-bold text-theme-text"},ie={key:0,class:"text-[10px] opacity-70"},oe={key:1,class:"flex flex-col border border-red-500/50 rounded-xl overflow-hidden bg-theme-surface text-theme-text opacity-50",title:"Invalid movie data: missing imdbId"},ne={class:"p-3 flex-shrink-0"},re={class:"font-bold text-sm line-clamp-2 mb-1.5 leading-snug min-h-[2.5rem] text-red-400"},ae=S({__name:"MovieCard",props:{movie:{}},setup(i){const t=i,{isLiked:d}=M(),{getCollectionsForMovie:x}=P(),f=C(!1),m=C([]),b=c(()=>t.movie.imdbId?.startsWith("tt")??!1),v=c(()=>t.movie.imdbId?d(t.movie.imdbId):!1),I=c(()=>"verified"in t.movie?t.movie.verified:!1);N(async()=>{t.movie.imdbId&&(m.value=await x(t.movie.imdbId))});const k=c(()=>"sources"in t.movie&&t.movie.sources.length>0?!0:"sourceType"in t.movie&&!!t.movie.sourceType),h=c(()=>{if("metadata"in t.movie)return t.movie.metadata;const o=t.movie;return{imdbRating:o.imdbRating,imdbVotes:o.imdbVotes,Language:o.language}}),p=c(()=>{if("sources"in t.movie)return t.movie.sources[0];const o=t.movie;if(o.sourceType)return{type:o.sourceType,channelName:o.channelName,language:o.language}}),_=c(()=>{if(!k.value)return"";const o=h.value?.Language;if(o)return o.length===2?o.toUpperCase():F(o);const s=p.value?.language;if(s){const g=Array.isArray(s)?s[0]:s;if(g&&g.length===2)return g.toUpperCase()}return""}),L=o=>{f.value=!0;const s=o.target;s.style.display="none"};return(o,s)=>{const g=j;return i.movie.imdbId?(n(),A(g,{key:0,to:`/movie/${i.movie.imdbId}`,class:"flex flex-col border border-theme-border/50 rounded-xl overflow-hidden hover:shadow-xl hover:-translate-y-1 transition-all duration-300 bg-theme-surface text-theme-text"},{default:R(()=>[a("div",U,[e(b)?(n(),r("div",{key:0,class:y(["absolute inset-0 shimmer z-10 transition-opacity duration-500",{"opacity-0 pointer-events-none":e(f),"opacity-100":!e(f)}])},null,2)):l("",!0),e(b)?(n(),r("img",{key:1,src:("getPosterPath"in o?o.getPosterPath:e(z))(i.movie.imdbId),alt:i.movie.title,class:y(["w-full h-full object-cover object-center transition-opacity duration-700",{"opacity-0":!e(f),"opacity-100":e(f)}]),loading:"lazy",onLoad:s[0]||(s[0]=w=>f.value=!0),onError:L},null,42,D)):(n(),r("div",$,[...s[1]||(s[1]=[a("div",{class:"i-mdi-movie text-6xl"},null,-1)])])),e(k)?(n(),r("div",G,[e(p)?.type==="archive.org"?(n(),r("span",O," Archive.org ")):e(p)?.type==="youtube"?(n(),r("span",W,u(e(p).channelName||"YouTube"),1)):l("",!0),e(_)?(n(),r("span",Y,u(e(_)),1)):l("",!0)])):l("",!0),e(v)?(n(),r("div",q,[...s[2]||(s[2]=[a("div",{class:"i-mdi-heart text-red-500 text-lg"},null,-1)])])):l("",!0),e(m).length>0?(n(),r("div",{key:5,class:y(["absolute top-1.5 left-1.5 w-7 h-7 rounded-full glass flex items-center justify-center z-10",{"ml-8":e(v)}]),title:e(m).map(w=>w.name).join(", ")},[s[3]||(s[3]=a("div",{class:"i-mdi:movie-roll text-theme-accent text-lg"},null,-1)),e(m).length>1?(n(),r("span",J,u(e(m).length),1)):l("",!0)],10,H)):l("",!0),e(I)?(n(),r("div",{key:6,class:y(["absolute top-1.5 left-1.5 w-7 h-7 rounded-full flex items-center justify-center z-10",{"ml-8":e(v)&&e(m).length===0||!e(v)&&e(m).length>0,"ml-16":e(v)&&e(m).length>0}]),title:"Verified Source"},[...s[4]||(s[4]=[a("div",{class:"i-mdi-check-decagram text-green-600 text-2xl"},null,-1)])],2)):l("",!0)]),a("div",K,[a("h3",Q,u(i.movie.title),1),a("div",X,[i.movie.year?(n(),r("span",Z,u(i.movie.year),1)):l("",!0),i.movie.year&&e(h)?.imdbRating?(n(),r("span",ee,"â€¢")):l("",!0),e(h)?.imdbRating?(n(),r("span",te,[s[5]||(s[5]=a("div",{class:"i-mdi-star text-theme-accent text-xs"},null,-1)),a("span",se,u(e(h).imdbRating),1),e(h)?.imdbVotes?(n(),r("span",ie," ("+u(("formatVotes"in o?o.formatVotes:e(V))(e(h).imdbVotes))+") ",1)):l("",!0)])):l("",!0)])])]),_:1},8,["to"])):(n(),r("div",oe,[s[7]||(s[7]=a("div",{class:"aspect-[2/3] bg-theme-selection relative flex-shrink-0 overflow-hidden"},[a("div",{class:"w-full h-full flex items-center justify-center text-red-400"},[a("div",{class:"i-mdi-alert-circle text-6xl"})])],-1)),a("div",ne,[a("h3",re,u(i.movie.title||"Unknown Movie"),1),s[6]||(s[6]=a("div",{class:"text-[11px] text-red-400 font-medium"}," Missing ID ",-1))])]))}}}),he=Object.assign(T(ae,[["__scopeId","data-v-bd64bdf1"]]),{__name:"MovieCard"});export{he as _};
