import{_ as ke}from"./CREm91b_.js";import{g as _e,v as we,W as U,E as S,c as n,a as e,L as m,t as a,P as w,d as p,a8 as $,o as r,M as A,N as P,a9 as Se,r as _,B as H,e as O,aa as R,ab as z,H as F,z as t,T as Ce,a0 as Ae,ac as Pe,b as f,u as Re,J as Oe,w as de,F as ue}from"./DGvbdLlG.js";import{i as De}from"./BH85bPq3.js";const Ve="$s";function Z(...l){const d=typeof l[l.length-1]=="string"?l.pop():void 0;typeof l[0]!="string"&&l.unshift(d);const[s,o]=l;if(!s||typeof s!="string")throw new TypeError("[nuxt] [useState] key must be a string: "+s);if(o!==void 0&&typeof o!="function")throw new Error("[nuxt] [useState] init must be a function: "+o);const i=Ve+s,b=_e(),u=we(b.payload.state,i);if(u.value===void 0&&o){const v=o();if(U(v))return b.payload.state[i]=v,v;u.value=v}return u}const Te={class:"p-4 rounded-xl shadow-sm border border-theme-border bg-theme-surface"},Me={class:"flex items-center justify-between mb-2"},Ee={class:"text-xs font-medium text-theme-textmuted uppercase tracking-wider"},je={class:"text-2xl font-bold flex items-baseline gap-2"},Fe=["title"],Be={key:0,class:"mt-1 flex items-center gap-2"},qe={class:"flex-1 h-1 bg-theme-border rounded-full overflow-hidden flex"},Ie={class:"text-[10px] font-medium"},Ue={key:1,class:"flex items-center justify-between text-[10px] mt-1"},Le={key:0,class:"text-theme-textmuted"},Ne=S({__name:"AdminStatsCard",props:{title:{},value:{},icon:{},iconColor:{default:"text-blue-500"},subtitle:{default:void 0},showProgress:{type:Boolean,default:!1},percent:{default:0},progressColor:{default:"bg-blue-500"},percentPrecision:{default:0},failed:{default:void 0},failedPercent:{default:void 0},failureRate:{default:void 0}},setup(l){return(d,s)=>(r(),n("div",Te,[e("div",Me,[e("span",Ee,a(l.title),1),e("div",{class:w(["text-xl",[l.icon,l.iconColor]])},null,2)]),e("div",je,[p(a(l.value.toLocaleString())+" ",1),l.failed&&l.failed>0?(r(),n("span",{key:0,class:"text-xs font-medium text-orange-500",title:`${l.failed} failed`}," +"+a(l.failed)+" failed ",9,Fe)):m("",!0)]),l.showProgress?(r(),n("div",Be,[e("div",qe,[e("div",{class:w(["h-full transition-all duration-1000",l.progressColor]),style:$({width:`${l.percent}%`})},null,6),l.failed&&l.failed>0&&l.failedPercent!==void 0?(r(),n("div",{key:0,class:"h-full bg-orange-400 transition-all duration-1000",style:$({width:`${l.failedPercent}%`})},null,4)):m("",!0)]),e("span",Ie,a(l.percent?.toFixed(l.percentPrecision))+"%",1)])):m("",!0),l.subtitle||l.failureRate!==void 0&&l.failureRate>0?(r(),n("div",Ue,[l.subtitle?(r(),n("span",Le,a(l.subtitle),1)):m("",!0),l.failureRate!==void 0&&l.failureRate>0?(r(),n("span",{key:1,class:w(l.failureRate>20?"text-red-500 font-bold":"text-orange-500")},a(l.failureRate.toFixed(1))+"% fail ",3)):m("",!0)])):m("",!0)]))}}),Ye=Object.assign(Ne,{__name:"AdminStatsCard"}),He={class:"space-y-4"},ze={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},We={class:"flex items-center justify-between mb-2"},Qe={class:"text-sm font-bold truncate pr-2"},Ge=["title"],Je={class:"text-xl font-bold flex items-baseline gap-2"},Ke=["title"],Xe={class:"mt-1 flex items-center gap-2"},Ze={class:"flex-1 h-1 bg-theme-border rounded-full overflow-hidden flex"},et={class:"text-[10px] font-medium"},tt={class:"flex items-center justify-between text-[10px] text-theme-textmuted mt-1"},st=S({__name:"AdminYouTubeChannelStats",props:{channels:{}},setup(l){return(d,s)=>(r(),n("section",He,[s[0]||(s[0]=e("h2",{class:"text-xl font-bold flex items-center gap-2"},[e("div",{class:"i-mdi-youtube text-red-500"}),p(" YouTube Channel Statistics ")],-1)),e("div",ze,[(r(!0),n(A,null,P(l.channels,o=>(r(),n("div",{key:o.id,class:"p-4 rounded-xl shadow-sm border border-theme-border bg-theme-surface"},[e("div",We,[e("span",Qe,a(o.name),1),e("div",{class:w(["w-2 h-2 rounded-full",o.enabled?"bg-green-500":"bg-gray-300"]),title:o.enabled?"Enabled":"Disabled"},null,10,Ge)]),e("div",Je,[p(a(o.scraped)+" ",1),o.failed?(r(),n("span",{key:0,class:"text-xs font-medium text-orange-500",title:`${o.failed} failed videos`}," +"+a(o.failed)+" failed ",9,Ke)):m("",!0)]),e("div",Xe,[e("div",Ze,[e("div",{class:"h-full bg-red-500 transition-all duration-1000",style:$({width:`${o.total>0?o.scraped/o.total*100:0}%`})},null,4),o.failed?(r(),n("div",{key:0,class:"h-full bg-orange-400 transition-all duration-1000",style:$({width:`${o.total>0?o.failed/o.total*100:0}%`})},null,4)):m("",!0)]),e("span",et,a(o.total>0?(o.scraped/o.total*100).toFixed(0):0)+"%",1)]),e("div",tt,[e("span",null,a(o.scraped)+" / "+a(o.total||"?")+" videos",1),o.failureRate?(r(),n("span",{key:0,class:w(o.failureRate>20?"text-red-500 font-bold":"text-orange-500")},a(o.failureRate.toFixed(1))+"% fail ",3)):m("",!0)])]))),128))])]))}}),lt=Object.assign(st,{__name:"AdminYouTubeChannelStats"}),M=Se("admin",()=>{const l=_(!1),d=_(!1),s=_(!1),o=_(!1),i=_(!1),b=_(!1),u=_(null),v=_(null),y=_(null),x=_(null),D=_(null),V=_([]),E=_({}),W=H({collections:["feature_films"]}),B=H({limit:10,allPages:!1,channels:[]}),q=H({limit:50,force:!1}),I=H({limit:50,onlyUnmatched:!0,forceRetryFailed:!1}),Q=H({limit:100,onlyUnmatched:!0,forceReExtract:!1}),ee=g=>{E.value[g.type]=g},te=g=>{delete E.value[g]},se=async()=>{try{const g=await $fetch("/api/admin/scrape/youtube-channels");V.value=g.channels}catch(g){window.console.error("Failed to load YouTube channels",g)}},C=async()=>{l.value=!0;try{u.value=await $fetch("/api/admin/scrape/stats")}catch(g){window.console.error("Failed to fetch stats",g)}finally{l.value=!1}},G=async()=>{d.value=!0,v.value=null;try{v.value=await $fetch("/api/admin/scrape/archive",{method:"POST",body:W}),await C()}catch(g){window.console.error("Archive scrape failed",g),v.value={processed:0,added:0,updated:0,errors:[g instanceof Error?g.message:String(g)]}}finally{d.value=!1}},h=async()=>{d.value=!0,v.value=null;try{v.value=await $fetch("/api/admin/scrape/youtube",{method:"POST",body:B}),await C()}catch(g){window.console.error("YouTube scrape failed",g),v.value={processed:0,added:0,updated:0,errors:[g instanceof Error?g.message:String(g)]}}finally{d.value=!1}},le=async()=>{d.value=!0,y.value=null;try{y.value=await $fetch("/api/admin/posters/download",{method:"POST",body:q}),await C()}catch(g){window.console.error("Poster download failed",g),y.value={processed:0,successful:0,failed:0,errors:[g instanceof Error?g.message:String(g)]}}finally{d.value=!1}},oe=async()=>{d.value=!0,v.value=null;try{v.value=await $fetch("/api/admin/omdb/enrich",{method:"POST",body:I}),await C()}catch(g){window.console.error("OMDB enrichment failed",g),v.value={processed:0,added:0,updated:0,errors:[g instanceof Error?g.message:String(g)]}}finally{d.value=!1}},J=async()=>{d.value=!0;try{(await $fetch("/api/admin/ai/extract-batch",{method:"POST",body:Q})).success&&await C()}catch(g){window.console.error("AI extraction failed:",g)}finally{d.value=!1}},ae=async()=>{s.value=!0;try{await $fetch("/api/admin/sqlite/generate",{method:"POST"})}catch(g){window.console.error("SQLite generation failed",g)}finally{s.value=!1}},re=async()=>{o.value=!0;try{await $fetch("/api/admin/home/generate",{method:"POST"})}catch(g){window.console.error("Home page generation failed",g)}finally{o.value=!1}},L=O(()=>{if(!u.value)return 0;const g=u.value.external.archiveOrg.total||0,ie=u.value.external.youtube.totalAvailable||0;return g+ie}),K=O(()=>u.value&&u.value.external.youtube.totalScraped||0),j=O(()=>u.value&&u.value.external.youtube.totalAvailable||0),X=O(()=>j.value===0?0:K.value/j.value*100),ne=O(()=>!u.value||L.value===0?0:u.value.database.total/L.value*100),N=O(()=>!u.value||j.value===0?0:(u.value.external.youtube.totalFailed||0)/j.value*100),c=O(()=>!u.value||u.value.omdb.total===0?0:(u.value.omdb.failed||0)/u.value.omdb.total*100),Y=O(()=>!u.value||u.value.posters.withPosterUrl===0?0:(u.value.posters.failed||0)/u.value.posters.withPosterUrl*100);return{loading:l,scraping:d,generatingSqlite:s,generatingHomePages:o,deduplicating:i,cleaningCollections:b,stats:u,results:v,posterResults:y,deduplicationResults:x,collectionCleanupResults:D,youtubeChannels:V,progress:E,archiveOptions:W,youtubeOptions:B,posterOptions:q,omdbOptions:I,aiOptions:Q,updateProgress:ee,clearProgress:te,loadYouTubeChannels:se,refreshStats:C,startArchiveScrape:G,startYouTubeScrape:h,startPosterDownload:le,startOMDBEnrichment:oe,startAIExtraction:J,generateSqlite:ae,generateHomePages:re,deduplicateDescriptions:async()=>{i.value=!0,x.value=null;try{x.value=await $fetch("/api/admin/data/deduplicate-descriptions",{method:"POST"}),await C()}catch(g){window.console.error("Description deduplication failed",g),x.value={totalSources:0,sourcesWithDescriptions:0,boilerplateRemoved:0,sourcesProcessed:0,descriptionsRemoved:0,patterns:[]}}finally{i.value=!1}},cleanupCollections:async()=>{b.value=!0,D.value=null;try{D.value=await $fetch("/api/admin/collections/cleanup",{method:"POST"}),await C()}catch(g){window.console.error("Collection cleanup failed",g),D.value={success:!1,stats:{collectionsProcessed:0,moviesRemoved:0,moviesUpdated:0,collectionsModified:0},details:[]}}finally{b.value=!1}},totalExternalVideos:L,youtubeTotalScraped:K,youtubeTotalAvailable:j,youtubePercent:X,databasePercentOfTotal:ne,youtubeFailedPercent:N,omdbFailedPercent:c,postersFailedPercent:Y}}),ot={class:"p-8 rounded-3xl shadow-lg border border-theme-border bg-theme-surface"},at={class:"space-y-6"},rt=["disabled"],nt={key:0,class:"i-mdi-loading animate-spin"},it={key:1,class:"i-mdi-play"},dt={key:0,class:"mt-4 space-y-2"},ut={class:"flex items-center justify-between text-xs"},ct={class:"text-theme-textmuted truncate mr-2"},mt={class:"font-mono text-nowrap"},bt={class:"h-2 bg-theme-border rounded-full overflow-hidden"},gt=S({__name:"AdminArchiveScraper",props:R({loading:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:R(["start"],["update:modelValue"]),setup(l){z(l,"modelValue");const{progress:d}=F(M());return(s,o)=>(r(),n("div",ot,[o[2]||(o[2]=e("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[e("div",{class:"i-mdi-archive text-amber-500"}),p(" Archive.org Scraper ")],-1)),e("div",at,[o[1]||(o[1]=e("p",{class:"text-theme-textmuted text-sm"},` Scrapes all available movies from Archive.org's "Feature Films" collection. Always fetches 500 rows per page to minimize API calls and scrapes all pages until completion. `,-1)),e("button",{class:"w-full py-3 bg-amber-500 hover:bg-amber-600 text-white font-bold rounded-2xl shadow-lg shadow-amber-500/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l.loading,onClick:o[0]||(o[0]=i=>s.$emit("start"))},[l.loading?(r(),n("div",nt)):(r(),n("div",it)),p(" "+a(l.loading?"Scraping in progress...":"Start Archive.org Scrape"),1)],8,rt),t(d).archive&&t(d).archive.status==="in_progress"?(r(),n("div",dt,[e("div",ut,[e("span",ct,a(t(d).archive.message),1),e("span",mt,a(t(d).archive.current)+" / "+a(t(d).archive.total),1)]),e("div",bt,[e("div",{class:"h-full bg-amber-500 transition-all duration-300",style:$({width:`${t(d).archive.current/t(d).archive.total*100}%`})},null,4)])])):m("",!0)])]))}}),xt=Object.assign(gt,{__name:"AdminArchiveScraper"}),pt={class:"p-8 rounded-3xl shadow-lg border border-theme-border bg-theme-surface"},vt={class:"space-y-6"},ft={class:"space-y-2"},ht=["value"],yt={class:"text-xs text-theme-textmuted"},$t=["disabled"],kt={key:0,class:"i-mdi-loading animate-spin"},_t={key:1,class:"i-mdi-play"},wt={key:0,class:"mt-4 space-y-3"},St={class:"flex items-center justify-between text-xs"},Ct={class:"text-theme-textmuted truncate mr-2"},At={class:"font-mono text-nowrap"},Pt={class:"h-3 bg-theme-border rounded-full overflow-hidden flex"},Rt={class:"grid grid-cols-2 gap-2 text-[10px] font-medium"},Ot={class:"flex items-center gap-1 text-green-600 dark:text-green-400"},Dt={class:"flex items-center gap-1 text-orange-600 dark:text-orange-400"},Vt=S({__name:"AdminYouTubeScraper",props:R({channels:{},loading:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:R(["start"],["update:modelValue"]),setup(l){const d=z(l,"modelValue"),{progress:s}=F(M());return(o,i)=>(r(),n("div",pt,[i[6]||(i[6]=e("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[e("div",{class:"i-mdi-youtube text-red-500"}),p(" YouTube Scraper ")],-1)),e("div",vt,[e("div",ft,[i[2]||(i[2]=e("label",{class:"text-sm font-medium text-theme-textmuted"},"Select Channels",-1)),(r(!0),n(A,null,P(l.channels,b=>(r(),n("label",{key:b.id,class:"flex items-center gap-2 px-2 py-1 hover:bg-theme-selection rounded cursor-pointer text-sm"},[Ce(e("input",{"onUpdate:modelValue":i[0]||(i[0]=u=>d.value.channels=u),type:"checkbox",value:b.id,class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,8,ht),[[Ae,d.value.channels]]),e("span",null,a(b.name),1),e("span",yt,"("+a(b.language)+")",1)]))),128)),i[3]||(i[3]=e("p",{class:"text-[10px] text-theme-textmuted"}," If none selected, all enabled channels will be processed. ",-1))]),e("button",{class:"w-full py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-2xl shadow-lg shadow-red-600/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l.loading,onClick:i[1]||(i[1]=b=>o.$emit("start"))},[l.loading?(r(),n("div",kt)):(r(),n("div",_t)),p(" "+a(l.loading?"Scraping in progress...":"Start YouTube Scrape"),1)],8,$t),t(s).youtube&&t(s).youtube.status==="in_progress"?(r(),n("div",wt,[e("div",St,[e("span",Ct,a(t(s).youtube.message),1),e("span",At,a(t(s).youtube.current)+" / "+a(t(s).youtube.total||"?"),1)]),e("div",Pt,[t(s).youtube.total?(r(),n("div",{key:0,class:"h-full bg-green-500 transition-all duration-300",style:$({width:`${(t(s).youtube.successCurrent||0)/t(s).youtube.total*100}%`}),title:"Success"},null,4)):m("",!0),t(s).youtube.total?(r(),n("div",{key:1,class:"h-full bg-orange-500 transition-all duration-300",style:$({width:`${(t(s).youtube.failedCurrent||0)/t(s).youtube.total*100}%`}),title:"Failed"},null,4)):m("",!0),t(s).youtube.total?(r(),n("div",{key:2,class:"h-full bg-red-600/20 transition-all duration-300",style:$({width:`${Math.max(0,t(s).youtube.current-(t(s).youtube.successCurrent||0)-(t(s).youtube.failedCurrent||0))/t(s).youtube.total*100}%`})},null,4)):m("",!0)]),e("div",Rt,[e("div",Ot,[i[4]||(i[4]=e("div",{class:"i-mdi-check-circle"},null,-1)),p(" Success: "+a((t(s).youtube.successCurrent||0)+(t(s).youtube.successPrevious||0)),1)]),e("div",Dt,[i[5]||(i[5]=e("div",{class:"i-mdi-alert-circle"},null,-1)),p(" Failed: "+a((t(s).youtube.failedCurrent||0)+(t(s).youtube.failedPrevious||0)),1)])])])):m("",!0)])]))}}),Tt=Object.assign(Vt,{__name:"AdminYouTubeScraper"}),Mt={class:"space-y-2"},Et={key:0,class:"text-sm font-medium text-theme-textmuted"},jt=["value","min","max","step","disabled","placeholder"],Ft=S({__name:"AppInputNumber",props:{modelValue:{},label:{default:void 0},min:{default:void 0},max:{default:void 0},step:{default:1},disabled:{type:Boolean,default:!1},placeholder:{default:void 0}},emits:["update:modelValue"],setup(l,{emit:d}){const s=d,o=i=>{const b=i.target;s("update:modelValue",Number(b.value))};return(i,b)=>(r(),n("div",Mt,[l.label?(r(),n("label",Et,a(l.label),1)):m("",!0),e("input",{value:l.modelValue,type:"number",min:l.min,max:l.max,step:l.step,disabled:l.disabled,placeholder:l.placeholder,class:w(["w-full px-4 py-2 bg-theme-surface border border-theme-border rounded-xl focus:ring-2 focus:ring-theme-primary outline-none transition-colors [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",{"opacity-50 cursor-not-allowed":l.disabled}]),onInput:o},null,42,jt)]))}}),ce=Object.assign(Ft,{__name:"AppInputNumber"}),Bt={class:"relative"},qt=["checked","disabled"],It=S({__name:"AppInputSwitch",props:{checked:{type:Boolean},label:{default:void 0},disabled:{type:Boolean,default:!1}},emits:["change"],setup(l,{emit:d}){const s=d,o=i=>{const b=i.target;s("change",b.checked)};return(i,b)=>(r(),n("label",{class:w(["flex items-center gap-3 cursor-pointer group",{"opacity-50 cursor-not-allowed":l.disabled}])},[e("div",Bt,[e("input",{checked:l.checked,type:"checkbox",disabled:l.disabled,class:"sr-only peer",onChange:o},null,40,qt),b[0]||(b[0]=e("div",{class:"w-10 h-6 bg-theme-border rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-1 after:left-1 after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-theme-primary"},null,-1))]),l.label?(r(),n("span",{key:0,class:w(["text-sm font-medium text-theme-text group-hover:text-theme-primary transition-colors",{"text-gray-500":l.disabled}])},a(l.label),3)):m("",!0),Pe(i.$slots,"default")],2))}}),me=Object.assign(It,{__name:"AppInputSwitch"}),Ut={class:"p-8 rounded-3xl shadow-lg border border-theme-border bg-theme-surface"},Lt={class:"space-y-6"},Nt={class:"flex flex-col gap-3"},Yt=["disabled"],Ht={key:0,class:"i-mdi-loading animate-spin"},zt={key:1,class:"i-mdi-database-sync"},Wt={key:0,class:"mt-4 space-y-3"},Qt={class:"flex items-center justify-between text-xs"},Gt={class:"text-theme-textmuted truncate mr-2"},Jt={class:"font-mono text-nowrap"},Kt={class:"h-3 bg-theme-border rounded-full overflow-hidden flex"},Xt={class:"grid grid-cols-2 gap-2 text-[10px] font-medium"},Zt={class:"flex items-center gap-1 text-green-600 dark:text-green-400"},es={class:"flex items-center gap-1 text-orange-600 dark:text-orange-400"},ts=S({__name:"AdminOMDBEnrichment",props:R({loading:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:R(["start"],["update:modelValue"]),setup(l){const d=z(l,"modelValue"),{progress:s}=F(M());return(o,i)=>{const b=ce,u=me;return r(),n("div",Ut,[i[6]||(i[6]=e("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[e("div",{class:"i-mdi-database-sync text-green-600"}),p(" OMDB Enrichment ")],-1)),e("div",Lt,[f(b,{modelValue:d.value.limit,"onUpdate:modelValue":i[0]||(i[0]=v=>d.value.limit=v),label:"Enrichment limit"},null,8,["modelValue"]),e("div",Nt,[f(u,{checked:d.value.onlyUnmatched,label:"Only unmatched movies",onChange:i[1]||(i[1]=v=>d.value.onlyUnmatched=v)},null,8,["checked"]),f(u,{checked:d.value.forceRetryFailed,label:"Force retry failed matches",onChange:i[2]||(i[2]=v=>d.value.forceRetryFailed=v)},null,8,["checked"])]),e("button",{class:"w-full py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-2xl shadow-lg shadow-green-600/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l.loading,onClick:i[3]||(i[3]=v=>o.$emit("start"))},[l.loading?(r(),n("div",Ht)):(r(),n("div",zt)),p(" "+a(l.loading?"Enriching...":"Enrich with OMDB"),1)],8,Yt),t(s).omdb&&(t(s).omdb.status==="in_progress"||t(s).omdb.status==="starting")?(r(),n("div",Wt,[e("div",Qt,[e("span",Gt,a(t(s).omdb.message),1),e("span",Jt,a(t(s).omdb.current)+" / "+a(t(s).omdb.total||"?"),1)]),e("div",Kt,[t(s).omdb.total?(r(),n("div",{key:0,class:"h-full bg-green-500 transition-all duration-300",style:$({width:`${(t(s).omdb.successCurrent||0)/t(s).omdb.total*100}%`}),title:"Success"},null,4)):m("",!0),t(s).omdb.total?(r(),n("div",{key:1,class:"h-full bg-orange-500 transition-all duration-300",style:$({width:`${(t(s).omdb.failedCurrent||0)/t(s).omdb.total*100}%`}),title:"Failed"},null,4)):m("",!0),t(s).omdb.total?(r(),n("div",{key:2,class:"h-full bg-red-600/20 transition-all duration-300",style:$({width:`${Math.max(0,t(s).omdb.current-(t(s).omdb.successCurrent||0)-(t(s).omdb.failedCurrent||0))/t(s).omdb.total*100}%`})},null,4)):m("",!0)]),e("div",Xt,[e("div",Zt,[i[4]||(i[4]=e("div",{class:"i-mdi-check-circle"},null,-1)),p(" Success: "+a(t(s).omdb.successCurrent||0),1)]),e("div",es,[i[5]||(i[5]=e("div",{class:"i-mdi-alert-circle"},null,-1)),p(" Failed: "+a(t(s).omdb.failedCurrent||0),1)])])])):m("",!0)])])}}}),ss=Object.assign(ts,{__name:"AdminOMDBEnrichment"}),ls={class:"p-8 rounded-3xl shadow-lg border border-theme-border bg-theme-surface"},os={class:"space-y-6"},as={class:"flex flex-col gap-3"},rs=["disabled"],ns={key:0,class:"i-mdi-loading animate-spin"},is={key:1,class:"i-mdi-robot"},ds={key:0,class:"mt-4 space-y-3"},us={class:"flex items-center justify-between text-xs"},cs={class:"text-theme-textmuted truncate mr-2"},ms={class:"font-mono text-nowrap"},bs={class:"h-3 bg-theme-border rounded-full overflow-hidden flex"},gs={class:"grid grid-cols-2 gap-2 text-[10px] font-medium"},xs={class:"flex items-center gap-1 text-purple-600 dark:text-purple-400"},ps={class:"flex items-center gap-1 text-orange-600 dark:text-orange-400"},vs=S({__name:"AdminAIExtractor",props:R({loading:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:R(["start"],["update:modelValue"]),setup(l){const d=z(l,"modelValue"),s=M(),{progress:o}=F(s);return(i,b)=>{const u=ce,v=me;return r(),n("div",ls,[b[6]||(b[6]=e("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[e("div",{class:"i-mdi-robot text-purple-600"}),p(" AI Metadata Extraction ")],-1)),e("div",os,[f(u,{modelValue:d.value.limit,"onUpdate:modelValue":b[0]||(b[0]=y=>d.value.limit=y),label:"Extraction limit"},null,8,["modelValue"]),e("div",as,[f(v,{checked:d.value.onlyUnmatched,label:"Only unmatched movies",onChange:b[1]||(b[1]=y=>d.value.onlyUnmatched=y)},null,8,["checked"]),f(v,{checked:d.value.forceReExtract,label:"Force re-extract existing AI data",onChange:b[2]||(b[2]=y=>d.value.forceReExtract=y)},null,8,["checked"])]),e("button",{class:"w-full py-3 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-2xl shadow-lg shadow-purple-600/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l.loading,onClick:b[3]||(b[3]=y=>i.$emit("start"))},[l.loading?(r(),n("div",ns)):(r(),n("div",is)),p(" "+a(l.loading?"Extracting...":"Extract with AI"),1)],8,rs),t(o).ai&&(t(o).ai.status==="in_progress"||t(o).ai.status==="starting")?(r(),n("div",ds,[e("div",us,[e("span",cs,a(t(o).ai.message),1),e("span",ms,a(t(o).ai.current)+" / "+a(t(o).ai.total||"?"),1)]),e("div",bs,[t(o).ai.total?(r(),n("div",{key:0,class:"h-full bg-purple-500 transition-all duration-300",style:$({width:`${(t(o).ai.successCurrent||0)/t(o).ai.total*100}%`}),title:"Success"},null,4)):m("",!0),t(o).ai.total?(r(),n("div",{key:1,class:"h-full bg-orange-500 transition-all duration-300",style:$({width:`${(t(o).ai.failedCurrent||0)/t(o).ai.total*100}%`}),title:"Failed"},null,4)):m("",!0)]),e("div",gs,[e("div",xs,[b[4]||(b[4]=e("div",{class:"i-mdi-check-circle"},null,-1)),p(" Success: "+a(t(o).ai.successCurrent||0),1)]),e("div",ps,[b[5]||(b[5]=e("div",{class:"i-mdi-alert-circle"},null,-1)),p(" Failed: "+a(t(o).ai.failedCurrent||0),1)])])])):m("",!0)])])}}}),fs=Object.assign(vs,{__name:"AdminAIExtractor"}),hs={class:"p-8 rounded-3xl shadow-lg border border-theme-border bg-theme-surface"},ys={class:"space-y-6"},$s={class:"flex flex-col gap-3"},ks=["disabled"],_s={key:0,class:"i-mdi-loading animate-spin"},ws={key:1,class:"i-mdi-download"},Ss={key:0,class:"mt-4 space-y-2"},Cs={class:"flex items-center justify-between text-xs"},As={class:"text-theme-textmuted truncate mr-2"},Ps={class:"font-mono text-nowrap"},Rs={class:"h-2 bg-theme-border rounded-full overflow-hidden"},Os=S({__name:"AdminPosterDownloader",props:R({loading:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:R(["start"],["update:modelValue"]),setup(l){const d=z(l,"modelValue"),{progress:s}=F(M());return(o,i)=>{const b=ce,u=me;return r(),n("div",hs,[i[3]||(i[3]=e("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[e("div",{class:"i-mdi-image-multiple text-purple-500"}),p(" Poster Downloader ")],-1)),e("div",ys,[f(b,{modelValue:d.value.limit,"onUpdate:modelValue":i[0]||(i[0]=v=>d.value.limit=v),label:"Download limit"},null,8,["modelValue"]),e("div",$s,[f(u,{checked:d.value.force,label:"Force re-download",onChange:i[1]||(i[1]=v=>d.value.force=v)},null,8,["checked"])]),e("button",{class:"w-full py-3 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-2xl shadow-lg shadow-purple-600/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l.loading,onClick:i[2]||(i[2]=v=>o.$emit("start"))},[l.loading?(r(),n("div",_s)):(r(),n("div",ws)),p(" "+a(l.loading?"Downloading...":"Download Posters"),1)],8,ks),t(s).posters&&t(s).posters.status==="in_progress"?(r(),n("div",Ss,[e("div",Cs,[e("span",As,a(t(s).posters.message),1),e("span",Ps,a(t(s).posters.current)+" / "+a(t(s).posters.total),1)]),e("div",Rs,[e("div",{class:"h-full bg-purple-500 transition-all duration-300",style:$({width:`${t(s).posters.current/t(s).posters.total*100}%`})},null,4)])])):m("",!0)])])}}}),Ds=Object.assign(Os,{__name:"AdminPosterDownloader"}),Vs={class:"bg-theme-surface p-6 rounded-xl border border-theme-border shadow-sm"},Ts={class:"space-y-4"},Ms={key:0,class:"space-y-2"},Es={class:"flex items-center justify-between text-xs"},js={class:"text-theme-textmuted truncate mr-2"},Fs={class:"font-mono text-nowrap"},Bs={class:"h-2 bg-theme-border rounded-full overflow-hidden"},qs={key:0,class:"space-y-3"},Is={class:"flex items-start gap-2"},Us={class:"flex-1"},Ls={class:"text-sm text-green-700 dark:text-green-300 mt-1"},Ns={key:0,class:"mt-3 space-y-2"},Ys={class:"space-y-1"},Hs={class:"font-mono text-green-700 dark:text-green-300"},zs={class:"text-green-600 dark:text-green-400"},Ws={key:1,class:"flex items-start gap-2"},Qs={class:"text-sm text-red-700 dark:text-red-300 mt-1"},Gs=["disabled"],Js=S({__name:"AdminPosterArchiver",setup(l){const d=_(!1),s=_(null),{progress:o}=F(M());async function i(){d.value=!0,s.value=null;try{const b=await $fetch("/api/admin/posters/archive",{method:"POST"});s.value=b}catch(b){s.value={success:!1,archivesCreated:0,totalPosters:0,totalSize:"0 B",archives:[],error:b instanceof Error?b.message:"Unknown error occurred"}}finally{d.value=!1}}return(b,u)=>(r(),n("div",Vs,[u[6]||(u[6]=e("h3",{class:"text-xl font-semibold mb-4 flex items-center gap-2"},[e("div",{class:"i-mdi-archive text-purple-600"}),p(" Poster Archiver ")],-1)),e("div",Ts,[u[5]||(u[5]=e("p",{class:"text-sm text-theme-textmuted"},[p(" Create tar.gz archives of all posters. Archives are split into <50MB chunks and saved to the "),e("code",{class:"px-1 py-0.5 bg-theme-background rounded text-xs"},"/data"),p(" directory. ")],-1)),t(o).posterArchive&&t(o).posterArchive.status==="in_progress"?(r(),n("div",Ms,[e("div",Es,[e("span",js,a(t(o).posterArchive.message),1),e("span",Fs,a(t(o).posterArchive.current)+" / "+a(t(o).posterArchive.total),1)]),e("div",Bs,[e("div",{class:"h-full bg-purple-500 transition-all duration-300",style:$({width:`${t(o).posterArchive.current/t(o).posterArchive.total*100}%`})},null,4)])])):m("",!0),t(s)?(r(),n("div",{key:1,class:w(["p-4 rounded-lg border",t(s).success?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"])},[t(s).success?(r(),n("div",qs,[e("div",Is,[u[1]||(u[1]=e("div",{class:"i-mdi-check-circle text-green-600 dark:text-green-400 text-xl flex-shrink-0 mt-0.5"},null,-1)),e("div",Us,[u[0]||(u[0]=e("p",{class:"font-semibold text-green-800 dark:text-green-200"}," Archives Created Successfully ",-1)),e("p",Ls," Created "+a(t(s).archivesCreated)+" archive"+a(t(s).archivesCreated!==1?"s":"")+" containing "+a(t(s).totalPosters)+" posters ("+a(t(s).totalSize)+") ",1)])]),t(s).archives.length>0?(r(),n("div",Ns,[u[2]||(u[2]=e("p",{class:"text-xs font-semibold text-green-800 dark:text-green-200 uppercase"}," Archives: ",-1)),e("div",Ys,[(r(!0),n(A,null,P(t(s).archives,v=>(r(),n("div",{key:v.filename,class:"flex items-center justify-between text-xs bg-white dark:bg-gray-800 p-2 rounded border border-green-200 dark:border-green-700"},[e("span",Hs,a(v.filename),1),e("span",zs,a(v.posterCount)+" posters • "+a(v.size),1)]))),128))])])):m("",!0)])):(r(),n("div",Ws,[u[4]||(u[4]=e("div",{class:"i-mdi-alert-circle text-red-600 dark:text-red-400 text-xl flex-shrink-0 mt-0.5"},null,-1)),e("div",null,[u[3]||(u[3]=e("p",{class:"font-semibold text-red-800 dark:text-red-200"},"Archive Creation Failed",-1)),e("p",Qs,a(t(s).error),1)])]))],2)):m("",!0),e("button",{class:"w-full px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-300 dark:disabled:bg-gray-700 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2 font-medium",disabled:t(d),onClick:i},[e("div",{class:w(["i-mdi-archive",{"animate-spin":t(d)}])},null,2),p(" "+a(t(d)?"Creating Archives...":"Create Poster Archives"),1)],8,Gs)])]))}}),Ks=Object.assign(Js,{__name:"AdminPosterArchiver"}),Xs={class:"bg-theme-surface rounded-3xl border border-theme-border p-6"},Zs={class:"mb-4"},el=["disabled"],tl={key:0,class:"space-y-4"},sl={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},ll={class:"bg-theme-background rounded-lg p-3"},ol={class:"text-xl font-semibold"},al={class:"bg-theme-background rounded-lg p-3"},rl={class:"text-xl font-semibold"},nl={class:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-3"},il={class:"text-xl font-semibold text-orange-700 dark:text-orange-300"},dl={class:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3"},ul={class:"text-xl font-semibold text-green-700 dark:text-green-300"},cl={class:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3"},ml={class:"text-xl font-semibold text-blue-700 dark:text-blue-300"},bl={class:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-3"},gl={class:"text-xl font-semibold text-purple-700 dark:text-purple-300"},xl={key:0,class:"space-y-2"},pl={class:"space-y-2 max-h-64 overflow-y-auto"},vl={class:"flex items-center justify-between mb-2"},fl={class:"text-sm font-medium text-theme-text"},hl={class:"text-xs text-theme-textmuted font-mono bg-theme-surface px-2 py-1 rounded"},yl={class:"text-sm text-theme-textmuted"},$l={key:1,class:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4"},kl={class:"flex items-center gap-2"},_l={class:"text-green-800 dark:text-green-200"},wl={key:2,class:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},Sl=S({__name:"AdminDataDeduplication",props:{loading:{type:Boolean},results:{}},emits:["start"],setup(l){return(d,s)=>(r(),n("div",Xs,[e("div",Zs,[s[1]||(s[1]=e("div",null,[e("h3",{class:"text-lg font-semibold flex items-center gap-2"},[e("div",{class:"i-mdi-broom text-orange-500"}),p(" Smart Description Cleanup ")]),e("p",{class:"text-sm text-theme-textmuted mt-1"}," Remove boilerplate and promotional descriptions using pattern detection ")],-1)),e("button",{class:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:l.loading,onClick:s[0]||(s[0]=o=>d.$emit("start"))},[e("div",{class:w(["i-mdi-broom",{"animate-pulse":l.loading}])},null,2),p(" "+a(l.loading?"Processing...":"Clean Descriptions"),1)],8,el)]),l.results?(r(),n("div",tl,[e("div",sl,[e("div",ll,[s[2]||(s[2]=e("div",{class:"text-sm text-theme-textmuted"},"Total Sources",-1)),e("div",ol,a(l.results.totalSources.toLocaleString()),1)]),e("div",al,[s[3]||(s[3]=e("div",{class:"text-sm text-theme-textmuted"},"With Descriptions",-1)),e("div",rl,a(l.results.sourcesWithDescriptions.toLocaleString()),1)]),e("div",nl,[s[4]||(s[4]=e("div",{class:"text-sm text-orange-600 dark:text-orange-400"},"Patterns Found",-1)),e("div",il,a(l.results.patterns.length),1)]),e("div",dl,[s[5]||(s[5]=e("div",{class:"text-sm text-green-600 dark:text-green-400"},"Sources Processed",-1)),e("div",ul,a(l.results.sourcesProcessed.toLocaleString()),1)]),e("div",cl,[s[6]||(s[6]=e("div",{class:"text-sm text-blue-600 dark:text-blue-400"},"Boilerplate Removed",-1)),e("div",ml,a(l.results.boilerplateRemoved.toLocaleString()),1)]),e("div",bl,[s[7]||(s[7]=e("div",{class:"text-sm text-purple-600 dark:text-purple-400"},"Cleanup Rate",-1)),e("div",gl,a((l.results.boilerplateRemoved/l.results.sourcesWithDescriptions*100).toFixed(1))+"% ",1)])]),l.results.patterns.length>0?(r(),n("div",xl,[s[8]||(s[8]=e("h4",{class:"font-medium text-theme-text"},"Boilerplate Patterns Detected & Removed",-1)),e("div",pl,[(r(!0),n(A,null,P(l.results.patterns,(o,i)=>(r(),n("div",{key:i,class:"bg-theme-background rounded-lg p-3"},[e("div",vl,[e("span",fl,a(o.count.toLocaleString())+" instances removed ",1),e("span",hl,a(o.pattern),1)]),e("div",yl,a(o.description),1)]))),128))])])):m("",!0),l.results.boilerplateRemoved>0?(r(),n("div",$l,[e("div",kl,[s[9]||(s[9]=e("div",{class:"i-mdi-check-circle text-green-500"},null,-1)),e("div",_l," Successfully removed "+a(l.results.boilerplateRemoved.toLocaleString())+" boilerplate descriptions using "+a(l.results.patterns.length)+" detection patterns. ",1)])])):l.results.boilerplateRemoved===0?(r(),n("div",wl,[...s[10]||(s[10]=[e("div",{class:"flex items-center gap-2"},[e("div",{class:"i-mdi-information text-blue-500"}),e("div",{class:"text-blue-800 dark:text-blue-200"}," No boilerplate descriptions detected for removal. ")],-1)])])):m("",!0)])):m("",!0)]))}}),Cl=Object.assign(Sl,{__name:"AdminDataDeduplication"}),Al={class:"bg-theme-surface rounded-3xl border border-theme-border p-6"},Pl={class:"mb-4"},Rl=["disabled"],Ol={key:0,class:"space-y-4"},Dl={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Vl={class:"bg-theme-background rounded-lg p-3"},Tl={class:"text-xl font-semibold"},Ml={class:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-3"},El={class:"text-xl font-semibold text-purple-700 dark:text-purple-300"},jl={class:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3"},Fl={class:"text-xl font-semibold text-red-700 dark:text-red-300"},Bl={class:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3"},ql={class:"text-xl font-semibold text-blue-700 dark:text-blue-300"},Il={key:0,class:"space-y-2"},Ul={class:"space-y-2 max-h-96 overflow-y-auto"},Ll={class:"font-medium text-theme-text mb-2"},Nl={key:0,class:"text-sm text-red-600 dark:text-red-400 mb-1"},Yl={key:1,class:"text-sm text-blue-600 dark:text-blue-400"},Hl={key:1,class:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4"},zl={class:"flex items-center gap-2"},Wl={class:"text-green-800 dark:text-green-200"},Ql={key:2,class:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},Gl={key:3,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4"},Jl=S({__name:"AdminCollectionCleanup",props:{loading:{type:Boolean},results:{}},emits:["start"],setup(l){return(d,s)=>(r(),n("div",Al,[e("div",Pl,[s[1]||(s[1]=e("div",null,[e("h3",{class:"text-lg font-semibold flex items-center gap-2"},[e("div",{class:"i-mdi-folder-sync text-purple-500"}),p(" Collection Cleanup ")]),e("p",{class:"text-sm text-theme-textmuted mt-1"}," Remove non-existent movies and update outdated IDs in collections ")],-1)),e("button",{class:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed mt-3",disabled:l.loading,onClick:s[0]||(s[0]=o=>d.$emit("start"))},[e("div",{class:w(["i-mdi-folder-sync",{"animate-pulse":l.loading}])},null,2),p(" "+a(l.loading?"Cleaning...":"Clean Collections"),1)],8,Rl)]),l.results?(r(),n("div",Ol,[e("div",Dl,[e("div",Vl,[s[2]||(s[2]=e("div",{class:"text-sm text-theme-textmuted"},"Collections Processed",-1)),e("div",Tl,a(l.results.stats.collectionsProcessed),1)]),e("div",Ml,[s[3]||(s[3]=e("div",{class:"text-sm text-purple-600 dark:text-purple-400"},"Collections Modified",-1)),e("div",El,a(l.results.stats.collectionsModified),1)]),e("div",jl,[s[4]||(s[4]=e("div",{class:"text-sm text-red-600 dark:text-red-400"},"Movies Removed",-1)),e("div",Fl,a(l.results.stats.moviesRemoved),1)]),e("div",Bl,[s[5]||(s[5]=e("div",{class:"text-sm text-blue-600 dark:text-blue-400"},"IDs Updated",-1)),e("div",ql,a(l.results.stats.moviesUpdated),1)])]),l.results.details.length>0?(r(),n("div",Il,[s[6]||(s[6]=e("h4",{class:"font-medium text-theme-text"},"Modified Collections",-1)),e("div",Ul,[(r(!0),n(A,null,P(l.results.details,(o,i)=>(r(),n("div",{key:i,class:"bg-theme-background rounded-lg p-3"},[e("div",Ll,a(o.collectionName),1),o.removedMovies.length>0?(r(),n("div",Nl," Removed "+a(o.removedMovies.length)+" movie(s): "+a(o.removedMovies.slice(0,3).join(", "))+a(o.removedMovies.length>3?"...":""),1)):m("",!0),o.updatedMovies.length>0?(r(),n("div",Yl," Updated "+a(o.updatedMovies.length)+" ID(s) ",1)):m("",!0)]))),128))])])):m("",!0),l.results.success&&l.results.stats.collectionsModified>0?(r(),n("div",Hl,[e("div",zl,[s[7]||(s[7]=e("div",{class:"i-mdi-check-circle text-green-500"},null,-1)),e("div",Wl," Successfully cleaned "+a(l.results.stats.collectionsModified)+" collection(s). Removed "+a(l.results.stats.moviesRemoved)+" non-existent movie(s) and updated "+a(l.results.stats.moviesUpdated)+" ID(s). ",1)])])):l.results.success&&l.results.stats.collectionsModified===0?(r(),n("div",Ql,[...s[8]||(s[8]=[e("div",{class:"flex items-center gap-2"},[e("div",{class:"i-mdi-information text-blue-500"}),e("div",{class:"text-blue-800 dark:text-blue-200"}," All collections are clean. No changes needed. ")],-1)])])):l.results.success?m("",!0):(r(),n("div",Gl,[...s[9]||(s[9]=[e("div",{class:"flex items-center gap-2"},[e("div",{class:"i-mdi-alert-circle text-red-500"}),e("div",{class:"text-red-800 dark:text-red-200"}," Collection cleanup failed. Please check the console for details. ")],-1)])]))])):m("",!0)]))}}),Kl=Object.assign(Jl,{__name:"AdminCollectionCleanup"}),Xl={class:"p-8 rounded-3xl shadow-lg border border-theme-border bg-theme-surface"},Zl={class:"flex items-center justify-between mb-6"},eo={class:"text-xl font-bold"},to={key:0,class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},so={class:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-2xl border border-blue-100 dark:border-blue-800"},lo={class:"text-2xl font-bold text-blue-700 dark:text-blue-300"},oo={class:"p-4 bg-green-50 dark:bg-green-900/20 rounded-2xl border border-green-100 dark:border-green-800"},ao={class:"text-2xl font-bold text-green-700 dark:text-green-300"},ro={class:"text-[10px] text-green-600/70 dark:text-green-400/70 mt-1"},no={class:"p-4 bg-orange-50 dark:bg-orange-900/20 rounded-2xl border border-orange-100 dark:border-orange-800"},io={class:"text-2xl font-bold text-orange-700 dark:text-orange-300"},uo={class:"p-4 bg-gray-50 dark:bg-gray-900/20 rounded-2xl border border-gray-100 dark:border-gray-800"},co={class:"text-2xl font-bold text-theme-text"},mo={key:1,class:"mb-6 p-4 bg-orange-50/50 dark:bg-orange-900/10 rounded-2xl border border-orange-100 dark:border-orange-900/30"},bo={class:"flex flex-wrap gap-4"},go={class:"text-xs font-medium text-theme-text capitalize"},xo={class:"text-sm font-bold text-orange-600 dark:text-orange-400"},po={key:2,class:"grid grid-cols-2 gap-4 mb-6"},vo={class:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-2xl border border-blue-100 dark:border-blue-800"},fo={class:"text-2xl font-bold text-blue-700 dark:text-blue-300"},ho={class:"p-4 bg-red-50 dark:bg-red-900/20 rounded-2xl border border-red-100 dark:border-red-800"},yo={class:"text-2xl font-bold text-red-700 dark:text-red-300"},$o={key:3,class:"mb-6 space-y-3"},ko={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},_o={class:"font-bold text-sm mb-1 truncate"},wo={class:"flex flex-wrap gap-x-3 gap-y-1 text-xs text-theme-textmuted"},So={class:"text-blue-600 dark:text-blue-400 font-medium"},Co={class:"text-green-600 dark:text-green-400 font-medium"},Ao={key:0},Po={class:"text-orange-600 dark:text-orange-400 font-medium"},Ro={key:1},Oo={class:"text-theme-textmuted font-medium"},Do={key:4,class:"space-y-2"},Vo={class:"text-sm font-bold text-red-500 uppercase tracking-wider"},To={class:"max-h-40 overflow-y-auto bg-red-50 dark:bg-red-900/10 p-4 rounded-xl text-xs font-mono text-red-600 dark:text-red-400 border border-red-100 dark:border-red-900/30"},Mo={key:5,class:"space-y-2 mt-6"},Eo={class:"text-sm font-bold text-blue-500 uppercase tracking-wider"},jo={class:"max-h-60 overflow-y-auto bg-blue-50 dark:bg-blue-900/10 p-4 rounded-xl text-xs font-mono text-blue-600 dark:text-blue-400 border border-blue-100 dark:border-blue-900/30"},Fo=S({__name:"AdminResultsLog",props:{results:{},posterResults:{}},emits:["clear"],setup(l){return(d,s)=>(r(),n("section",Xl,[e("div",Zl,[e("h2",eo,a(l.posterResults?"Poster Download Results":"Scrape Results"),1),e("button",{class:"text-sm text-theme-textmuted hover:text-gray-700 dark:hover:text-gray-300",onClick:s[0]||(s[0]=o=>d.$emit("clear"))}," Clear ")]),l.results?(r(),n("div",to,[e("div",so,[s[1]||(s[1]=e("div",{class:"text-xs text-blue-600 dark:text-blue-400 uppercase font-bold tracking-wider mb-1"}," Processed ",-1)),e("div",lo,a(l.results.processed),1)]),e("div",oo,[s[2]||(s[2]=e("div",{class:"text-xs text-green-600 dark:text-green-400 uppercase font-bold tracking-wider mb-1"}," Success ",-1)),e("div",ao,a(l.results.added+l.results.updated),1),e("div",ro,a(l.results.added)+" added, "+a(l.results.updated)+" updated ",1)]),e("div",no,[s[3]||(s[3]=e("div",{class:"text-xs text-orange-600 dark:text-orange-400 uppercase font-bold tracking-wider mb-1"}," Failed ",-1)),e("div",io,a(l.results.failed||0),1)]),e("div",uo,[s[4]||(s[4]=e("div",{class:"text-xs text-theme-textmuted uppercase font-bold tracking-wider mb-1"}," Skipped ",-1)),e("div",co,a(l.results.skipped||0),1)])])):m("",!0),l.results?.failureReasons&&Object.keys(l.results.failureReasons).length>0?(r(),n("div",mo,[s[5]||(s[5]=e("h3",{class:"text-xs font-bold uppercase tracking-wider text-orange-600 dark:text-orange-400 mb-3"}," Failure Reasons ",-1)),e("div",bo,[(r(!0),n(A,null,P(l.results.failureReasons,(o,i)=>(r(),n("div",{key:i,class:"flex items-center gap-2"},[e("span",go,a(i.replace("_"," "))+":",1),e("span",xo,a(o),1)]))),128))])])):m("",!0),l.posterResults?(r(),n("div",po,[e("div",vo,[s[6]||(s[6]=e("div",{class:"text-xs text-blue-600 dark:text-blue-400 uppercase font-bold tracking-wider mb-1"}," Successful ",-1)),e("div",fo,a(l.posterResults.successful),1)]),e("div",ho,[s[7]||(s[7]=e("div",{class:"text-xs text-red-600 dark:text-red-400 uppercase font-bold tracking-wider mb-1"}," Failed ",-1)),e("div",yo,a(l.posterResults.failed),1)])])):m("",!0),l.results?.channels&&l.results.channels.length>0?(r(),n("div",$o,[s[12]||(s[12]=e("h3",{class:"text-sm font-bold uppercase tracking-wider text-theme-textmuted"}," Per-Channel Progress ",-1)),e("div",ko,[(r(!0),n(A,null,P(l.results.channels,o=>(r(),n("div",{key:o.id,class:"p-3 bg-gray-50 dark:bg-gray-900/40 rounded-xl border border-gray-100 dark:border-gray-800"},[e("div",_o,a(o.id),1),e("div",wo,[e("span",null,[s[8]||(s[8]=p("Processed: ",-1)),e("span",So,a(o.processed),1)]),e("span",null,[s[9]||(s[9]=p("Success: ",-1)),e("span",Co,a(o.added+o.updated),1)]),o.failed?(r(),n("span",Ao,[s[10]||(s[10]=p("Failed: ",-1)),e("span",Po,a(o.failed),1)])):m("",!0),o.skipped?(r(),n("span",Ro,[s[11]||(s[11]=p("Skipped: ",-1)),e("span",Oo,a(o.skipped),1)])):m("",!0)])]))),128))])])):m("",!0),(l.results?.errors.length||0)>0||(l.posterResults?.errors.length||0)>0?(r(),n("div",Do,[e("h3",Vo," Errors ("+a((l.results?.errors.length||0)+(l.posterResults?.errors.length||0))+") ",1),e("div",To,[(r(!0),n(A,null,P(l.results?.errors||l.posterResults?.errors||[],(o,i)=>(r(),n("div",{key:i,class:"mb-1"}," • "+a(o),1))),128))])])):m("",!0),l.results?.debug&&l.results.debug.length>0?(r(),n("div",Mo,[e("h3",Eo," Debug Log ("+a(l.results.debug.length)+") ",1),e("div",jo,[(r(!0),n(A,null,P(l.results.debug,(o,i)=>(r(),n("div",{key:i,class:"mb-1"},a(o),1))),128))])])):m("",!0)]))}}),Bo=Object.assign(Fo,{__name:"AdminResultsLog"}),qo=()=>{const l=M(),d=Z("eventSource",()=>null),s=Z("eventSourceConnected",()=>!1),o=Z("eventSourceReconnecting",()=>!1),i=Z("reconnectTimer",()=>null),b=()=>{if(d.value)return;const v=new EventSource("/api/admin/progress");v.onopen=()=>{s.value=!0,o.value=!1},v.onmessage=y=>{try{const x=JSON.parse(y.data);l.updateProgress(x)}catch(x){console.error("[SSE] Failed to parse message",x)}},v.onerror=y=>{console.error("[SSE] Connection error",y),s.value=!1,v.close(),d.value=null,i.value&&(clearTimeout(i.value),i.value=null),o.value=!0,i.value=setTimeout(()=>{i.value=null,b()},5e3)},d.value=v};return{connect:b,disconnect:()=>{i.value&&(clearTimeout(i.value),i.value=null),d.value&&(d.value.close(),d.value=null,s.value=!1,o.value=!1)},isConnected:s,isReconnecting:o}},Io={class:"min-h-screen bg-theme-background text-theme-text p-4 md:ml-16 transition-colors duration-300"},Uo={key:0,class:"flex flex-col items-center justify-center h-[60vh] text-center"},Lo={key:1,class:"max-w-7xl mx-auto space-y-8"},No={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},Yo={class:"text-theme-textmuted mt-1 flex items-center gap-2"},Ho={key:0,class:"flex items-center gap-1 text-xs text-green-600 dark:text-green-400",title:"EventSource connected"},zo={key:1,class:"flex items-center gap-1 text-xs text-amber-600 dark:text-amber-400",title:"Reconnecting..."},Wo={key:2,class:"flex items-center gap-1 text-xs text-red-600 dark:text-red-400",title:"EventSource disconnected"},Qo={class:"flex flex-col items-end gap-3"},Go={class:"flex items-center flex-wrap gap-3"},Jo=["disabled"],Ko=["disabled"],Xo=["disabled"],Zo={key:0,class:"w-full max-w-md space-y-2"},ea={class:"flex items-center justify-between text-xs"},ta={class:"text-theme-textmuted truncate mr-2"},sa={class:"font-mono text-nowrap"},la={class:"h-2 bg-theme-border rounded-full overflow-hidden"},oa={key:1,class:"w-full max-w-md space-y-2"},aa={class:"flex items-center justify-between text-xs"},ra={class:"text-theme-textmuted truncate mr-2"},na={class:"font-mono text-nowrap"},ia={class:"h-2 bg-theme-border rounded-full overflow-hidden"},da={key:2,class:"w-full max-w-md space-y-2"},ua={class:"flex items-center justify-between text-xs"},ca={class:"text-theme-textmuted truncate mr-2"},ma={class:"font-mono text-nowrap"},ba={class:"h-2 bg-theme-border rounded-full overflow-hidden"},ga={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3"},xa={key:1,class:"bg-theme-surface p-6 rounded-xl border border-theme-border shadow-sm"},pa={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"},va={class:"text-[10px] text-theme-textmuted uppercase font-bold truncate"},fa={class:"text-2xl font-black text-theme-text"},ha={class:"space-y-6 grid grid-cols-1 lg:grid-cols-2 gap-8"},ya={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},$a={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},ka={class:"space-y-4"},Ca=S({__name:"index",setup(l){Re({title:"Admin Dashboard - Movies Deluxe",meta:[{name:"robots",content:"noindex, nofollow"}]});const d=_(!1),s=M(),{connect:o,isConnected:i,isReconnecting:b}=qo(),{loading:u,generatingSqlite:v,generatingHomePages:y,stats:x,archiveOptions:D,scraping:V,youtubeOptions:E,youtubeChannels:W,omdbOptions:B,aiOptions:q,posterOptions:I,deduplicating:Q,deduplicationResults:ee,cleaningCollections:te,collectionCleanupResults:se,results:C,posterResults:G,progress:h,databasePercentOfTotal:le,totalExternalVideos:oe,youtubeTotalScraped:J,youtubeFailedPercent:ae,youtubePercent:re,youtubeTotalAvailable:L,omdbFailedPercent:K,postersFailedPercent:j}=F(s),X=O(()=>h.value.stats?.status==="in_progress"||u.value),ne=()=>{s.results=null,s.posterResults=null,s.deduplicationResults=null,s.collectionCleanupResults=null};return Oe(async()=>{if(d.value=De(),d.value){o();try{const N=await $fetch("/data/stats.json");N&&(s.stats=N)}catch{await s.refreshStats()}await s.loadYouTubeChannels()}}),(N,c)=>{const Y=ke,T=Ye,be=lt,g=xt,ie=Tt,xe=ss,pe=fs,ve=Ds,fe=Ks,he=Cl,ye=Kl,$e=Bo;return r(),n("div",Io,[t(d)?(r(),n("div",Lo,[e("header",No,[e("div",null,[c[16]||(c[16]=e("h1",{class:"text-3xl font-bold flex items-center gap-3"},[e("div",{class:"i-mdi-shield-crown text-blue-600"}),p(" Admin Dashboard ")],-1)),e("p",Yo,[c[15]||(c[15]=p(" Manage movie scraping and curation ",-1)),t(i)?(r(),n("span",Ho,[...c[12]||(c[12]=[e("div",{class:"i-mdi-circle text-8px animate-pulse"},null,-1),p(" Live ",-1)])])):t(b)?(r(),n("span",zo,[...c[13]||(c[13]=[e("div",{class:"i-mdi-circle text-8px animate-pulse"},null,-1),p(" Reconnecting ",-1)])])):(r(),n("span",Wo,[...c[14]||(c[14]=[e("div",{class:"i-mdi-circle text-8px"},null,-1),p(" Offline ",-1)])]))])]),e("div",Qo,[e("div",Go,[f(Y,{to:"/",class:"px-4 py-2 text-sm bg-theme-surface border border-theme-border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors flex items-center gap-2"},{default:de(()=>[...c[17]||(c[17]=[e("div",{class:"i-mdi-home"},null,-1),p(" View Site ",-1)])]),_:1}),f(Y,{to:"/admin/collections",class:"px-4 py-2 text-sm bg-theme-surface border border-theme-border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors flex items-center gap-2"},{default:de(()=>[...c[18]||(c[18]=[e("div",{class:"i-mdi-movie-edit"},null,-1),p(" Collection Editor ",-1)])]),_:1}),e("button",{class:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",disabled:t(u)||t(v),onClick:c[0]||(c[0]=(...k)=>t(s).generateSqlite&&t(s).generateSqlite(...k))},[e("div",{class:w(["i-mdi-database-export",{"animate-spin":t(v)}])},null,2),c[19]||(c[19]=p(" Generate SQLite ",-1))],8,Jo),e("button",{class:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",disabled:t(u)||t(y),onClick:c[1]||(c[1]=(...k)=>t(s).generateHomePages&&t(s).generateHomePages(...k))},[e("div",{class:w(["i-mdi-home-plus",{"animate-spin":t(y)}])},null,2),c[20]||(c[20]=p(" Generate Home Pages ",-1))],8,Ko),e("button",{class:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",disabled:t(u)||t(X),onClick:c[2]||(c[2]=(...k)=>t(s).refreshStats&&t(s).refreshStats(...k))},[e("div",{class:w(["i-mdi-refresh",{"animate-spin":t(X)}])},null,2),c[21]||(c[21]=p(" Refresh Stats ",-1))],8,Xo)]),t(h).sqlite&&t(h).sqlite.status==="in_progress"?(r(),n("div",Zo,[e("div",ea,[e("span",ta,a(t(h).sqlite.message),1),e("span",sa,a(t(h).sqlite.current)+" / "+a(t(h).sqlite.total),1)]),e("div",la,[e("div",{class:"h-full bg-blue-500 transition-all duration-300",style:$({width:`${t(h).sqlite.current/t(h).sqlite.total*100}%`})},null,4)])])):m("",!0),t(h).home&&t(h).home.status==="in_progress"?(r(),n("div",oa,[e("div",aa,[e("span",ra,a(t(h).home.message),1),e("span",na,a(t(h).home.current)+" / "+a(t(h).home.total),1)]),e("div",ia,[e("div",{class:"h-full bg-blue-500 transition-all duration-300",style:$({width:`${t(h).home.current/t(h).home.total*100}%`})},null,4)])])):m("",!0),t(h).stats&&t(h).stats.status==="in_progress"?(r(),n("div",da,[e("div",ua,[e("span",ca,a(t(h).stats.message),1),e("span",ma,a(t(h).stats.current)+" / "+a(t(h).stats.total),1)]),e("div",ba,[e("div",{class:"h-full bg-green-500 transition-all duration-300",style:$({width:`${t(h).stats.current/t(h).stats.total*100}%`})},null,4)])])):m("",!0)])]),t(x)?(r(),n("section",ga,[f(T,{title:"Total Movies",value:t(x).database.total,icon:"i-mdi-movie-open","icon-color":"text-blue-500","show-progress":"",percent:t(le),"progress-color":"bg-blue-500","percent-precision":1,subtitle:`of ${t(oe).toLocaleString()} available`},null,8,["value","percent","subtitle"]),f(T,{title:"Archive.org",value:t(x).external.archiveOrg.scraped,failed:t(x).external.archiveOrg.failed,"failure-rate":t(x).external.archiveOrg.failureRate,icon:"i-mdi-archive","icon-color":"text-amber-500","show-progress":"",percent:t(x).external.archiveOrg.percent,"progress-color":"bg-amber-500",subtitle:`${t(x).external.archiveOrg.scraped} / ${t(x).external.archiveOrg.total||"?"} videos`},null,8,["value","failed","failure-rate","percent","subtitle"]),f(T,{title:"YouTube",value:t(J),failed:t(x).external.youtube.totalFailed,"failure-rate":t(x).external.youtube.failureRate,"failed-percent":t(ae),icon:"i-mdi-youtube","icon-color":"text-red-500","show-progress":"",percent:t(re),"progress-color":"bg-red-500",subtitle:`${t(J)} / ${t(L)||"?"} videos`},null,8,["value","failed","failure-rate","failed-percent","percent","subtitle"]),f(T,{title:"OMDB",value:t(x).omdb.matched,failed:t(x).omdb.failed,"failure-rate":t(x).omdb.failureRate,"failed-percent":t(K),icon:"i-mdi-database-sync","icon-color":"text-green-500","show-progress":"",percent:t(x).omdb.percent,"progress-color":"bg-green-500",subtitle:`${t(x).omdb.matched} / ${t(x).omdb.total} movies`},null,8,["value","failed","failure-rate","failed-percent","percent","subtitle"]),f(T,{title:"Posters",value:t(x).posters.downloaded,failed:t(x).posters.failed,"failure-rate":t(x).posters.failureRate,"failed-percent":t(j),icon:"i-mdi-image-multiple","icon-color":"text-purple-500","show-progress":"",percent:t(x).posters.percentOfMoviesWithUrl,"progress-color":"bg-purple-500",subtitle:`${t(x).posters.downloaded} / ${t(x).posters.withPosterUrl} posters`},null,8,["value","failed","failure-rate","failed-percent","percent","subtitle"]),f(T,{title:"AI Extracted",value:t(x).ai.withAiData,icon:"i-mdi-robot","icon-color":"text-purple-500","show-progress":"",percent:t(x).ai.percent,"progress-color":"bg-purple-500",subtitle:`${t(x).ai.withAiData} / ${t(x).ai.totalUnmatched} unmatched`},null,8,["value","percent","subtitle"]),t(x)&&t(x).quality?(r(),ue(T,{key:0,title:"Low Quality",value:t(x).quality.totalMarked,icon:"i-mdi-quality-low","icon-color":"text-orange-600","show-progress":"",percent:t(x).quality.percent,"progress-color":"bg-orange-600",subtitle:`${t(x).quality.totalMarked} marked as low quality`},null,8,["value","percent","subtitle"])):m("",!0)])):m("",!0),e("section",null,[t(x)?.external.youtube.channels.length?(r(),ue(be,{key:0,channels:t(x).external.youtube.channels},null,8,["channels"])):m("",!0)]),t(x)&&t(x).quality&&t(x).quality.totalMarked>0?(r(),n("section",xa,[c[22]||(c[22]=e("h2",{class:"text-xl font-bold mb-4 flex items-center gap-2 text-theme-text"},[e("div",{class:"i-mdi-quality-low text-orange-600"}),p(" Quality Label Breakdown ")],-1)),e("div",pa,[(r(!0),n(A,null,P(t(x).quality.breakdown,(k,ge)=>(r(),n("div",{key:ge,class:"flex flex-col p-3 rounded-lg bg-theme-background border border-gray-100 dark:border-gray-700"},[e("span",va,a(ge),1),e("span",fa,a(k),1)]))),128))])])):m("",!0),e("div",ha,[e("section",null,[c[23]||(c[23]=e("h2",{class:"text-2xl font-bold mb-4 flex items-center gap-2"},[e("div",{class:"i-mdi-database-import text-amber-600"}),p(" Data Collection ")],-1)),e("div",ya,[f(g,{modelValue:t(D),"onUpdate:modelValue":c[3]||(c[3]=k=>U(D)?D.value=k:null),loading:t(V),onStart:t(s).startArchiveScrape},null,8,["modelValue","loading","onStart"]),f(ie,{modelValue:t(E),"onUpdate:modelValue":c[4]||(c[4]=k=>U(E)?E.value=k:null),channels:t(W),loading:t(V),onStart:t(s).startYouTubeScrape},null,8,["modelValue","channels","loading","onStart"])])]),e("section",null,[c[25]||(c[25]=e("h2",{class:"text-2xl font-bold mb-4 flex items-center gap-2"},[e("div",{class:"i-mdi-database-sync text-green-600"}),p(" Data Enrichment ")],-1)),e("div",$a,[f(xe,{modelValue:t(B),"onUpdate:modelValue":c[5]||(c[5]=k=>U(B)?B.value=k:null),loading:t(V),onStart:t(s).startOMDBEnrichment},null,8,["modelValue","loading","onStart"]),f(pe,{modelValue:t(q),"onUpdate:modelValue":c[6]||(c[6]=k=>U(q)?q.value=k:null),loading:t(V),onStart:t(s).startAIExtraction},null,8,["modelValue","loading","onStart"]),f(ve,{modelValue:t(I),"onUpdate:modelValue":c[7]||(c[7]=k=>U(I)?I.value=k:null),loading:t(V),onStart:t(s).startPosterDownload},null,8,["modelValue","loading","onStart"]),f(fe),e("div",null,[c[24]||(c[24]=e("h3",{class:"text-xl font-semibold mb-4 flex items-center gap-2"},[e("div",{class:"i-mdi-broom text-orange-600"}),p(" Data Cleanup ")],-1)),e("div",ka,[f(he,{loading:t(Q),results:t(ee),onStart:t(s).deduplicateDescriptions},null,8,["loading","results","onStart"]),f(ye,{loading:t(te),results:t(se),onStart:t(s).cleanupCollections},null,8,["loading","results","onStart"])])])])])]),t(C)||t(G)?(r(),ue($e,{key:2,results:t(C),"poster-results":t(G),onClear:ne},null,8,["results","poster-results"])):m("",!0)])):(r(),n("div",Uo,[c[9]||(c[9]=e("div",{class:"i-mdi-lock text-64px text-gray-300 dark:text-gray-700 mb-4"},null,-1)),c[10]||(c[10]=e("h1",{class:"text-2xl font-bold mb-2"},"Access Denied",-1)),c[11]||(c[11]=e("p",{class:"text-theme-textmuted"},"The admin interface is only available on localhost.",-1)),f(Y,{to:"/",class:"mt-6 px-6 py-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors"},{default:de(()=>[...c[8]||(c[8]=[p(" Back to Home ",-1)])]),_:1})]))])}}});export{Ca as default};
