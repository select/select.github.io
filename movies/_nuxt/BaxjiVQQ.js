import{e as z,c as d,o as l,I as T,g as $,f as u,m as _,T as j,h as I,U as N,p as F,k as S,l as t,N as W,F as C,r as V,q as U,j as Y,V as q,W as P,X}from"./DYx0OpAO.js";import{_ as A}from"./YvdTCYrK.js";const D={class:"block skeleton-border border rounded-xl overflow-hidden bg-white dark:bg-gray-900/50"},J=z({__name:"MovieCardSkeleton",setup(k){return(x,i)=>(l(),d("div",D,[...i[0]||(i[0]=[T('<div class="aspect-[2/3] skeleton shimmer relative"></div><div class="p-3 space-y-2"><div class="h-4 skeleton shimmer rounded-md w-3/4"></div><div class="h-4 skeleton shimmer rounded-md w-1/2"></div><div class="flex items-center gap-2 pt-1"><div class="h-3 skeleton shimmer rounded-md w-8"></div><div class="h-3 skeleton shimmer rounded-md w-12"></div></div></div>',2)])]))}}),oe=Object.assign(J,{__name:"MovieCardSkeleton"}),g=3,K=z({__name:"MovieVirtualGrid",props:{movies:{},totalMovies:{}},emits:["load-more"],setup(k,{emit:x}){const i=k,H=x,{y:B}=$(),{height:E,width:G}=q(),n=P(X),c=u(()=>n.xl.value?6:n.lg.value?5:n.md.value?4:n.sm.value?3:2),L=u(()=>n.xl.value?"grid-cols-6":n.lg.value?"grid-cols-5":n.md.value?"grid-cols-4":n.sm.value?"grid-cols-3":"grid-cols-2"),M=_(null),{height:b}=j(M),v=u(()=>{if(b.value>0)return b.value+16;const s=G.value||1024,r=n.lg.value?s*.12:32,m=s-r,o=(c.value-1)*16,h=(m-o)/c.value*1.5;return Math.ceil(h+80+16)}),R=u(()=>Math.ceil(i.movies.length/c.value)),O=u(()=>R.value*v.value),y=_(0),f=_(null),p=()=>{if(f.value){const s=f.value.getBoundingClientRect();y.value=s.top+window.scrollY}};I(()=>{p(),window.addEventListener("resize",p)}),N(()=>{window.removeEventListener("resize",p)});const e=u(()=>{if(!i.movies||i.movies.length===0)return[];const s=Math.max(0,B.value-y.value),r=Math.max(0,Math.floor(s/v.value)-g),m=Math.min(R.value-1,Math.ceil((s+E.value)/v.value)+g),a=[];for(let o=r;o<=m;o++){const w=o*c.value,h=i.movies.slice(w,w+c.value);h.length>0&&a.push({index:o,top:o*v.value,movies:h})}return a});return F(e,()=>{const s=Math.ceil(i.movies.length/c.value),r=e.value[e.value.length-1];r&&r.index>=s-g-1&&(window.console.log("[VirtualGrid] Load more triggered - lastVisibleRow:",r.index,"loadedRows:",s,"buffer:",g),H("load-more"))},{deep:!0}),(s,r)=>{const m=A;return l(),d("div",{ref_key:"gridRef",ref:f,class:"w-full"},[t(e).length>0&&t(e)[0]&&t(e)[0].index>0?(l(),d("div",{key:0,style:W({height:`${t(e)[0].top}px`})},null,4)):S("",!0),(l(!0),d(C,null,V(t(e),a=>(l(),d("div",{key:a.index,ref_for:!0,ref:a.index===0?o=>M.value=o:void 0,class:U(["grid gap-4 mb-4",t(L)])},[(l(!0),d(C,null,V(a.movies,o=>(l(),Y(m,{key:o.imdbId,movie:o},null,8,["movie"]))),128))],2))),128)),t(e).length>0&&t(e)[t(e).length-1]?(l(),d("div",{key:1,style:W({height:`${t(O)-(t(e)[t(e).length-1].top+t(v))}px`})},null,4)):S("",!0)],512)}}}),se=Object.assign(K,{__name:"MovieVirtualGrid"});export{oe as _,se as a};
