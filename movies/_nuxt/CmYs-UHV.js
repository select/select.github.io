import{_ as L}from"./Cz7KpdLU.js";import{g as z}from"./DLyjB8Jq.js";import{u as V}from"./D_UeB1-2.js";import{u as M}from"./C_tg1R71.js";import{e as N,m as k,f as m,h as P,j as $,c as a,o as n,w as F,a as r,k as l,l as t,q as v,t as u,_ as R}from"./C5QIVIht.js";function S(s){if(s==null||s==="")return"";let e;return typeof s=="number"?e=s:e=parseInt(s.replace(/,/g,""),10),isNaN(e)?"":e>=1e6?`${(e/1e6).toFixed(1)}M votes`:e>=1e3?`${(e/1e3).toFixed(1)}K votes`:`${e} votes`}const T={english:"en",german:"de",french:"fr",spanish:"es",italian:"it",portuguese:"pt",russian:"ru",japanese:"ja",chinese:"zh",korean:"ko",arabic:"ar",hindi:"hi",dutch:"nl",polish:"pl",swedish:"sv",norwegian:"no",danish:"da",finnish:"fi",czech:"cs",hungarian:"hu",turkish:"tr",greek:"el",hebrew:"he",thai:"th",vietnamese:"vi"};function B(s){if(!s)return null;const e=s.split(",")[0]?.trim().toLowerCase();return!e||e==="n/a"||e==="none"?null:e.length===2&&/^[a-z]{2}$/.test(e)?e:T[e]||null}function U(s){const e=B(s);return e?e.toUpperCase():""}const D={class:"aspect-[2/3] bg-theme-selection relative flex-shrink-0 overflow-hidden"},E=["src","alt"],q={key:2,class:"w-full h-full flex items-center justify-center text-gray-400 dark:text-gray-600"},A={key:3,class:"absolute top-1.5 right-1.5 flex flex-col gap-1 items-end"},K={key:0,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-gray-800 dark:text-white font-medium"},O={key:1,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-red-600 dark:text-red-400 font-bold"},W={key:2,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-gray-800 dark:text-white font-bold"},Y={key:4,class:"absolute top-1.5 left-1.5 w-7 h-7 rounded-full glass flex items-center justify-center z-10"},G=["title"],H={key:0,class:"absolute -bottom-1 -right-1 bg-theme-accent text-black text-[9px] font-black w-3.5 h-3.5 rounded-full flex items-center justify-center border border-theme-surface"},J={class:"p-3 flex-shrink-0"},Q={class:"font-bold text-sm line-clamp-2 mb-1.5 leading-snug min-h-[2.5rem]"},X={class:"flex items-center gap-1.5 text-[11px] text-theme-textmuted font-medium"},Z={key:0},ee={key:1,class:"opacity-50"},te={key:2,class:"flex items-center gap-1"},se={class:"font-bold text-theme-text"},ie={key:0,class:"text-[10px] opacity-70"},oe={key:1,class:"flex flex-col border border-red-500/50 rounded-xl overflow-hidden bg-theme-surface text-theme-text opacity-50",title:"Invalid movie data: missing imdbId"},ne={class:"p-3 flex-shrink-0"},ae={class:"font-bold text-sm line-clamp-2 mb-1.5 leading-snug min-h-[2.5rem] text-red-400"},re=N({__name:"MovieCard",props:{movie:{}},setup(s){const e=s,{isLiked:_}=V(),{getCollectionsForMovie:w}=M(),c=k(!1),d=k([]),x=m(()=>e.movie.imdbId?.startsWith("tt")??!1),h=m(()=>e.movie.imdbId?_(e.movie.imdbId):!1),C=m(()=>"verified"in e.movie?e.movie.verified:!1);P(async()=>{e.movie.imdbId&&(d.value=await w(e.movie.imdbId))});const p=m(()=>"sources"in e.movie&&e.movie.sources.length>0?!0:"sourceType"in e.movie&&!!e.movie.sourceType),f=m(()=>{if("metadata"in e.movie)return e.movie.metadata;const o=e.movie;return{imdbRating:o.imdbRating,imdbVotes:o.imdbVotes,Language:o.language}}),g=m(()=>{if("sources"in e.movie)return e.movie.sources[0];const o=e.movie;if(o.sourceType)return{type:o.sourceType,channelName:o.channelName,language:o.language}}),b=m(()=>{if(!p.value)return"";const o=f.value?.Language;if(o)return o.length===2?o.toUpperCase():U(o);const i=g.value?.language;return i&&i.length===2?i.toUpperCase():""}),I=o=>{c.value=!0;const i=o.target;i.style.display="none"};return(o,i)=>{const j=L;return s.movie.imdbId?(n(),$(j,{key:0,to:`/movie/${s.movie.imdbId}`,class:"flex flex-col border border-theme-border/50 rounded-xl overflow-hidden hover:shadow-xl hover:-translate-y-1 transition-all duration-300 bg-theme-surface text-theme-text"},{default:F(()=>[r("div",D,[t(x)?(n(),a("div",{key:0,class:v(["absolute inset-0 shimmer z-10 transition-opacity duration-500",{"opacity-0 pointer-events-none":t(c),"opacity-100":!t(c)}])},null,2)):l("",!0),t(x)?(n(),a("img",{key:1,src:("getPosterPath"in o?o.getPosterPath:t(z))(s.movie.imdbId),alt:s.movie.title,class:v(["w-full h-full object-cover object-center transition-opacity duration-700",{"opacity-0":!t(c),"opacity-100":t(c)}]),loading:"lazy",onLoad:i[0]||(i[0]=y=>c.value=!0),onError:I},null,42,E)):(n(),a("div",q,[...i[1]||(i[1]=[r("div",{class:"i-mdi-movie text-6xl"},null,-1)])])),t(p)?(n(),a("div",A,[t(g)?.type==="archive.org"?(n(),a("span",K," Archive.org ")):t(g)?.type==="youtube"?(n(),a("span",O,u(t(g).channelName||"YouTube"),1)):l("",!0),t(b)?(n(),a("span",W,u(t(b)),1)):l("",!0)])):l("",!0),t(h)?(n(),a("div",Y,[...i[2]||(i[2]=[r("div",{class:"i-mdi-heart text-red-500 text-lg"},null,-1)])])):l("",!0),t(d).length>0?(n(),a("div",{key:5,class:v(["absolute top-1.5 left-1.5 w-7 h-7 rounded-full glass flex items-center justify-center z-10",{"ml-8":t(h)}]),title:t(d).map(y=>y.name).join(", ")},[i[3]||(i[3]=r("div",{class:"i-mdi:movie-roll text-theme-accent text-lg"},null,-1)),t(d).length>1?(n(),a("span",H,u(t(d).length),1)):l("",!0)],10,G)):l("",!0),t(C)?(n(),a("div",{key:6,class:v(["absolute top-1.5 left-1.5 w-7 h-7 rounded-full flex items-center justify-center z-10",{"ml-8":t(h)&&t(d).length===0||!t(h)&&t(d).length>0,"ml-16":t(h)&&t(d).length>0}]),title:"Verified Source"},[...i[4]||(i[4]=[r("div",{class:"i-mdi-check-decagram text-green-600 text-2xl"},null,-1)])],2)):l("",!0)]),r("div",J,[r("h3",Q,u(s.movie.title),1),r("div",X,[s.movie.year?(n(),a("span",Z,u(s.movie.year),1)):l("",!0),s.movie.year&&t(f)?.imdbRating?(n(),a("span",ee,"â€¢")):l("",!0),t(f)?.imdbRating?(n(),a("span",te,[i[5]||(i[5]=r("div",{class:"i-mdi-star text-theme-accent text-xs"},null,-1)),r("span",se,u(t(f).imdbRating),1),t(f)?.imdbVotes?(n(),a("span",ie," ("+u(("formatVotes"in o?o.formatVotes:t(S))(t(f).imdbVotes))+") ",1)):l("",!0)])):l("",!0)])])]),_:1},8,["to"])):(n(),a("div",oe,[i[7]||(i[7]=r("div",{class:"aspect-[2/3] bg-theme-selection relative flex-shrink-0 overflow-hidden"},[r("div",{class:"w-full h-full flex items-center justify-center text-red-400"},[r("div",{class:"i-mdi-alert-circle text-6xl"})])],-1)),r("div",ne,[r("h3",ae,u(s.movie.title||"Unknown Movie"),1),i[6]||(i[6]=r("div",{class:"text-[11px] text-red-400 font-medium"}," Missing ID ",-1))])]))}}}),fe=Object.assign(R(re,[["__scopeId","data-v-3b46aeb8"]]),{__name:"MovieCard"});export{fe as _,S as f};
