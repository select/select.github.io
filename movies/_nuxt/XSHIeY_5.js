import{at as u,a9 as d,r as l,ap as f}from"./CTFmONrv.js";function F(c){return`${u().app.baseURL}posters/${c}.jpg`}const $=d("collections",()=>{const c=l(new Map),n=l(!1),s=l(!1),i=l(null),a=async()=>{if(!s.value){n.value=!0,i.value=null;try{const o=await $fetch("/data/collections.json");c.value.clear(),Object.entries(o).filter(([e])=>!e.startsWith("_")).map(([e,r])=>r).forEach(e=>{c.value.set(e.id,e)}),s.value=!0}catch(o){i.value=o.message||"Failed to load collections"}finally{n.value=!1}}};return{collections:c,isLoading:n,isLoaded:s,error:i,loadCollections:a,getCollectionById:async o=>(s.value||await a(),c.value.get(o)||null),addMovieToCollection:async(o,t)=>{try{const e=await $fetch("/api/admin/collections/add-movie",{method:"POST",body:{collectionId:o,movieId:t}});return e.success&&(s.value=!1,await a()),e.success}catch{return!1}},removeMovieFromCollection:async(o,t)=>{try{const e=await $fetch("/api/admin/collections/remove-movie",{method:"POST",body:{collectionId:o,movieId:t}});return e.success&&(s.value=!1,await a()),e.success}catch{return!1}},isMovieInCollection:(o,t)=>{const e=c.value.get(t);return e?e.movieIds.includes(o):!1},getCollectionsForMovie:async o=>{try{const t=f();return t.isReady.value?await t.getCollectionsForMovie(o):(s.value||await a(),Array.from(c.value.values()).filter(e=>e.movieIds.includes(o)))}catch{return[]}},addQueryToCollection:async(o,t)=>{try{const e=await $fetch("/api/admin/collections/update-collection",{method:"POST",body:{collectionId:o,updates:{queries:{action:"add",query:t}}}});return e.success&&(s.value=!1,await a()),e.success}catch{return!1}},removeQueryFromCollection:async(o,t)=>{try{const e=await $fetch("/api/admin/collections/update-collection",{method:"POST",body:{collectionId:o,updates:{queries:{action:"remove",index:t}}}});return e.success&&(s.value=!1,await a()),e.success}catch{return!1}},updateCollectionTags:async(o,t)=>{try{const e=await $fetch("/api/admin/collections/update-collection",{method:"POST",body:{collectionId:o,updates:{tags:{action:"set",values:t}}}});return e.success&&(s.value=!1,await a()),e.success}catch{return!1}},removeMoviesFromCollection:async(o,t)=>{try{const e=await $fetch("/api/admin/collections/update-collection",{method:"POST",body:{collectionId:o,updates:{movies:{action:"remove",movieIds:t}}}});return e.success&&(s.value=!1,await a()),e.success}catch{return!1}},reorderCollections:async o=>{try{const t=await $fetch("/api/admin/collections/reorder",{method:"POST",body:{collectionIds:o}});return t.success&&(s.value=!1,await a()),t.success}catch{return!1}}}});export{F as g,$ as u};
