import{_ as de}from"./6eiySPQC.js";import{E as Z,H as ce,e as B,r as R,B as we,J as me,c as i,a as e,L as F,t as h,z as t,d as V,M as z,N as G,a7 as oe,T as J,X as q,V as ae,W as fe,o as l,P as W,a2 as H,v as ve,l as ue,n as le,b as $,w as K,al as pe,Y as he,Z as $e,G as xe,am as ke,an as Se,ao as ge,u as Ce,ap as Ie}from"./BIsaz7oS.js";import{u as te,g as be}from"./BZoB5iRl.js";import{_ as Re,a as Te,b as Me,c as Ve,d as Ae,e as Fe,g as Ye,h as Ee,i as je,j as Le,f as ie,F as ee}from"./B5coZIsR.js";import{f as ye}from"./DMOTkeJ5.js";import{i as De}from"./BH85bPq3.js";import"./DvgieTos.js";import"./GRSIsFud.js";const Qe={class:"space-y-4"},Oe={class:"flex items-center justify-between"},Ne={class:"flex items-center gap-3"},Pe={class:"px-2 py-0.5 text-sm font-mono text-theme-text"},Ue={class:"flex flex-wrap gap-2"},Be=["onClick","onDragstart","onDragover","onDrop"],Ke={key:0,class:"i-mdi-eye-off text-xs opacity-70"},He={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"},ze={class:"bg-theme-surface rounded-2xl w-full max-w-lg shadow-2xl border border-theme-border overflow-hidden"},Ge={class:"p-6 border-b border-theme-border flex items-center justify-between"},We={class:"text-xl font-bold"},Ze=["disabled"],Xe={class:"flex flex-wrap gap-2 p-3 bg-theme-background border border-theme-border rounded-lg min-h-[50px]"},Je=["onClick"],qe={class:"relative flex-1 min-w-[120px]"},et=["onKeydown"],tt={key:0,class:"absolute z-10 left-0 right-0 mt-2 bg-theme-surface border border-theme-border rounded-lg shadow-xl max-h-48 overflow-y-auto"},st=["onMousedown"],ot={class:"pt-4 flex gap-3"},it=["disabled"],lt={key:0,class:"i-mdi-loading animate-spin mx-auto"},nt={key:1},rt=Z({__name:"AdminCollectionSelector",emits:["select"],setup(P,{expose:D,emit:a}){const S=te(),{collections:A}=ce(S),o=B(()=>Array.from(A.value.values())),T=B(()=>o.value.filter(v=>v.enabled!==!1).length),x=R(""),k=a,Y=v=>{x.value=v,k("select",v)},s=R(null),u=R(null),m=v=>{s.value=v},C=v=>{u.value=v},Q=async v=>{if(s.value===null||s.value===v)return;const f=[...o.value],[w]=f.splice(s.value,1);if(!w)return;f.splice(v,0,w),await S.reorderCollections(f.map(X=>X.id))?H().showToast("Collections reordered"):H().showToast("Failed to reorder collections","error")},O=()=>{s.value=null,u.value=null},d=R(!1),N=R(null),b=R(!1),r=we({id:"",name:"",description:"",tags:[]}),_=R(""),p=R(!1),j=B(()=>{const v=new Set;return A.value.forEach(f=>{f.tags&&f.tags.forEach(w=>v.add(w))}),Array.from(v).sort()}),y=B(()=>{const v=_.value.toLowerCase().trim();return j.value.filter(f=>f.toLowerCase().includes(v)&&!r.tags.includes(f))}),I=()=>{const v=_.value.trim();v&&!r.tags.includes(v)&&(r.tags.push(v),_.value="")},c=v=>{r.tags=r.tags.filter(f=>f!==v)},n=()=>{_.value===""&&r.tags.length>0&&r.tags.pop()},g=v=>{r.tags.includes(v)||r.tags.push(v),_.value="",p.value=!1},E=()=>{setTimeout(()=>{p.value=!1},200)},se=v=>{N.value=v,r.id=v.id,r.name=v.name,r.description=v.description,r.tags=[...v.tags||[]]},L=()=>{d.value=!1,N.value=null,r.id="",r.name="",r.description="",r.tags=[],_.value="",p.value=!1},U=async()=>{b.value=!0;try{N.value?(await $fetch("/api/admin/collections/update-collection",{method:"POST",body:{collectionId:r.id,updates:{name:r.name,description:r.description,tags:{action:"set",values:r.tags}}}})).success&&(await S.loadCollections(),L()):(await $fetch("/api/admin/collections/create",{method:"POST",body:r})).success&&(await S.loadCollections(),L())}catch{}finally{b.value=!1}},ne=async v=>{if(confirm(`Are you sure you want to delete the collection "${v.name}"? This cannot be undone.`))try{(await $fetch("/api/admin/collections/delete",{method:"POST",body:{id:v.id}})).success&&(x.value===v.id&&(x.value="",k("select","")),await S.loadCollections())}catch{}},re=async v=>{const f=v.enabled===!1;try{(await $fetch("/api/admin/collections/update-collection",{method:"POST",body:{collectionId:v.id,updates:{enabled:f}}})).success&&await S.loadCollections()}catch{}};return me(async()=>{S.isLoaded||await S.loadCollections()}),D({editCollection:se,toggleEnabled:re,confirmDelete:ne,openCreateModal:()=>d.value=!0}),(v,f)=>(l(),i("div",Qe,[e("div",Oe,[e("div",Ne,[f[6]||(f[6]=e("label",{class:"block text-sm font-bold text-theme-textmuted uppercase tracking-wider"}," Select Collection ",-1)),e("span",Pe,h(t(T))+"/"+h(t(o).length),1)]),e("button",{class:"px-3 py-1.5 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-xs font-bold transition-colors flex items-center gap-2",onClick:f[0]||(f[0]=w=>d.value=!0)},[...f[7]||(f[7]=[e("div",{class:"i-mdi-plus"},null,-1),V(" Create New ",-1)])])]),e("div",Ue,[(l(!0),i(z,null,G(t(o),(w,M)=>(l(),i("button",{key:w.id,draggable:"true",class:W(["px-4 py-2 rounded-xl border transition-all text-sm font-bold flex items-center gap-2 cursor-move",[t(x)===w.id?"bg-blue-600 text-white border-blue-600 shadow-lg shadow-blue-600/20":"bg-theme-surface border-theme-border hover:border-theme-textmuted text-theme-text",w.enabled===!1?"opacity-60":"",t(s)===M?"opacity-20":"",t(u)===M?"border-blue-500 border-2":""]]),onClick:X=>Y(w.id),onDragstart:X=>m(M),onDragover:oe(X=>C(M),["prevent"]),onDrop:X=>Q(M),onDragend:O},[V(h(w.name)+" ",1),w.enabled===!1?(l(),i("div",Ke)):F("",!0)],42,Be))),128))]),t(d)||t(N)?(l(),i("div",He,[e("div",ze,[e("div",Ge,[e("h3",We,h(t(N)?"Edit Collection":"Create New Collection"),1),e("button",{class:"p-2 hover:bg-theme-selection rounded-full transition-colors",onClick:L},[...f[8]||(f[8]=[e("div",{class:"i-mdi-close text-xl"},null,-1)])])]),e("form",{class:"p-6 space-y-4",onSubmit:oe(U,["prevent"])},[e("div",null,[f[9]||(f[9]=e("label",{class:"block text-sm font-bold mb-1"},"ID (URL Slug)",-1)),J(e("input",{"onUpdate:modelValue":f[1]||(f[1]=w=>t(r).id=w),type:"text",placeholder:"e.g. charlie-chaplin",class:"w-full px-4 py-2 rounded-lg border border-theme-border bg-theme-surface text-sm font-mono",disabled:!!t(N),required:""},null,8,Ze),[[q,t(r).id]])]),e("div",null,[f[10]||(f[10]=e("label",{class:"block text-sm font-bold mb-1"},"Name",-1)),J(e("input",{"onUpdate:modelValue":f[2]||(f[2]=w=>t(r).name=w),type:"text",placeholder:"e.g. Charlie Chaplin",class:"w-full px-4 py-2 rounded-lg border border-theme-border bg-theme-surface text-sm",required:""},null,512),[[q,t(r).name]])]),e("div",null,[f[11]||(f[11]=e("label",{class:"block text-sm font-bold mb-1"},"Description",-1)),J(e("textarea",{"onUpdate:modelValue":f[3]||(f[3]=w=>t(r).description=w),rows:"3",placeholder:"Describe this collection...",class:"w-full px-4 py-2 rounded-lg border border-theme-border bg-theme-surface text-sm"},null,512),[[q,t(r).description]])]),e("div",null,[f[13]||(f[13]=e("label",{class:"block text-sm font-bold mb-1"},"Tags",-1)),e("div",Xe,[(l(!0),i(z,null,G(t(r).tags,w=>(l(),i("div",{key:w,class:"flex items-center gap-1.5 px-3 py-1 bg-blue-600/10 text-blue-600 dark:text-blue-400 border border-blue-600/20 rounded-full text-sm font-medium group"},[V(h(w)+" ",1),e("button",{type:"button",class:"p-0.5 hover:bg-blue-600/20 rounded-full transition-colors",onClick:M=>c(w)},[...f[12]||(f[12]=[e("div",{class:"i-mdi-close text-xs"},null,-1)])],8,Je)]))),128)),e("div",qe,[J(e("input",{"onUpdate:modelValue":f[4]||(f[4]=w=>fe(_)?_.value=w:null),type:"text",placeholder:"Add tag...",class:"w-full bg-transparent border-none focus:ring-0 text-sm py-1",onKeydown:[ae(oe(I,["prevent"]),["enter"]),ae(n,["backspace"])],onFocus:f[5]||(f[5]=w=>p.value=!0),onBlur:E},null,40,et),[[q,t(_)]]),t(p)&&t(y).length>0?(l(),i("div",tt,[(l(!0),i(z,null,G(t(y),w=>(l(),i("button",{key:w,type:"button",class:"w-full text-left px-4 py-2 text-sm hover:bg-theme-selection transition-colors",onMousedown:oe(M=>g(w),["prevent"])},h(w),41,st))),128))])):F("",!0)])])]),e("div",ot,[e("button",{type:"button",class:"flex-1 px-4 py-2 border border-theme-border rounded-lg font-bold hover:bg-theme-selection transition-colors",onClick:L}," Cancel "),e("button",{type:"submit",class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-500 transition-colors disabled:opacity-50",disabled:t(b)},[t(b)?(l(),i("div",lt)):(l(),i("span",nt,h(t(N)?"Update":"Create"),1))],8,it)])],32)])])):F("",!0)]))}}),at=Object.assign(rt,{__name:"AdminCollectionSelector"}),dt={class:"space-y-4"},ct={class:"flex items-center gap-4"},ut={class:"relative flex-1"},mt={class:"absolute inset-y-0 left-2 flex items-center z-10"},ft={key:0,class:"pl-2 pr-1"},vt=["placeholder"],pt={class:"absolute inset-y-0 right-0 flex items-center pr-2 z-10"},ht={class:"flex flex-wrap items-center gap-2 pb-1"},xt=["disabled"],gt=Z({__name:"AdminSearchHeader",props:{filters:{},isFiltering:{type:Boolean}},emits:["search"],setup(P,{emit:D}){const a=P,S=D,o=ue(ee,null)||ve(a,"filters");pe(ee,o);const T=R(null),x=R(o.value.searchQuery),k=R(null),Y=R(null),s=(c,n)=>{k.value===c?(k.value=null,Y.value=null):(k.value=c,Y.value=n.currentTarget)},u=()=>{k.value=null,Y.value=null},m=B(()=>a.filters.sort.field==="year"&&a.filters.sort.direction==="desc"),C=B(()=>{if(m.value)return"";const c=a.filters.sort.field,n=a.filters.sort.direction;return c==="relevance"?"Relevance":c==="year"?n==="desc"?"Newest":"Oldest":c==="rating"?n==="desc"?"High":"Low":c==="title"?n==="asc"?"A-Z":"Z-A":c==="votes"?"Popular":""}),Q=B(()=>{const c=a.filters.minYear,n=a.filters.maxYear;return c&&n&&c!==1910&&n!==2025?`${c}-${n}`:c&&c!==1910?`${c}+`:n&&n!==2025?`Up to ${n}`:""}),O=B(()=>{const c=a.filters.minVotes,n=a.filters.maxVotes;return c&&n&&n<1e6?`${ie(c)}-${ie(n)}`:c?`${ie(c)}+`:n&&n<1e6?`< ${ie(n)}`:""}),d=B(()=>a.filters.searchMode==="semantic"?"Describe what you want to watch...":"Search movies... (try: actor:Roy Rogers, director:Dave Fleischer)"),N=B(()=>{const c=a.filters;return c.sources.length>0||c.minRating>0||c.minYear>0||c.minVotes>0||c.genres.length>0||c.countries.length>0}),b=()=>{o.value.sort={field:"year",direction:"desc"}},r=()=>{o.value.minYear=0,o.value.maxYear=0},_=()=>{o.value.minVotes=0,o.value.maxVotes=0},p=()=>{Object.assign(o.value,{sort:{field:"year",direction:"desc"},sources:[],minRating:0,minYear:0,maxYear:0,minVotes:0,maxVotes:0,genres:[],countries:[],searchQuery:"",searchMode:"exact"}),x.value=""},j=he(c=>{$e(c)&&(o.value.searchMode="exact"),o.value.searchQuery=c,c&&o.value.sort.field!=="relevance"&&(o.value.sort={field:"relevance",direction:"desc"}),S("search")},500);le(x,c=>{j(c)}),le(()=>o.value.searchQuery,c=>{c!==x.value&&(x.value=c)});const y=()=>{S("search")},I=()=>{x.value=""};return(c,n)=>{const g=Re,E=Te,se=Me,L=Ve,U=Ae,ne=Fe,re=Ye,v=Ee,f=je,w=Le;return l(),i("div",dt,[e("div",ct,[e("div",ut,[e("div",mt,[P.isFiltering?(l(),i("div",ft,[...n[13]||(n[13]=[e("div",{class:"i-mdi-loading animate-spin text-lg text-theme-primary"},null,-1)])])):F("",!0),$(g)]),J(e("input",{ref_key:"searchInput",ref:T,"onUpdate:modelValue":n[0]||(n[0]=M=>fe(x)?x.value=M:null),type:"text",class:"block w-full pl-32 md:pl-36 pr-12 py-3 bg-theme-background border-2 border-theme-border/50 focus:border-theme-primary rounded-2xl text-lg text-theme-text placeholder-theme-text-muted focus:outline-none transition-all shadow-sm",placeholder:t(d),onKeydown:ae(y,["enter"])},null,40,vt),[[q,t(x)]]),e("div",pt,[t(x)?(l(),i("button",{key:0,class:"p-2 hover:bg-theme-surface rounded-full transition-colors",title:"Clear search",onClick:I},[...n[14]||(n[14]=[e("div",{class:"i-mdi-close text-xl text-theme-textmuted hover:text-theme-text"},null,-1)])])):F("",!0),e("button",{class:"p-2 hover:bg-theme-surface rounded-full transition-colors group",title:"Search tips",onClick:n[1]||(n[1]=M=>s("help",M))},[...n[15]||(n[15]=[e("div",{class:"i-mdi-help-circle-outline text-xl text-theme-textmuted group-hover:text-theme-primary transition-colors"},null,-1)])])])])]),e("div",ht,[$(E,{category:"Sort",icon:"i-mdi-sort","active-value":t(C),"is-active":!t(m),disabled:t(o).searchMode==="semantic",onClick:n[2]||(n[2]=M=>s("sort",M)),onClear:b},null,8,["active-value","is-active","disabled"]),$(E,{category:"Rating",icon:"i-mdi-star","active-value":t(o).minRating>0?`${t(o).minRating.toFixed(1)}+`:"","is-active":t(o).minRating>0,disabled:t(o).searchMode==="semantic",onClick:n[3]||(n[3]=M=>s("rating",M)),onClear:n[4]||(n[4]=()=>{t(o).minRating=0})},null,8,["active-value","is-active","disabled"]),$(E,{category:"Year",icon:"i-mdi-calendar","active-value":t(Q),"is-active":t(o).minYear>0||(t(o).maxYear??0)>0,disabled:t(o).searchMode==="semantic",onClick:n[5]||(n[5]=M=>s("year",M)),onClear:r},null,8,["active-value","is-active","disabled"]),$(E,{category:"Votes",icon:"i-mdi-account-group","active-value":t(O),"is-active":t(o).minVotes>0||(t(o).maxVotes??0)>0&&(t(o).maxVotes??0)<1e6,disabled:t(o).searchMode==="semantic",onClick:n[6]||(n[6]=M=>s("votes",M)),onClear:_},null,8,["active-value","is-active","disabled"]),$(E,{category:"Genres",icon:"i-mdi-movie-filter","active-value":t(o).genres.length>0?t(o).genres.length:"","is-active":t(o).genres.length>0,disabled:t(o).searchMode==="semantic",onClick:n[7]||(n[7]=M=>s("genres",M)),onClear:n[8]||(n[8]=()=>{t(o).genres=[]})},null,8,["active-value","is-active","disabled"]),$(E,{category:"Countries",icon:"i-mdi-earth","active-value":t(o).countries.length>0?t(o).countries.length:"","is-active":t(o).countries.length>0,disabled:t(o).searchMode==="semantic",onClick:n[9]||(n[9]=M=>s("countries",M)),onClear:n[10]||(n[10]=()=>{t(o).countries=[]})},null,8,["active-value","is-active","disabled"]),$(E,{category:"Source",icon:"i-mdi-source-branch","active-value":t(o).sources.length>0?t(o).sources.length:"","is-active":t(o).sources.length>0,disabled:t(o).searchMode==="semantic",onClick:n[11]||(n[11]=M=>s("source",M)),onClear:n[12]||(n[12]=()=>{t(o).sources=[]})},null,8,["active-value","is-active","disabled"]),t(N)?(l(),i("button",{key:0,class:W(["text-xs font-bold text-theme-primary hover:bg-theme-primary/10 px-3 py-1.5 rounded-full transition-colors whitespace-nowrap md:ml-auto",{"opacity-50 cursor-not-allowed":t(o).searchMode==="semantic"}]),disabled:t(o).searchMode==="semantic",onClick:p}," Clear All ",10,xt)):F("",!0)]),$(L,{"is-open":t(k)==="sort",title:"Sort By","anchor-el":t(Y),onClose:u},{default:K(()=>[$(se)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="rating",title:"Minimum Rating","anchor-el":t(Y),onClose:u},{default:K(()=>[$(U)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="year",title:"Year Range","anchor-el":t(Y),onClose:u},{default:K(()=>[$(ne)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="votes",title:"Votes Range","anchor-el":t(Y),onClose:u},{default:K(()=>[$(re)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="genres",title:"Genres","anchor-el":t(Y),onClose:u},{default:K(()=>[$(v)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="countries",title:"Countries","anchor-el":t(Y),onClose:u},{default:K(()=>[$(f)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="source",title:"Sources","anchor-el":t(Y),onClose:u},{default:K(()=>[$(w)]),_:1},8,["is-open","anchor-el"]),$(L,{"is-open":t(k)==="help",title:"Search Tips","anchor-el":t(Y),onClose:u},{default:K(()=>[...n[16]||(n[16]=[e("div",{class:"p-4 max-w-xs space-y-3 text-sm"},[e("p",{class:"text-theme-textmuted"},"Use keywords for field-specific search:"),e("ul",{class:"space-y-2"},[e("li",{class:"flex items-center gap-2"},[e("code",{class:"bg-theme-background px-1.5 py-0.5 rounded text-theme-primary font-mono"},"actor:"),e("span",{class:"text-theme-text"},"Search by actor")]),e("li",{class:"flex items-center gap-2"},[e("code",{class:"bg-theme-background px-1.5 py-0.5 rounded text-theme-primary font-mono"},"director:"),e("span",{class:"text-theme-text"},"Search by director")]),e("li",{class:"flex items-center gap-2"},[e("code",{class:"bg-theme-background px-1.5 py-0.5 rounded text-theme-primary font-mono"},"writer:"),e("span",{class:"text-theme-text"},"Search by writer")]),e("li",{class:"flex items-center gap-2"},[e("code",{class:"bg-theme-background px-1.5 py-0.5 rounded text-theme-primary font-mono"},"title:"),e("span",{class:"text-theme-text"},"Search by title")])]),e("div",{class:"pt-2 border-t border-theme-border"},[e("p",{class:"text-theme-textmuted mb-1"},"Use quotes for spaces:"),e("code",{class:"block bg-theme-background p-2 rounded text-theme-primary font-mono"},'actor:"Roy Rogers"')]),e("div",{class:"pt-2 border-t border-theme-border"},[e("p",{class:"text-theme-textmuted mb-1"},"Combine multiple keywords:"),e("code",{class:"block bg-theme-background p-2 rounded text-theme-primary font-mono"},"actor:Keanu title:Matrix")])],-1)])]),_:1},8,["is-open","anchor-el"])])}}}),bt=Object.assign(gt,{__name:"AdminSearchHeader"}),_e=()=>{const P={sort:{field:"year",direction:"desc"},sources:[],minRating:0,minYear:0,maxYear:0,minVotes:0,maxVotes:0,genres:[],countries:[],searchQuery:"",searchMode:"exact"},D=R({...P}),a=B(()=>{let o=0;return D.value.sources.length>0&&o++,D.value.minRating>0&&o++,D.value.minYear>0&&o++,D.value.minVotes>0&&o++,D.value.genres.length>0&&o++,D.value.countries.length>0&&o++,o}),S=B(()=>a.value>0);return{filters:D,activeFiltersCount:a,hasActiveFilters:S,resetFilters:()=>{D.value={...P}}}},yt={class:"space-y-4"},_t={key:0,class:"bg-theme-surface border border-theme-border rounded-2xl overflow-hidden"},wt={class:"p-4 border-b border-theme-border flex items-center justify-between bg-theme-bg/30"},$t={class:"text-sm text-theme-textmuted"},kt={class:"font-semibold text-theme-text"},St={key:0,class:"text-xs"},Ct=["disabled"],It={key:0,class:"i-mdi-loading animate-spin"},Rt={key:1,class:"i-mdi-plus-box-multiple"},Tt={class:"divide-y divide-theme-border"},Mt={class:"w-12 h-16 rounded bg-theme-selection relative overflow-hidden flex-shrink-0"},Vt=["src","alt"],At={key:1,class:"w-full h-full flex items-center justify-center text-gray-400 dark:text-gray-600"},Ft={class:"flex-1 min-w-0"},Yt={class:"flex items-center gap-2"},Et={class:"font-bold truncate"},jt={class:"text-xs text-theme-textmuted font-mono"},Lt={class:"text-xs text-theme-textmuted truncate"},Dt={class:"flex items-center gap-2 text-[10px] text-theme-textmuted mt-0.5"},Qt={class:"font-mono"},Ot={key:0,class:"flex items-center gap-1"},Nt={class:"font-bold text-theme-text"},Pt={key:0,class:"opacity-70"},Ut=["disabled","onClick"],Bt={key:0,class:"i-mdi-loading animate-spin"},Kt={key:1,class:"p-8 text-center text-theme-textmuted bg-theme-surface border border-theme-border border-dashed rounded-2xl"},Ht=Z({__name:"AdminMovieSearch",props:{collectionId:{},filters:{}},emits:["add"],setup(P,{expose:D,emit:a}){const S=P,A=a,o=te(),T=xe(),x=H(),k=ue(ee,null),{filters:Y}=_e(),s=B(()=>S.filters||k?.value||Y.value),u=B(()=>{const y=s.value;return y.sources.length>0||y.minRating>0||y.minYear>0||y.minVotes>0||y.genres.length>0||y.countries.length>0}),m=R([]),C=R(!1),Q=R(""),O=R(!1),d=R(!1),N=y=>{m.value=y,d.value=!0,s.value.searchQuery=""};ke("/",y=>{const I=window.document.activeElement,c=I?.tagName==="INPUT"||I?.tagName==="TEXTAREA";y.preventDefault(),c||document.querySelector('input[type="text"]')?.focus()});const b=async()=>{const y=s.value.searchQuery.length>=3,I=u.value;if(!y&&!I){m.value=[];return}C.value=!0,d.value=!1;try{let c=[];if(s.value.searchMode==="semantic"&&s.value.searchQuery){const n=Se(),g=[],E=[];if(s.value.minRating>0&&(g.push("m.imdbRating >= ?"),E.push(s.value.minRating)),s.value.minYear>0&&(g.push("m.year >= ?"),E.push(s.value.minYear)),(s.value.maxYear??0)>0&&(g.push("m.year <= ?"),E.push(s.value.maxYear)),s.value.minVotes>0&&(g.push("m.imdbVotes >= ?"),E.push(s.value.minVotes)),(s.value.maxVotes??0)>0&&(g.push("m.imdbVotes <= ?"),E.push(s.value.maxVotes)),s.value.genres.length>0){const L=s.value.genres.map(()=>"(m.genre LIKE ? OR m.genre LIKE ? OR m.genre LIKE ? OR m.genre = ?)");g.push(`(${L.join(" OR ")})`),s.value.genres.forEach(U=>{E.push(`${U},%`,`%, ${U},%`,`%, ${U}`,U)})}if(s.value.countries.length>0){const L=s.value.countries.map(()=>"(m.country LIKE ? OR m.country LIKE ? OR m.country LIKE ? OR m.country = ?)");g.push(`(${L.join(" OR ")})`),s.value.countries.forEach(U=>{E.push(`${U},%`,`%, ${U},%`,`%, ${U}`,U)})}if(s.value.sources.length>0){const L=[];s.value.sources.forEach(U=>{U==="archive.org"?(L.push("m.primarySourceType = ?"),E.push("archive.org")):(L.push("(m.primarySourceType = ? AND m.primaryChannelName = ?)"),E.push("youtube",U))}),g.push(`(${L.join(" OR ")})`)}c=await n.search(s.value.searchQuery,300,g.length>0?g.join(" AND "):void 0,g.length>0?E:void 0)}else c=await $fetch("/api/admin/movies/search",{query:{q:s.value.searchQuery,minRating:s.value.minRating||void 0,minYear:s.value.minYear||void 0,maxYear:s.value.maxYear||void 0,minVotes:s.value.minVotes||void 0,maxVotes:s.value.maxVotes||void 0,genres:s.value.genres.join(",")||void 0,countries:s.value.countries.join(",")||void 0,sources:s.value.sources.join(",")||void 0}});m.value=c.slice(0,300).map(T.mapMovieToLightweight)}catch{x.showToast("Search failed","error")}finally{C.value=!1}},r=he(b,300);le(()=>s.value,()=>{r()},{deep:!0});const _=y=>o.isMovieInCollection(y,S.collectionId),p=async y=>{Q.value=y;try{await o.addMovieToCollection(S.collectionId,y)?(x.showToast("Movie added to collection"),A("add")):x.showToast("Failed to add movie","error")}catch{x.showToast("Error adding movie","error")}finally{Q.value=""}},j=async()=>{O.value=!0;let y=0,I=0;try{const c=m.value.filter(n=>!_(n.movieId));if(c.length===0){x.showToast("All movies are already in the collection","info");return}for(const n of c)try{await o.addMovieToCollection(S.collectionId,n.movieId)?y++:I++}catch{I++}y>0&&(x.showToast(`Added ${y} movie${y>1?"s":""} to collection`),A("add")),I>0&&x.showToast(`Failed to add ${I} movie${I>1?"s":""}`,"error")}finally{O.value=!1}};return D({setExternalResults:N}),(y,I)=>{const c=bt,n=de;return l(),i("div",yt,[$(c,{filters:t(s),"is-filtering":t(C),onSearch:b},null,8,["filters","is-filtering"]),t(m).length>0?(l(),i("div",_t,[e("div",wt,[e("div",$t,[e("span",kt,h(t(m).length),1),V(" "+h(t(d)?"similar movies found":"results")+" ",1),t(m).length===300?(l(),i("span",St,"(limited to 300)")):F("",!0)]),e("button",{class:W(["px-4 py-2 rounded-lg text-sm font-bold transition-all flex items-center gap-2 disabled:opacity-50",t(O)?"bg-theme-selection text-theme-textmuted cursor-wait":"bg-blue-600 hover:bg-blue-500 text-white"]),disabled:t(O)||t(Q)!=="",onClick:j},[t(O)?(l(),i("div",It)):(l(),i("div",Rt)),I[1]||(I[1]=V(" Add All to Collection ",-1))],10,Ct)]),e("div",Tt,[(l(!0),i(z,null,G(t(m),g=>(l(),i("div",{key:g.movieId,class:"p-4 flex items-center gap-4 hover:bg-theme-bg/50 transition-colors"},[e("div",Mt,[g.movieId?.startsWith("tt")?(l(),i("img",{key:0,src:("getPosterPath"in y?y.getPosterPath:t(be))(g.movieId),alt:g.title,class:"w-full h-full object-cover",onError:I[0]||(I[0]=E=>E.target.style.display="none")},null,40,Vt)):(l(),i("div",At,[...I[2]||(I[2]=[e("div",{class:"i-mdi-movie text-2xl"},null,-1)])]))]),e("div",Ft,[e("div",Yt,[e("h4",Et,[$(n,{to:`/movie/${g.movieId}`,target:"_blank",class:"hover:text-blue-600 transition-colors"},{default:K(()=>[V(h(g.title),1)]),_:2},1032,["to"])]),e("span",jt,h(g.year),1)]),e("p",Lt,h(g.genre||"Unknown Genre"),1),e("div",Dt,[e("span",Qt,h(g.movieId),1),g.imdbRating?(l(),i("span",Ot,[I[3]||(I[3]=e("span",{class:"opacity-50"},"•",-1)),I[4]||(I[4]=e("div",{class:"i-mdi-star text-theme-accent text-xs"},null,-1)),e("span",Nt,h(g.imdbRating),1),g.imdbVotes?(l(),i("span",Pt," ("+h(("formatVotes"in y?y.formatVotes:t(ye))(g.imdbVotes))+") ",1)):F("",!0)])):F("",!0)])]),e("button",{class:W(["px-3 py-1.5 rounded-lg text-xs font-bold transition-all flex items-center gap-1.5 disabled:opacity-50",_(g.movieId)?"bg-theme-selection text-theme-textmuted cursor-default":"bg-blue-600 hover:bg-blue-500 text-white"]),disabled:_(g.movieId)||t(Q)===g.movieId,onClick:E=>p(g.movieId)},[t(Q)===g.movieId?(l(),i("div",Bt)):(l(),i("div",{key:1,class:W(_(g.movieId)?"i-mdi-check":"i-mdi-plus")},null,2)),V(" "+h(_(g.movieId)?"Added":"Add"),1)],10,Ut)]))),128))])])):(t(s).searchQuery.length>=3||t(u))&&!t(C)?(l(),i("div",Kt," No movies found"+h(t(s).searchQuery?` for "${t(s).searchQuery}"`:"")+h(t(u)?" with current filters":""),1)):F("",!0)])}}}),zt=Object.assign(Ht,{__name:"AdminMovieSearch"}),Gt={class:"space-y-4"},Wt={key:0,class:"text-sm text-theme-textmuted italic p-4 bg-theme-surface border border-theme-border border-dashed rounded-xl text-center"},Zt={key:1,class:"space-y-3"},Xt={class:"flex items-start justify-between gap-4"},Jt={class:"flex-1 space-y-2"},qt={class:"flex items-center gap-2"},es={class:"font-bold text-sm"},ts={key:0,class:"px-2 py-0.5 bg-blue-600/10 text-blue-600 border border-blue-600/20 rounded text-[10px] font-bold flex items-center gap-1"},ss={class:"flex flex-wrap gap-2"},os={key:0,class:"px-2 py-0.5 bg-theme-bg border border-theme-border rounded text-[10px] font-mono flex items-center gap-1"},is={key:1,class:"px-2 py-0.5 bg-theme-bg border border-theme-border rounded text-[10px] font-mono flex items-center gap-1"},ls={key:2,class:"px-2 py-0.5 bg-theme-bg border border-theme-border rounded text-[10px] font-mono flex items-center gap-1"},ns={key:3,class:"px-2 py-0.5 bg-theme-bg border border-theme-border rounded text-[10px] font-mono flex items-center gap-1"},rs={key:4,class:"px-2 py-0.5 bg-theme-bg border border-theme-border rounded text-[10px] font-mono flex items-center gap-1"},as={key:5,class:"px-2 py-0.5 bg-theme-bg border border-theme-border rounded text-[10px] font-mono flex items-center gap-1"},ds={class:"flex items-center gap-1"},cs=["onClick"],us=["onClick"],ms=Z({__name:"AdminSavedQueryManager",props:{collectionId:{},queries:{},filters:{}},emits:["filtersApplied"],setup(P,{emit:D}){const a=P,S=D,A=te(),T=ue(ee,null)||ve(a,"filters"),x=async()=>{const s={field:"year",direction:"desc"},u="exact",m=a.filters.sort.field===s.field&&a.filters.sort.direction===s.direction,C={searchQuery:a.filters.searchQuery};m||(C.sort={...a.filters.sort}),a.filters.searchMode!==u&&(C.searchMode=a.filters.searchMode),a.filters.sources.length>0&&(C.sources=[...a.filters.sources]),a.filters.minRating>0&&(C.minRating=a.filters.minRating),a.filters.minYear>0&&(C.minYear=a.filters.minYear),a.filters.maxYear&&a.filters.maxYear>0&&(C.maxYear=a.filters.maxYear),a.filters.minVotes>0&&(C.minVotes=a.filters.minVotes),a.filters.maxVotes&&a.filters.maxVotes>0&&(C.maxVotes=a.filters.maxVotes),a.filters.genres.length>0&&(C.genres=[...a.filters.genres]),a.filters.countries.length>0&&(C.countries=[...a.filters.countries]);const Q={searchQuery:a.filters.searchQuery,filterState:C};await A.addQueryToCollection(a.collectionId,Q)},k=async s=>{confirm("Are you sure you want to remove this saved query?")&&await A.removeQueryFromCollection(a.collectionId,s)},Y=s=>{Object.assign(T.value,{sort:{field:"year",direction:"desc"},sources:[],minRating:0,minYear:0,maxYear:0,minVotes:0,maxVotes:0,genres:[],countries:[],searchQuery:"",searchMode:"exact"}),s.searchQuery&&(T.value.searchQuery=s.searchQuery),s.filterState.searchMode&&(T.value.searchMode=s.filterState.searchMode),s.filterState.sort&&(T.value.sort=s.filterState.sort),s.filterState.minRating&&(T.value.minRating=s.filterState.minRating),s.filterState.minYear&&(T.value.minYear=s.filterState.minYear),s.filterState.maxYear&&(T.value.maxYear=s.filterState.maxYear),s.filterState.minVotes&&(T.value.minVotes=s.filterState.minVotes),s.filterState.maxVotes&&(T.value.maxVotes=s.filterState.maxVotes),s.filterState.genres&&(T.value.genres=[...s.filterState.genres]),s.filterState.countries&&(T.value.countries=[...s.filterState.countries]),s.filterState.sources&&(T.value.sources=[...s.filterState.sources]),S("filtersApplied")};return(s,u)=>(l(),i("div",Gt,[e("div",{class:"flex items-center justify-between"},[u[1]||(u[1]=e("label",{class:"block text-sm font-bold text-theme-textmuted uppercase tracking-wider"}," Saved Queries ",-1)),e("button",{class:"px-3 py-1.5 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-xs font-bold transition-colors flex items-center gap-2",onClick:x},[...u[0]||(u[0]=[e("div",{class:"i-mdi-plus"},null,-1),V(" Save Current Search ",-1)])])]),!P.queries||P.queries.length===0?(l(),i("div",Wt," No saved queries for this collection. ")):(l(),i("div",Zt,[(l(!0),i(z,null,G(P.queries,(m,C)=>(l(),i("div",{key:C,class:"p-4 bg-theme-surface border border-theme-border rounded-xl group hover:border-theme-textmuted transition-all"},[e("div",Xt,[e("div",Jt,[e("div",qt,[u[3]||(u[3]=e("div",{class:"i-mdi-magnify text-theme-textmuted"},null,-1)),e("span",es,h(m.searchQuery||"All Movies"),1),m.filterState.searchMode&&m.filterState.searchMode!=="exact"?(l(),i("div",ts,[...u[2]||(u[2]=[e("div",{class:"i-mdi-sparkles"},null,-1),V(" Semantic ",-1)])])):F("",!0)]),e("div",ss,[m.filterState.sort?(l(),i("div",os,[u[4]||(u[4]=e("div",{class:"i-mdi-sort"},null,-1)),V(" "+h(m.filterState.sort.field)+" ("+h(m.filterState.sort.direction)+") ",1)])):F("",!0),m.filterState.minYear&&m.filterState.minYear>0||m.filterState.maxYear?(l(),i("div",is,[u[5]||(u[5]=e("div",{class:"i-mdi-calendar"},null,-1)),V(" "+h(m.filterState.minYear||1910)+" - "+h(m.filterState.maxYear||2025),1)])):F("",!0),m.filterState.minRating&&m.filterState.minRating>0?(l(),i("div",ls,[u[6]||(u[6]=e("div",{class:"i-mdi-star"},null,-1)),V(" "+h(m.filterState.minRating)+"+ ",1)])):F("",!0),m.filterState.minVotes&&m.filterState.minVotes>0||m.filterState.maxVotes?(l(),i("div",ns,[u[7]||(u[7]=e("div",{class:"i-mdi-account-group"},null,-1)),V(" "+h((m.filterState.minVotes||0).toLocaleString())+" - "+h(m.filterState.maxVotes?m.filterState.maxVotes.toLocaleString():"Any"),1)])):F("",!0),m.filterState.genres?.length?(l(),i("div",rs,[u[8]||(u[8]=e("div",{class:"i-mdi-movie-filter"},null,-1)),V(" "+h(m.filterState.genres.join(", ")),1)])):F("",!0),m.filterState.sources?.length?(l(),i("div",as,[u[9]||(u[9]=e("div",{class:"i-mdi-source-branch"},null,-1)),V(" "+h(m.filterState.sources.join(", ")),1)])):F("",!0)])]),e("div",ds,[e("button",{class:"p-2 hover:bg-blue-600/10 text-blue-600 rounded-lg transition-colors",title:"Apply Filters",onClick:Q=>Y(m)},[...u[10]||(u[10]=[e("div",{class:"i-mdi-filter-variant"},null,-1)])],8,cs),e("button",{class:"p-2 hover:bg-red-600/10 text-red-600 rounded-lg transition-colors",title:"Remove Query",onClick:Q=>k(C)},[...u[11]||(u[11]=[e("div",{class:"i-mdi-delete"},null,-1)])],8,us)])])]))),128))]))]))}}),fs=Object.assign(ms,{__name:"AdminSavedQueryManager"}),vs={class:"space-y-4"},ps={key:0,class:"p-12 flex justify-center"},hs={key:1,class:"space-y-4"},xs={class:"flex justify-end"},gs=["disabled"],bs={key:0,class:"i-mdi-loading animate-spin"},ys={key:1,class:"i-mdi-auto-fix"},_s={class:"overflow-hidden divide-y divide-theme-border"},ws={class:"w-12 h-16 rounded bg-theme-selection relative overflow-hidden flex-shrink-0"},$s=["src","alt"],ks={key:1,class:"w-full h-full flex items-center justify-center text-gray-400 dark:text-gray-600"},Ss={class:"flex-1 min-w-0"},Cs={class:"flex items-center gap-2"},Is={class:"text-xs text-theme-textmuted font-mono"},Rs={class:"text-xs text-theme-textmuted truncate"},Ts={class:"flex items-center gap-2 text-[10px] text-theme-textmuted mt-0.5"},Ms={class:"font-mono"},Vs={key:0,class:"flex items-center gap-1"},As={class:"font-bold text-theme-text"},Fs={key:0,class:"opacity-70"},Ys={class:"flex items-center gap-1"},Es=["disabled","onClick"],js={key:0,class:"i-mdi-loading animate-spin text-xl"},Ls={key:1,class:"i-mdi-auto-fix text-xl"},Ds=["disabled","onClick"],Qs={key:0,class:"i-mdi-loading animate-spin text-xl"},Os={key:1,class:"i-mdi-trash-can-outline text-xl"},Ns={key:2,class:"p-12 text-center text-theme-textmuted bg-theme-surface border border-theme-border border-dashed rounded-2xl"},Ps=Z({__name:"AdminCollectionMoviesList",props:{collectionId:{}},emits:["find-similar"],setup(P,{expose:D,emit:a}){const S=P,A=te(),o=xe(),{lightweightMovieCache:T}=ce(o),x=H(),k=R([]),Y=R(!1),s=R(""),u=R(""),m=R(!1),C=a,Q=async()=>{if(S.collectionId){Y.value=!0;try{const b=await A.getCollectionById(S.collectionId);if(!b||!b.movieIds||!b.movieIds.length){k.value=[];return}const r=ge(b.movieIds);await o.fetchMoviesByIds(r),k.value=r.map(_=>{const p=T.value.get(_);return p||{movieId:_,title:`Missing: ${_}`,year:0}})}catch(b){window.console.error("Failed to load collection movies:",b),x.showToast("Failed to load collection movies","error")}finally{Y.value=!1}}},O=async b=>{u.value=b.movieId;try{const r=await o.getSimilarMovies(b.movieId,20);C("find-similar",r),x.showToast(`Found ${r.length} similar movies`)}catch{x.showToast("Failed to find similar movies","error")}finally{u.value=""}},d=async()=>{if(k.value.length!==0){m.value=!0;try{const b=new Map;for(const _ of k.value)(await o.getSimilarMovies(_.movieId,10)).forEach(j=>{if(k.value.some(I=>I.movieId===j.movieId))return;const y=b.get(j.movieId);y?y.count++:b.set(j.movieId,{movie:j,count:1})});const r=Array.from(b.values()).sort((_,p)=>p.count-_.count).map(_=>_.movie).slice(0,50);C("find-similar",r),x.showToast(`Suggested ${r.length} related movies`)}catch{x.showToast("Failed to suggest related movies","error")}finally{m.value=!1}}},N=async b=>{if(confirm(`Remove "${b.title}" from this collection?`)){s.value=b.movieId;try{await A.removeMovieFromCollection(S.collectionId,b.movieId)?(x.showToast("Movie removed from collection"),await Q()):x.showToast("Failed to remove movie","error")}catch{x.showToast("Error removing movie","error")}finally{s.value=""}}};return D({refresh:Q}),le(()=>S.collectionId,()=>{Q()},{immediate:!0}),(b,r)=>{const _=de;return l(),i("div",vs,[t(Y)?(l(),i("div",ps,[...r[1]||(r[1]=[e("div",{class:"i-mdi-loading animate-spin text-4xl text-blue-600"},null,-1)])])):t(k).length>0?(l(),i("div",hs,[e("div",xs,[e("button",{class:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-xl text-sm font-bold transition-all flex items-center gap-2 shadow-lg shadow-blue-600/20 disabled:opacity-50",disabled:t(m),onClick:d},[t(m)?(l(),i("div",bs)):(l(),i("div",ys)),r[2]||(r[2]=V(" Auto-suggest Related ",-1))],8,gs)]),e("div",_s,[(l(!0),i(z,null,G(t(k),p=>(l(),i("div",{key:p.movieId,class:"py-4 flex items-center gap-4 hover:bg-theme-bg/50 transition-colors"},[e("div",ws,[p.movieId?.startsWith("tt")?(l(),i("img",{key:0,src:("getPosterPath"in b?b.getPosterPath:t(be))(p.movieId),alt:p.title,class:"w-full h-full object-cover",onError:r[0]||(r[0]=j=>j.target.style.display="none")},null,40,$s)):(l(),i("div",ks,[...r[3]||(r[3]=[e("div",{class:"i-mdi-movie text-2xl"},null,-1)])]))]),e("div",Ss,[e("div",Cs,[$(_,{to:`/movie/${p.movieId}`,target:"_blank",class:"font-bold truncate hover:text-blue-600 transition-colors"},{default:K(()=>[V(h(p.title),1)]),_:2},1032,["to"]),e("span",Is,h(p.year),1)]),e("p",Rs,h(p.genre||"Unknown Genre"),1),e("div",Ts,[e("span",Ms,h(p.movieId),1),p.imdbRating?(l(),i("span",Vs,[r[4]||(r[4]=e("span",{class:"opacity-50"},"•",-1)),r[5]||(r[5]=e("div",{class:"i-mdi-star text-theme-accent text-xs"},null,-1)),e("span",As,h(p.imdbRating),1),p.imdbVotes?(l(),i("span",Fs," ("+h(("formatVotes"in b?b.formatVotes:t(ye))(p.imdbVotes))+") ",1)):F("",!0)])):F("",!0)])]),e("div",Ys,[e("button",{class:"p-2 text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Find similar movies",disabled:t(u)===p.movieId,onClick:j=>O(p)},[t(u)===p.movieId?(l(),i("div",js)):(l(),i("div",Ls))],8,Es),e("button",{class:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Remove from collection",disabled:t(s)===p.movieId,onClick:j=>N(p)},[t(s)===p.movieId?(l(),i("div",Qs)):(l(),i("div",Os))],8,Ds)])]))),128))])])):(l(),i("div",Ns,[...r[6]||(r[6]=[e("div",{class:"i-mdi-movie-off-outline text-4xl mx-auto mb-2 opacity-20"},null,-1),e("p",null,"No movies in this collection yet.",-1)])]))])}}}),Us=Object.assign(Ps,{__name:"AdminCollectionMoviesList"}),Bs={class:"min-h-screen bg-theme-background text-theme-text p-4 md:ml-16 transition-colors duration-300"},Ks={class:"max-w-7xl mx-auto space-y-8"},Hs={key:0,class:"flex flex-col items-center justify-center h-[60vh] text-center"},zs={key:1,class:"flex flex-col gap-8"},Gs={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},Ws={class:"bg-theme-surface border border-theme-border rounded-2xl p-6"},Zs={key:0,class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},Xs={class:"space-y-8"},Js={key:0,class:"bg-theme-surface border border-theme-border rounded-2xl p-6 space-y-4"},qs={class:"flex items-start justify-between gap-4"},eo={class:"space-y-2"},to={class:"flex items-center gap-3"},so={class:"text-2xl font-bold"},oo={key:0,class:"px-2 py-0.5 bg-yellow-600/10 text-yellow-600 dark:text-yellow-400 border border-yellow-600/20 rounded text-xs font-bold uppercase"},io={key:0,class:"flex flex-wrap gap-2"},lo={class:"text-theme-textmuted max-w-3xl"},no={class:"flex items-center gap-2 text-sm font-mono text-theme-textmuted"},ro={class:"text-theme-text"},ao={class:"flex items-center gap-2"},co={class:"space-y-6"},uo={class:"space-y-6"},mo={class:"bg-theme-surface border border-theme-border rounded-2xl p-6 space-y-6"},fo={class:"flex items-center justify-between gap-2"},wo=Z({__name:"index",setup(P){Ce({title:"Collection Editor - Movies Deluxe Admin",meta:[{name:"robots",content:"noindex, nofollow"}]});const D=_e(),{filters:a}=D;pe(ee,a);const S=R(!1),A=R(""),o=R(null),T=R(null),x=R(null),k=te(),{collections:Y}=ce(k),s=B(()=>A.value&&Y.value.get(A.value)||null);me(async()=>{S.value=De()});const u=()=>{T.value&&T.value.refresh()},m=O=>{x.value&&(x.value.setExternalResults(O),window.scrollTo({top:0,behavior:"smooth"}))},C=()=>{},Q=async()=>{if(!(!A.value||!s.value)&&confirm("This will remove all movies from this collection that are no longer in the database. Continue?"))try{const O=ge(s.value.movieIds);if(!O.length){H().showToast("Collection is already empty");return}const d=Ie();if(!d.isReady.value){H().showToast("Database not ready","error");return}const N=await d.queryByIds(O),b=new Set(N.map(p=>p.movieId)),r=O.filter(p=>!b.has(p));if(r.length===0){H().showToast("No missing movies found in this collection");return}await k.removeMoviesFromCollection(A.value,r)?(H().showToast(`Removed ${r.length} missing movies from collection`),T.value&&T.value.refresh()):H().showToast("Failed to remove missing movies","error")}catch{H().showToast("Error during cleanup","error")}};return(O,d)=>{const N=de,b=at,r=zt,_=fs,p=Us;return l(),i("div",Bs,[e("main",Ks,[t(S)?(l(),i("div",zs,[e("header",Gs,[d[9]||(d[9]=e("div",null,[e("h1",{class:"text-3xl font-bold flex items-center gap-3"},[e("div",{class:"i-mdi-movie-edit text-blue-600"}),V(" Collection Editor ")]),e("p",{class:"text-theme-textmuted mt-1"},"Add and remove movies from collections")],-1)),$(N,{to:"/admin",class:"px-4 py-2 text-sm bg-theme-surface border border-theme-border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors flex items-center gap-2"},{default:K(()=>[...d[8]||(d[8]=[e("div",{class:"i-mdi-arrow-left"},null,-1),V(" Back to Dashboard ",-1)])]),_:1})]),e("section",Ws,[$(b,{ref_key:"collectionSelector",ref:o,onSelect:d[0]||(d[0]=j=>A.value=j)},null,512)]),t(A)?(l(),i("section",Zs,[e("div",Xs,[t(s)?(l(),i("div",Js,[e("div",qs,[e("div",eo,[e("div",to,[e("h2",so,h(t(s).name),1),t(s).enabled===!1?(l(),i("span",oo," Hidden ")):F("",!0)]),t(s).tags?.length?(l(),i("div",io,[(l(!0),i(z,null,G(t(s).tags,j=>(l(),i("span",{key:j,class:"px-2 py-1 bg-blue-600/10 text-blue-600 dark:text-blue-400 border border-blue-600/20 rounded-lg text-xs font-medium"},h(j),1))),128))])):F("",!0),e("p",lo,h(t(s).description||"No description provided."),1),e("div",no,[d[10]||(d[10]=e("div",{class:"i-mdi-movie text-theme-text"},null,-1)),e("span",ro,h(t(s).movieIds.length),1),d[11]||(d[11]=V(" movies in collection ",-1))])]),e("div",ao,[e("button",{class:W(["p-2 rounded-xl border border-theme-border hover:bg-theme-background transition-colors",t(s).enabled===!1?"text-green-600":"text-yellow-600"]),title:"Toggle Visibility",onClick:d[1]||(d[1]=j=>t(o)?.toggleEnabled(t(s)))},[e("div",{class:W([t(s).enabled===!1?"i-mdi-eye":"i-mdi-eye-off","text-xl"])},null,2)],2),e("button",{class:"p-2 rounded-xl border border-theme-border hover:bg-theme-background text-blue-600 transition-colors",title:"Edit Collection",onClick:d[2]||(d[2]=j=>t(o)?.editCollection(t(s)))},[...d[12]||(d[12]=[e("div",{class:"i-mdi-pencil text-xl"},null,-1)])]),e("button",{class:"p-2 rounded-xl border border-theme-border hover:bg-theme-background text-red-600 transition-colors",title:"Delete Collection",onClick:d[3]||(d[3]=j=>t(o)?.confirmDelete(t(s)))},[...d[13]||(d[13]=[e("div",{class:"i-mdi-delete text-xl"},null,-1)])])])])])):F("",!0),e("div",co,[d[14]||(d[14]=e("h2",{class:"text-xl font-bold flex items-center gap-2"},[e("div",{class:"i-mdi-magnify text-blue-600"}),V(" Search Library ")],-1)),$(r,{ref_key:"movieSearch",ref:x,"collection-id":t(A),filters:t(a),onAdd:u},null,8,["collection-id","filters"])])]),e("div",uo,[e("div",mo,[d[15]||(d[15]=e("h2",{class:"text-xl font-bold flex items-center gap-2"},[e("div",{class:"i-mdi-database-clock text-blue-600"}),V(" Dynamic Queries ")],-1)),$(_,{"collection-id":t(A),queries:t(s)?.savedQueries,filters:t(a),onFiltersApplied:C},null,8,["collection-id","queries","filters"])]),e("div",fo,[d[17]||(d[17]=e("h2",{class:"text-xl font-bold flex items-center gap-2"},[e("div",{class:"i-mdi-playlist-play text-blue-600"}),V(" Collection Movies ")],-1)),t(A)?(l(),i("button",{key:0,class:"px-3 py-1 text-xs bg-theme-surface border border-theme-border rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 transition-colors flex items-center gap-2",title:"Remove movies that are no longer in the database",onClick:Q},[...d[16]||(d[16]=[e("div",{class:"i-mdi-broom"},null,-1),V(" Cleanup ",-1)])])):F("",!0)]),$(p,{ref_key:"moviesList",ref:T,"collection-id":t(A),onFindSimilar:m},null,8,["collection-id"])])])):F("",!0)])):(l(),i("div",Hs,[d[5]||(d[5]=e("div",{class:"i-mdi-lock text-64px text-gray-300 dark:text-gray-700 mb-4"},null,-1)),d[6]||(d[6]=e("h1",{class:"text-2xl font-bold mb-2"},"Access Denied",-1)),d[7]||(d[7]=e("p",{class:"text-theme-textmuted"},"The admin interface is only available on localhost.",-1)),$(N,{to:"/",class:"mt-6 px-6 py-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors"},{default:K(()=>[...d[4]||(d[4]=[V(" Back to Home ",-1)])]),_:1})]))])])}}});export{wo as default};
