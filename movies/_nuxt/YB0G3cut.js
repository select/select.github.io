import{_ as L}from"./CfClX1ix.js";import{u as z}from"./9g13holF.js";import{u as V}from"./D0NGMQ5b.js";import{e as M,m as k,f as c,h as N,j as $,c as a,o,w as F,a as r,k as l,l as t,q as g,t as u,_ as R}from"./B-4pkthn.js";function S(s){if(s==null||s==="")return"";let e;return typeof s=="number"?e=s:e=parseInt(s.replace(/,/g,""),10),isNaN(e)?"":e>=1e6?`${(e/1e6).toFixed(1)}M votes`:e>=1e3?`${(e/1e3).toFixed(1)}K votes`:`${e} votes`}const T={english:"en",german:"de",french:"fr",spanish:"es",italian:"it",portuguese:"pt",russian:"ru",japanese:"ja",chinese:"zh",korean:"ko",arabic:"ar",hindi:"hi",dutch:"nl",polish:"pl",swedish:"sv",norwegian:"no",danish:"da",finnish:"fi",czech:"cs",hungarian:"hu",turkish:"tr",greek:"el",hebrew:"he",thai:"th",vietnamese:"vi"};function B(s){if(!s)return null;const e=s.split(",")[0]?.trim().toLowerCase();return!e||e==="n/a"||e==="none"?null:e.length===2&&/^[a-z]{2}$/.test(e)?e:T[e]||null}function U(s){const e=B(s);return e?e.toUpperCase():""}const D={class:"aspect-[2/3] bg-theme-selection relative flex-shrink-0 overflow-hidden"},E=["src","alt"],q={key:2,class:"w-full h-full flex items-center justify-center text-gray-400 dark:text-gray-600"},A={key:3,class:"absolute top-1.5 right-1.5 flex flex-col gap-1 items-end"},K={key:0,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-gray-800 dark:text-white font-medium"},O={key:1,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-red-600 dark:text-red-400 font-bold"},P={key:2,class:"px-1.5 py-0.5 text-[10px] rounded-full glass text-gray-800 dark:text-white font-bold"},W={key:4,class:"absolute top-1.5 left-1.5 w-7 h-7 rounded-full glass flex items-center justify-center z-10"},Y=["title"],G={key:0,class:"absolute -bottom-1 -right-1 bg-theme-accent text-black text-[9px] font-black w-3.5 h-3.5 rounded-full flex items-center justify-center border border-theme-surface"},H={class:"p-3 flex-shrink-0"},J={class:"font-bold text-sm line-clamp-2 mb-1.5 leading-snug min-h-[2.5rem]"},Q={class:"flex items-center gap-1.5 text-[11px] text-theme-textmuted font-medium"},X={key:0},Z={key:1,class:"opacity-50"},ee={key:2,class:"flex items-center gap-1"},te={class:"font-bold text-theme-text"},se={key:0,class:"text-[10px] opacity-70"},ie={key:1,class:"flex flex-col border border-red-500/50 rounded-xl overflow-hidden bg-theme-surface text-theme-text opacity-50",title:"Invalid movie data: missing imdbId"},ne={class:"p-3 flex-shrink-0"},oe={class:"font-bold text-sm line-clamp-2 mb-1.5 leading-snug min-h-[2.5rem] text-red-400"},ae=M({__name:"MovieCard",props:{movie:{}},setup(s){const e=s,{isLiked:_}=z(),{getCollectionsForMovie:w}=V(),m=k(!1),d=k([]),x=c(()=>e.movie.imdbId?.startsWith("tt")??!1),h=c(()=>e.movie.imdbId?_(e.movie.imdbId):!1),C=c(()=>"verified"in e.movie?e.movie.verified:!1);N(async()=>{e.movie.imdbId&&(d.value=await w(e.movie.imdbId))});const p=c(()=>"sources"in e.movie&&e.movie.sources.length>0?!0:"sourceType"in e.movie&&!!e.movie.sourceType),f=c(()=>{if("metadata"in e.movie)return e.movie.metadata;const n=e.movie;return{imdbRating:n.imdbRating,imdbVotes:n.imdbVotes,Language:n.language}}),v=c(()=>{if("sources"in e.movie)return e.movie.sources[0];const n=e.movie;if(n.sourceType)return{type:n.sourceType,channelName:n.channelName,language:n.language}}),y=c(()=>{if(!p.value)return"";const n=f.value?.Language;if(n)return n.length===2?n.toUpperCase():U(n);const i=v.value?.language;return i&&i.length===2?i.toUpperCase():""}),I=n=>{m.value=!0;const i=n.target;i.style.display="none"};return(n,i)=>{const j=L;return s.movie.imdbId?(o(),$(j,{key:0,to:`/movie/${s.movie.imdbId}`,class:"flex flex-col border border-theme-border/50 rounded-xl overflow-hidden hover:shadow-xl hover:-translate-y-1 transition-all duration-300 bg-theme-surface text-theme-text"},{default:F(()=>[r("div",D,[t(x)?(o(),a("div",{key:0,class:g(["absolute inset-0 shimmer z-10 transition-opacity duration-500",{"opacity-0 pointer-events-none":t(m),"opacity-100":!t(m)}])},null,2)):l("",!0),t(x)?(o(),a("img",{key:1,src:`/posters/${s.movie.imdbId}.jpg`,alt:s.movie.title,class:g(["w-full h-full object-cover object-center transition-opacity duration-700",{"opacity-0":!t(m),"opacity-100":t(m)}]),loading:"lazy",onLoad:i[0]||(i[0]=b=>m.value=!0),onError:I},null,42,E)):(o(),a("div",q,[...i[1]||(i[1]=[r("div",{class:"i-mdi-movie text-6xl"},null,-1)])])),t(p)?(o(),a("div",A,[t(v)?.type==="archive.org"?(o(),a("span",K," Archive.org ")):t(v)?.type==="youtube"?(o(),a("span",O,u(t(v).channelName||"YouTube"),1)):l("",!0),t(y)?(o(),a("span",P,u(t(y)),1)):l("",!0)])):l("",!0),t(h)?(o(),a("div",W,[...i[2]||(i[2]=[r("div",{class:"i-mdi-heart text-red-500 text-lg"},null,-1)])])):l("",!0),t(d).length>0?(o(),a("div",{key:5,class:g(["absolute top-1.5 left-1.5 w-7 h-7 rounded-full glass flex items-center justify-center z-10",{"ml-8":t(h)}]),title:t(d).map(b=>b.name).join(", ")},[i[3]||(i[3]=r("div",{class:"i-mdi:movie-roll text-theme-accent text-lg"},null,-1)),t(d).length>1?(o(),a("span",G,u(t(d).length),1)):l("",!0)],10,Y)):l("",!0),t(C)?(o(),a("div",{key:6,class:g(["absolute top-1.5 left-1.5 w-7 h-7 rounded-full flex items-center justify-center z-10",{"ml-8":t(h)&&t(d).length===0||!t(h)&&t(d).length>0,"ml-16":t(h)&&t(d).length>0}]),title:"Verified Source"},[...i[4]||(i[4]=[r("div",{class:"i-mdi-check-decagram text-green-600 text-2xl"},null,-1)])],2)):l("",!0)]),r("div",H,[r("h3",J,u(s.movie.title),1),r("div",Q,[s.movie.year?(o(),a("span",X,u(s.movie.year),1)):l("",!0),s.movie.year&&t(f)?.imdbRating?(o(),a("span",Z,"â€¢")):l("",!0),t(f)?.imdbRating?(o(),a("span",ee,[i[5]||(i[5]=r("div",{class:"i-mdi-star text-theme-accent text-xs"},null,-1)),r("span",te,u(t(f).imdbRating),1),t(f)?.imdbVotes?(o(),a("span",se," ("+u(("formatVotes"in n?n.formatVotes:t(S))(t(f).imdbVotes))+") ",1)):l("",!0)])):l("",!0)])])]),_:1},8,["to"])):(o(),a("div",ie,[i[7]||(i[7]=r("div",{class:"aspect-[2/3] bg-theme-selection relative flex-shrink-0 overflow-hidden"},[r("div",{class:"w-full h-full flex items-center justify-center text-red-400"},[r("div",{class:"i-mdi-alert-circle text-6xl"})])],-1)),r("div",ne,[r("h3",oe,u(s.movie.title||"Unknown Movie"),1),i[6]||(i[6]=r("div",{class:"text-[11px] text-red-400 font-medium"}," Missing ID ",-1))])]))}}}),ce=Object.assign(R(ae,[["__scopeId","data-v-6ba78f78"]]),{__name:"MovieCard"});export{ce as _,S as f};
