import{p as Z,y as z,E as I,x as B,G as _,H as q,I as Q,J as F,g as A,K as ee,L as te,s as O,M as T,j as re,N as K,z as ne,O as oe}from"./DlzEzF_f.js";function ae(e,r){return _()?(q(e,r),!0):!1}const se=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const le=Object.prototype.toString,ie=e=>le.call(e)==="[object Object]",ue=()=>{};function ce(...e){if(e.length!==1)return F(...e);const r=e[0];return typeof r=="function"?I(ee(()=>({get:r,set:ue}))):A(r)}function de(e,r){function n(...c){return new Promise((d,m)=>{Promise.resolve(e(()=>r.apply(this,c),{fn:r,thisArg:this,args:c})).then(d).catch(m)})}return n}const U=e=>e();function fe(e=U,r={}){const{initialState:n="active"}=r,c=ce(n==="active");function d(){c.value=!1}function m(){c.value=!0}const g=(...l)=>{c.value&&e(...l)};return{isActive:I(c),pause:d,resume:m,eventFilter:g}}function L(e){return Array.isArray(e)?e:[e]}function ye(e){return Q()}function pe(e,r,n={}){const{eventFilter:c=U,...d}=n;return B(e,de(c,r),d)}function ve(e,r,n={}){const{eventFilter:c,initialState:d="active",...m}=n,{eventFilter:g,pause:l,resume:u,isActive:f}=fe(c,{initialState:d});return{stop:pe(e,r,{...m,eventFilter:g}),pause:l,resume:u,isActive:f}}const he=ve;function me(e,r=!0,n){ye()?Z(e,n):r?e():z(e)}function Se(e,r,n){return B(e,r,{...n,immediate:!0})}const E=se?window:void 0;function ge(e){var r;const n=T(e);return(r=n?.$el)!==null&&r!==void 0?r:n}function j(...e){const r=[],n=()=>{r.forEach(l=>l()),r.length=0},c=(l,u,f,S)=>(l.addEventListener(u,f,S),()=>l.removeEventListener(u,f,S)),d=O(()=>{const l=L(T(e[0])).filter(u=>u!=null);return l.every(u=>typeof u!="string")?l:void 0}),m=Se(()=>{var l,u;return[(l=(u=d.value)===null||u===void 0?void 0:u.map(f=>ge(f)))!==null&&l!==void 0?l:[E].filter(f=>f!=null),L(T(d.value?e[1]:e[0])),L(re(d.value?e[2]:e[1])),T(d.value?e[3]:e[2])]},([l,u,f,S])=>{if(n(),!l?.length||!u?.length||!f?.length)return;const i=ie(S)?{...S}:S;r.push(...l.flatMap(y=>u.flatMap(p=>f.map(w=>c(y,p,w,i)))))},{flush:"post"}),g=()=>{m(),n()};return ae(n),g}const C=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},N="__vueuse_ssr_handlers__",we=Pe();function Pe(){return N in C||(C[N]=C[N]||{}),C[N]}function be(e,r){return we[e]||r}function ke(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const Ve={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},J="vueuse-storage";function W(e,r,n,c={}){var d;const{flush:m="pre",deep:g=!0,listenToStorageChanges:l=!0,writeDefaults:u=!0,mergeDefaults:f=!1,shallow:S,window:i=E,eventFilter:y,onError:p=a=>{console.error(a)},initOnMounted:w}=c,x=(S?te:A)(typeof r=="function"?r():r),t=O(()=>T(e));if(!n)try{n=be("getDefaultStorage",()=>E?.localStorage)()}catch(a){p(a)}if(!n)return x;const s=T(r),P=ke(s),v=(d=c.serializer)!==null&&d!==void 0?d:Ve[P],{pause:k,resume:b}=he(x,a=>$(a),{flush:m,deep:g,eventFilter:y});B(t,()=>D(),{flush:m});let R=!1;const G=a=>{w&&!R||D(a)},H=a=>{w&&!R||X(a)};i&&l&&(n instanceof Storage?j(i,"storage",G,{passive:!0}):j(i,J,H)),w?me(()=>{R=!0,D()}):D();function M(a,h){if(i){const V={key:t.value,oldValue:a,newValue:h,storageArea:n};i.dispatchEvent(n instanceof Storage?new StorageEvent("storage",V):new CustomEvent(J,{detail:V}))}}function $(a){try{const h=n.getItem(t.value);if(a==null)M(h,null),n.removeItem(t.value);else{const V=v.write(a);h!==V&&(n.setItem(t.value,V),M(h,V))}}catch(h){p(h)}}function Y(a){const h=a?a.newValue:n.getItem(t.value);if(h==null)return u&&s!=null&&n.setItem(t.value,v.write(s)),s;if(!a&&f){const V=v.read(h);return typeof f=="function"?f(V,s):P==="object"&&!Array.isArray(V)?{...s,...V}:V}else return typeof h!="string"?h:v.read(h)}function D(a){if(!(a&&a.storageArea!==n)){if(a&&a.key==null){x.value=s;return}if(!(a&&a.key!==t.value)){k();try{const h=v.write(x.value);(a===void 0||a?.newValue!==h)&&(x.value=Y(a))}catch(h){p(h)}finally{a?z(b):b()}}}}function X(a){D(a.detail)}return x}const xe=K("playlistStore",()=>{const e=A(null),r=A(null),n=A(!1),c=A(""),d=O(()=>e.value!==null),m=O(()=>e.value?.videos||[]),g=i=>[...i].sort((y,p)=>y.createdAt&&!p.createdAt?-1:!y.createdAt&&p.createdAt?1:y.createdAt&&p.createdAt?p.createdAt-y.createdAt:0),l=i=>({...i,videos:g(i.videos)});return{currentPlaylist:e,loading:n,error:c,hasCurrentPlaylist:d,originalCurrentPlaylist:r,currentVideos:m,loadFirstPlaylist:async()=>{try{n.value=!0,c.value="";const i=await $fetch("/index.json");if(!i.success||!i.data.length){e.value=null,r.value=null;return}const y=i.data[0],p=await $fetch(`/playlist/${y?.fileName}`),w=l(p);e.value=w,r.value=JSON.parse(JSON.stringify(w))}catch(i){console.error("Error loading first playlist:",i),c.value=i.data?.message||i.message||"Failed to load playlist",e.value=null,r.value=null}finally{n.value=!1}},setCurrentPlaylistVideos:i=>{e.value&&(e.value={...e.value,videos:i})},findVideoIndex:i=>e.value?e.value.videos.findIndex(y=>y.id===i):-1,sortVideosByCreatedAt:g}}),o=oe({isPlaying:!1,currentVideo:null,currentIndex:0,isPlayerReady:!1,showPlayerBar:!1,isFloatingPlayerOpen:!1,youtubePlayerInstance:null}),Ie=()=>{const{currentVideos:e}=ne(xe()),r=O(()=>o.currentVideo?e.value.findIndex(s=>s.id===o.currentVideo?.id)>0:!1),n=O(()=>{if(!o.currentVideo)return!1;const t=e.value.findIndex(s=>s.id===o.currentVideo?.id);return t===-1?e.value.length>0:t<e.value.length-1}),c=t=>{o.currentVideo=t,o.showPlayerBar=!!t},d=t=>{o.isPlaying=t},m=t=>{o.isPlayerReady=t},g=t=>{o.youtubePlayerInstance=t},l=()=>{const t=o.youtubePlayerInstance;!t||!o.isPlayerReady||(o.isPlaying?t.pauseVideo():t.playVideo())},u=t=>{t>=0&&t<e.value.length&&(o.currentIndex=t,o.currentVideo=e.value[t]||null)},f=()=>{if(!o.currentVideo)return;const t=e.value.findIndex(s=>s.id===o.currentVideo?.id);if(t>0){const s=t-1;o.currentIndex=s,o.currentVideo=e.value[s]||null}},S=()=>{if(!o.currentVideo)return;const t=e.value.findIndex(s=>s.id===o.currentVideo?.id);if(t!==-1&&t<e.value.length-1){const s=t+1;o.currentIndex=s,o.currentVideo=e.value[s]||null}else t===-1&&e.value.length>0&&(o.currentIndex=0,o.currentVideo=e.value[0]||null)},i=t=>{u(t)},y=()=>{o.showPlayerBar=!1,o.isFloatingPlayerOpen=!1,o.currentVideo=null,o.isPlaying=!1,o.isPlayerReady=!1,o.youtubePlayerInstance=null},p=(t=0)=>{u(t),o.showPlayerBar=!0,o.isFloatingPlayerOpen=!0},w=()=>{o.isFloatingPlayerOpen=!0},x=()=>{o.isFloatingPlayerOpen=!1};return{isPlaying:I(F(o,"isPlaying")),currentVideo:F(o,"currentVideo"),currentIndex:I(F(o,"currentIndex")),isPlayerReady:I(F(o,"isPlayerReady")),showPlayerBar:I(F(o,"showPlayerBar")),isFloatingPlayerOpen:I(F(o,"isFloatingPlayerOpen")),canPlayPrevious:r,canPlayNext:n,setCurrentVideo:c,setIsPlaying:d,setIsPlayerReady:m,setCurrentIndex:u,setYouTubePlayerInstance:g,togglePlayPause:l,previousVideo:f,nextVideo:S,playVideo:i,closePlayer:y,initializeGlobalPlayer:p,openFloatingPlayer:w,closeFloatingPlayer:x}},Ae={simple:{playPause:" ",nextTrack:"ArrowRight",previousTrack:"ArrowLeft",volumeUp:"ArrowUp",volumeDown:"ArrowDown",mute:"m",seekForward:"l",seekBackward:"j",focusSearch:"ctrl+k"},winamp:{playPause:"x",nextTrack:"b",previousTrack:"z",volumeUp:"ArrowUp",volumeDown:"ArrowDown",mute:"m",seekForward:"v",seekBackward:"c",focusSearch:"ctrl+k"},youtube:{playPause:"k",nextTrack:"n",previousTrack:"p",volumeUp:"ArrowUp",volumeDown:"ArrowDown",mute:"m",seekForward:"l",seekBackward:"j",focusSearch:"ctrl+k"}},Fe=K("userSettingsStore",()=>{const e=A({keyboardShortcutScheme:"winamp"}),r=A(!0),n=W("video-view-mode","grid"),c=W("video-player-position",{x:100,y:100,width:320,height:240}),d=O(()=>e.value.customShortcuts?e.value.customShortcuts:Ae[e.value.keyboardShortcutScheme]),m=O(()=>[{value:"simple",label:"Simple (Space, Arrow Keys)"},{value:"winamp",label:"Winamp Style (X, Z, B, C, V)"},{value:"youtube",label:"YouTube Style (K, J, L, N, P)"}]),g=t=>{e.value.keyboardShortcutScheme=t,e.value.customShortcuts=void 0,S()},l=()=>{e.value={keyboardShortcutScheme:"simple"},S()},u=()=>{r.value=!0},f=()=>{r.value=!1},S=()=>{localStorage.setItem("userSettings",JSON.stringify(e.value))},i=()=>{try{const t=localStorage.getItem("userSettings");if(t){const s=JSON.parse(t);e.value={keyboardShortcutScheme:s.keyboardShortcutScheme||"simple",customShortcuts:s.customShortcuts}}}catch(t){console.warn("Failed to load user settings:",t),l()}},y=t=>{if(!r.value)return;const s=Ie();if(!p(t,s)&&t.ctrlKey&&t.key.toLowerCase()==="k"){t.preventDefault();const v=document.getElementById("search");v&&v.focus()}},p=(t,s)=>{const P=t.target;if(P instanceof HTMLInputElement||P instanceof HTMLTextAreaElement||P instanceof HTMLSelectElement||P?.contentEditable==="true"||P?.closest("input, textarea, select, [contenteditable]")||P?.closest("[class*='input'], [class*='select'], [class*='dropdown']")||P?.closest("[role='textbox'], [role='combobox'], [role='searchbox']")||P?.closest("[data-input], [data-multiselect]"))return!1;const v=d.value,k=t.key.toLowerCase();let b=!1;return k===v.playPause||e.value.keyboardShortcutScheme==="youtube"&&k===" "?(t.preventDefault(),s.setIsPlaying(!s.isPlaying.value),b=!0):k===v.nextTrack?(t.preventDefault(),s.nextVideo(),b=!0):k===v.previousTrack?(t.preventDefault(),s.previousVideo(),b=!0):(k===v.mute||k===v.volumeUp||k===v.volumeDown||k===v.seekForward||k===v.seekBackward)&&(t.preventDefault(),b=!0),b},w=()=>{document.addEventListener("keydown",y)},x=()=>{document.removeEventListener("keydown",y)};return i(),w(),{settings:I(e),shortcutsEnabled:I(r),viewMode:n,videoPlayerPosition:c,currentKeyboardShortcuts:d,availableShortcutSchemes:m,setKeyboardShortcutScheme:g,resetToDefaults:l,loadSettings:i,saveSettings:S,handleKeyboardEvent:p,enableShortcuts:u,disableShortcuts:f,setupGlobalListeners:w,cleanupGlobalListeners:x}});export{xe as a,Ie as b,Fe as u};
