import{_ as ae}from"./Poa0Vbh4.js";import{e as F,z,c as C,f as G,g as s,o as _,a,b as g,t as j,w as L,h as l,x as R,y as ne,q as we,A as ge,l as _e,E as Pe,m as be,n as ke}from"./BwAB1KHt.js";import{i as P,a as Ee,u as Le}from"./nw89KjDc.js";import"./Bolu6i1c.js";const ze={key:0,class:"fixed bottom-0 left-1/2 transform -translate-x-1/2 z-40 bg-primary-1 p-4 rounded-xl mb-3"},Ce={class:"w-full sm:w-md md:w-2xl lg:w-3xl mx-auto flex items-center gap-4"},Me=["src","alt"],Ve={class:"flex-1 min-w-0"},Ye={class:"text-primary-4 font-medium text-sm line-clamp-1"},Re={class:"text-primary-3 text-xs line-clamp-1"},Be={class:"flex items-center gap-2"},De={key:0,class:"i-mdi-pause w-5 h-5"},Ie={key:1,class:"i-mdi-play w-5 h-5"},He={class:"text-primary-3 text-xs flex-shrink-0 hidden sm:block"},$e=F({__name:"VideoPlayerBar",setup(M){const{currentVideo:i,isPlaying:c,canPlayPrevious:x,canPlayNext:r}=z(P()),{togglePlayPause:w,previousVideo:b,nextVideo:k,closePlayer:y}=P();return(E,d)=>{const f=ae;return s(i)?(_(),C("div",ze,[a("div",Ce,[a("img",{src:`https://i.ytimg.com/vi/${s(i).id}/hqdefault.jpg`,alt:s(i).title,class:"w-12 h-9 object-cover rounded flex-shrink-0"},null,8,Me),a("div",Ve,[a("h3",Ye,j(s(i).title),1),a("p",Re,j(s(i).channel),1)]),a("div",Be,[g(f,{variant:"secondary",disabled:!s(x),class:"!p-2",onClick:s(b)},{default:L(()=>[...d[0]||(d[0]=[a("div",{class:"i-mdi-skip-previous w-4 h-4"},null,-1)])]),_:1},8,["disabled","onClick"]),g(f,{variant:"primary",class:"!p-2",onClick:s(w)},{default:L(()=>[s(c)?(_(),C("div",De)):(_(),C("div",Ie))]),_:1},8,["onClick"]),g(f,{variant:"secondary",disabled:!s(r),class:"!p-2",onClick:s(k)},{default:L(()=>[...d[1]||(d[1]=[a("div",{class:"i-mdi-skip-next w-4 h-4"},null,-1)])]),_:1},8,["disabled","onClick"])]),a("div",He,j(s(i).duration),1),g(f,{variant:"ghost",class:"!p-2",onClick:s(y)},{default:L(()=>[...d[2]||(d[2]=[a("div",{class:"i-mdi-close text-xl"},null,-1)])]),_:1},8,["onClick"])])])):G("",!0)}}}),Se=Object.assign($e,{__name:"VideoPlayerBar"}),Te={class:"hidden group-hover:flex absolute -top-6 right-3 gap-1"},Xe={class:"w-8 h-8 bg-primary-1 rounded-t-2xl shadow-xl flex items-center justify-center"},Ne={class:"bg-primary-1 rounded-2xl shadow-xl overflow-hidden h-full"},Oe={class:"p-4 h-full"},We={class:"bg-black rounded-2xl overflow-hidden h-full"},Ae=F({__name:"VideoPlayer",props:{isOpen:{type:Boolean,default:!1},initialVideoIndex:{default:0}},emits:["close","videoChange"],setup(M,{emit:i}){const c=M,x=i,{currentVideo:r,currentIndex:w,isPlayerReady:b,canPlayNext:k}=z(P()),{setIsPlaying:y,setIsPlayerReady:E,setCurrentIndex:d,setYouTubePlayerInstance:f,togglePlayPause:se,previousVideo:ie,nextVideo:U,closePlayer:oe,initializeGlobalPlayer:le}=P(),{currentVideos:re}=z(Ee()),{videoPlayerPosition:o}=z(Le()),q=l(),B=l(),de=l(),ue=l(),ce=l();let p=null;const t=l({x:o.value.x,y:o.value.y,width:o.value.width,height:o.value.height}),D=l(!1),I=l(!1),H=l(!1),$=l({x:0,y:0}),u=l({x:0,y:0,width:0,height:0});R(()=>c.initialVideoIndex,e=>{e!==void 0&&d(e)},{immediate:!0}),R(()=>c.isOpen,e=>{e?(re.value.length>0&&le(w.value),ne(()=>{me()})):S()}),R([r,w],([e,n])=>{e&&(pe(),x("videoChange",e,n))});const me=()=>{if(r.value){if(window.YT&&window.YT.Player)K();else if(!window.onYouTubeIframeAPIReady){const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";const n=document.getElementsByTagName("script")[0];n&&n.parentNode?n.parentNode.insertBefore(e,n):document.head.appendChild(e),window.onYouTubeIframeAPIReady=()=>{K()}}}},K=()=>{!q.value||!r.value||(S(),p=new window.YT.Player("youtube-player",{height:"100%",width:"100%",videoId:r.value.id,playerVars:{autoplay:1,controls:1,modestbranding:1,rel:0,showinfo:0},events:{onReady:ve,onStateChange:he}}))},ve=()=>{E(!0),y(!0),f(p)},he=e=>{const n=e.data,m=0,v=1,h=2;switch(n){case v:y(!0);break;case h:y(!1);break;case m:y(!1),k.value&&U();break}},pe=()=>{!p||!b.value||!r.value||p.loadVideoById(r.value.id)},S=()=>{p&&typeof p.destroy=="function"&&(p.destroy(),p=null,E(!1),f(null))},ye=e=>{if(!B.value)return;D.value=!0;const n=B.value.getBoundingClientRect();$.value={x:e.clientX-n.left,y:e.clientY-n.top},document.addEventListener("mousemove",T),document.addEventListener("mouseup",X),e.preventDefault()},T=e=>{if(!D.value)return;const n=e.clientX-$.value.x,m=e.clientY-$.value.y,v=window.innerWidth-t.value.width,h=window.innerHeight-t.value.height;t.value.x=Math.max(0,Math.min(n,v)),t.value.y=Math.max(0,Math.min(m,h))},X=()=>{D.value=!1,document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",X),o.value={...t.value}},fe=e=>{I.value=!0,u.value={x:e.clientX,y:e.clientY,width:t.value.width,height:t.value.height},document.addEventListener("mousemove",N),document.addEventListener("mouseup",O),e.preventDefault()},N=e=>{if(!I.value)return;const n=e.clientX-u.value.x,m=e.clientY-u.value.y,v=Math.max(280,Math.min(800,u.value.width+n)),h=Math.max(200,Math.min(600,u.value.height+m)),V=window.innerWidth-v,Y=window.innerHeight-h;t.value.width=v,t.value.height=h,t.value.x>V&&(t.value.x=Math.max(0,V)),t.value.y>Y&&(t.value.y=Math.max(0,Y))},O=()=>{I.value=!1,document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",O),o.value={...t.value}},xe=e=>{H.value=!0,u.value={x:e.clientX,y:e.clientY,width:t.value.width,height:t.value.height},document.addEventListener("mousemove",W),document.addEventListener("mouseup",A),e.preventDefault()},W=e=>{if(!H.value)return;const n=e.clientX-u.value.x,m=e.clientY-u.value.y,v=Math.max(280,Math.min(800,u.value.width-n)),h=Math.max(200,Math.min(600,u.value.height+m)),V=v-t.value.width,Y=Math.max(0,t.value.x-V),te=window.innerHeight-h;t.value.width=v,t.value.height=h,t.value.x=Y,t.value.y>te&&(t.value.y=Math.max(0,te))},A=()=>{H.value=!1,document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",A),o.value={...t.value}},J=()=>{const e=window.innerWidth-t.value.width,n=window.innerHeight-t.value.height;t.value.x=Math.max(0,Math.min(t.value.x,e)),t.value.y=Math.max(0,Math.min(t.value.y,n)),(t.value.x!==o.value.x||t.value.y!==o.value.y)&&(o.value={...t.value})},Q=()=>{oe(),x("close")},Z=e=>{if(c.isOpen)switch(e.code){case"Escape":Q();break;case"Space":e.preventDefault(),se();break;case"ArrowLeft":e.preventDefault(),ie();break;case"ArrowRight":e.preventDefault(),U();break}},ee=()=>{c.isOpen&&J()};return we(()=>{document.addEventListener("keydown",Z),window.addEventListener("resize",ee),c.isOpen&&ne(()=>{J()})}),ge(()=>{document.removeEventListener("keydown",Z),window.removeEventListener("resize",ee),document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",X),document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",O),document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",A),S()}),R(o,e=>{t.value={...e}},{deep:!0}),(e,n)=>{const m=ae;return M.isOpen?(_(),C("div",{key:0,ref_key:"playerWrapper",ref:B,style:_e({position:"fixed",left:`${s(t).x}px`,top:`${s(t).y}px`,width:`${s(t).width}px`,height:`${s(t).height}px`,zIndex:50,minWidth:"280px",minHeight:"200px",maxWidth:"800px",maxHeight:"600px"}),class:"select-none group"},[a("div",Te,[a("div",{ref_key:"dragHandle",ref:de,class:"w-8 h-8 bg-primary-1 rounded-t-2xl shadow-lg flex items-center justify-center cursor-move",onMousedown:ye},[...n[0]||(n[0]=[a("div",{class:"i-mdi-drag w-4 h-4 text-primary-3"},null,-1)])],544),a("div",Xe,[g(m,{variant:"ghost",class:"!p-2",onClick:Q},{default:L(()=>[...n[1]||(n[1]=[a("div",{class:"i-mdi-close w-5 h-5"},null,-1)])]),_:1})])]),a("div",Ne,[a("div",Oe,[a("div",We,[a("div",{id:"youtube-player",ref_key:"playerContainer",ref:q,class:"w-full h-full"},null,512)])]),a("div",{ref_key:"resizeHandle",ref:ue,class:"absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",onMousedown:fe},[...n[2]||(n[2]=[a("div",{class:"i-mdi-resize-bottom-right w-4 h-4 text-primary-3 opacity-50 hover:opacity-100"},null,-1)])],544),a("div",{ref_key:"resizeHandleLeft",ref:ce,class:"absolute bottom-0 left-0 w-4 h-4 cursor-sw-resize",onMousedown:xe},[...n[3]||(n[3]=[a("div",{class:"i-mdi-resize-bottom-right w-4 h-4 text-primary-3 opacity-50 hover:opacity-100 transform scale-x-[-1]"},null,-1)])],544)])],4)):G("",!0)}}}),je=Object.assign(Ae,{__name:"VideoPlayer"}),Ke=F({__name:"default",setup(M){const{showPlayerBar:i,isFloatingPlayerOpen:c,currentIndex:x}=z(P()),{closeFloatingPlayer:r}=P(),w=()=>{r()},b=()=>{};return(k,y)=>{const E=Se,d=je;return _(),C("div",{class:ke(["min-h-screen bg-bg-color",{"pb-20":s(i)}])},[Pe(k.$slots,"default"),s(i)?(_(),be(E,{key:0})):G("",!0),g(d,{"is-open":s(c),"initial-video-index":s(x),onClose:w,onVideoChange:b},null,8,["is-open","initial-video-index"])],2)}}});export{Ke as default};
