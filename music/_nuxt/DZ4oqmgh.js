import{_ as re}from"./DV8QpPch.js";import{b as K,a as we,u as _e}from"./CB7l0rq2.js";import{e as J,c as k,f as Q,j as i,o as w,a,b as g,t as q,w as b,z as oe,g as l,x as R,y as le,p as Pe,A as be,n as ke,D as Le,l as Ee,m as ze}from"./DnojI4uA.js";import"./CzNT4LqL.js";const Ve={key:0,class:"fixed bottom-0 left-1/2 transform -translate-x-1/2 z-40 bg-primary-1 p-4 rounded-xl mb-3"},Ce={class:"w-full sm:w-md md:w-2xl lg:w-3xl mx-auto flex items-center gap-4"},Me=["src","alt"],Ye={class:"flex-1 min-w-0"},Re={class:"text-primary-4 font-medium text-sm line-clamp-1"},Ie={class:"text-primary-3 text-xs line-clamp-1"},De={class:"flex items-center gap-2"},Be={key:0,class:"i-mdi-pause w-5 h-5"},He={key:1,class:"i-mdi-play w-5 h-5"},$e={class:"text-primary-3 text-xs flex-shrink-0 hidden sm:block"},Te=J({__name:"VideoPlayerBar",setup(L){const{currentVideo:s,isPlaying:h,canPlayPrevious:f,canPlayNext:u,togglePlayPause:_,previousVideo:I,nextVideo:P,closePlayer:E}=K();return(x,r)=>{const p=re;return i(s)?(w(),k("div",Ve,[a("div",Ce,[a("img",{src:`https://i.ytimg.com/vi/${i(s).id}/hqdefault.jpg`,alt:i(s).title,class:"w-12 h-9 object-cover rounded flex-shrink-0"},null,8,Me),a("div",Ye,[a("h3",Re,q(i(s).title),1),a("p",Ie,q(i(s).channel),1)]),a("div",De,[g(p,{variant:"secondary",onClick:i(I),disabled:!i(f),class:"!p-2"},{default:b(()=>[...r[0]||(r[0]=[a("div",{class:"i-mdi-skip-previous w-4 h-4"},null,-1)])]),_:1},8,["onClick","disabled"]),g(p,{variant:"primary",onClick:i(_),class:"!p-2"},{default:b(()=>[i(h)?(w(),k("div",Be)):(w(),k("div",He))]),_:1},8,["onClick"]),g(p,{variant:"secondary",onClick:i(P),disabled:!i(u),class:"!p-2"},{default:b(()=>[...r[1]||(r[1]=[a("div",{class:"i-mdi-skip-next w-4 h-4"},null,-1)])]),_:1},8,["onClick","disabled"])]),a("div",$e,q(i(s).duration),1),g(p,{variant:"ghost",onClick:i(E),class:"!p-2"},{default:b(()=>[...r[2]||(r[2]=[a("div",{class:"i-mdi-close text-xl"},null,-1)])]),_:1},8,["onClick"])])])):Q("",!0)}}}),Xe=Object.assign(Te,{__name:"VideoPlayerBar"}),Oe={class:"hidden group-hover:flex absolute -top-6 right-3 gap-1"},Se={class:"w-8 h-8 bg-primary-1 rounded-t-2xl shadow-xl flex items-center justify-center"},Ne={class:"bg-primary-1 rounded-2xl shadow-xl overflow-hidden h-full"},We={class:"p-4 h-full"},Ae={class:"bg-black rounded-2xl overflow-hidden h-full"},je=J({__name:"VideoPlayer",props:{isOpen:{type:Boolean,default:!1},initialVideoIndex:{default:0}},emits:["close","videoChange"],setup(L,{emit:s}){const h=L,f=s,{currentVideo:u,currentIndex:_,isPlaying:I,isPlayerReady:P,canPlayNext:E,setIsPlaying:x,setIsPlayerReady:r,setCurrentIndex:p,setYouTubePlayerInstance:z,togglePlayPause:D,previousVideo:V,nextVideo:C,closePlayer:B,initializeGlobalPlayer:H}=K(),{currentVideos:de}=oe(we()),{videoPlayerPosition:o}=oe(_e()),Z=l(),$=l(),ue=l(),ce=l(),me=l();let y=null;const t=l({x:o.value.x,y:o.value.y,width:o.value.width,height:o.value.height}),T=l(!1),X=l(!1),O=l(!1),S=l({x:0,y:0}),d=l({x:0,y:0,width:0,height:0});R(()=>h.initialVideoIndex,e=>{e!==void 0&&p(e)},{immediate:!0}),R(()=>h.isOpen,e=>{e?(de.value.length>0&&H(_.value),le(()=>{ve()})):N()}),R([u,_],([e,n])=>{e&&(ye(),f("videoChange",e,n))});const ve=()=>{if(u.value){if(window.YT&&window.YT.Player)ee();else if(!window.onYouTubeIframeAPIReady){const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";const n=document.getElementsByTagName("script")[0];n&&n.parentNode?n.parentNode.insertBefore(e,n):document.head.appendChild(e),window.onYouTubeIframeAPIReady=()=>{ee()}}}},ee=()=>{!Z.value||!u.value||(N(),y=new window.YT.Player("youtube-player",{height:"100%",width:"100%",videoId:u.value.id,playerVars:{autoplay:1,controls:1,modestbranding:1,rel:0,showinfo:0},events:{onReady:he,onStateChange:pe}}))},he=()=>{r(!0),x(!0),z(y)},pe=e=>{const n=e.data,c=0,m=1,v=2;switch(n){case m:x(!0);break;case v:x(!1);break;case c:x(!1),E.value&&C();break}},ye=()=>{!y||!P.value||!u.value||y.loadVideoById(u.value.id)},N=()=>{y&&typeof y.destroy=="function"&&(y.destroy(),y=null,r(!1),z(null))},fe=e=>{if(!$.value)return;T.value=!0;const n=$.value.getBoundingClientRect();S.value={x:e.clientX-n.left,y:e.clientY-n.top},document.addEventListener("mousemove",W),document.addEventListener("mouseup",A),e.preventDefault()},W=e=>{if(!T.value)return;const n=e.clientX-S.value.x,c=e.clientY-S.value.y,m=window.innerWidth-t.value.width,v=window.innerHeight-t.value.height;t.value.x=Math.max(0,Math.min(n,m)),t.value.y=Math.max(0,Math.min(c,v))},A=()=>{T.value=!1,document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",A),o.value={...t.value}},xe=e=>{X.value=!0,d.value={x:e.clientX,y:e.clientY,width:t.value.width,height:t.value.height},document.addEventListener("mousemove",j),document.addEventListener("mouseup",G),e.preventDefault()},j=e=>{if(!X.value)return;const n=e.clientX-d.value.x,c=e.clientY-d.value.y,m=Math.max(280,Math.min(800,d.value.width+n)),v=Math.max(200,Math.min(600,d.value.height+c)),M=window.innerWidth-m,Y=window.innerHeight-v;t.value.width=m,t.value.height=v,t.value.x>M&&(t.value.x=Math.max(0,M)),t.value.y>Y&&(t.value.y=Math.max(0,Y))},G=()=>{X.value=!1,document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",G),o.value={...t.value}},ge=e=>{O.value=!0,d.value={x:e.clientX,y:e.clientY,width:t.value.width,height:t.value.height},document.addEventListener("mousemove",F),document.addEventListener("mouseup",U),e.preventDefault()},F=e=>{if(!O.value)return;const n=e.clientX-d.value.x,c=e.clientY-d.value.y,m=Math.max(280,Math.min(800,d.value.width-n)),v=Math.max(200,Math.min(600,d.value.height+c)),M=m-t.value.width,Y=Math.max(0,t.value.x-M),se=window.innerHeight-v;t.value.width=m,t.value.height=v,t.value.x=Y,t.value.y>se&&(t.value.y=Math.max(0,se))},U=()=>{O.value=!1,document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",U),o.value={...t.value}},te=()=>{const e=window.innerWidth-t.value.width,n=window.innerHeight-t.value.height;t.value.x=Math.max(0,Math.min(t.value.x,e)),t.value.y=Math.max(0,Math.min(t.value.y,n)),(t.value.x!==o.value.x||t.value.y!==o.value.y)&&(o.value={...t.value})},ne=()=>{B(),f("close")},ae=e=>{if(h.isOpen)switch(e.code){case"Escape":ne();break;case"Space":e.preventDefault(),D();break;case"ArrowLeft":e.preventDefault(),V();break;case"ArrowRight":e.preventDefault(),C();break}},ie=()=>{h.isOpen&&te()};return Pe(()=>{document.addEventListener("keydown",ae),window.addEventListener("resize",ie),h.isOpen&&le(()=>{te()})}),be(()=>{document.removeEventListener("keydown",ae),window.removeEventListener("resize",ie),document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",A),document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",G),document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",U),N()}),R(o,e=>{t.value={...e}},{deep:!0}),(e,n)=>{const c=re;return L.isOpen?(w(),k("div",{key:0,ref_key:"playerWrapper",ref:$,style:ke({position:"fixed",left:`${i(t).x}px`,top:`${i(t).y}px`,width:`${i(t).width}px`,height:`${i(t).height}px`,zIndex:50,minWidth:"280px",minHeight:"200px",maxWidth:"800px",maxHeight:"600px"}),class:"select-none group"},[a("div",Oe,[a("div",{ref_key:"dragHandle",ref:ue,class:"w-8 h-8 bg-primary-1 rounded-t-2xl shadow-lg flex items-center justify-center cursor-move",onMousedown:fe},[...n[0]||(n[0]=[a("div",{class:"i-mdi-drag w-4 h-4 text-primary-3"},null,-1)])],544),a("div",Se,[g(c,{variant:"ghost",onClick:ne,class:"!p-2"},{default:b(()=>[...n[1]||(n[1]=[a("div",{class:"i-mdi-close w-5 h-5"},null,-1)])]),_:1})])]),a("div",Ne,[a("div",We,[a("div",Ae,[a("div",{ref_key:"playerContainer",ref:Z,id:"youtube-player",class:"w-full h-full"},null,512)])]),a("div",{ref_key:"resizeHandle",ref:ce,class:"absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",onMousedown:xe},[...n[2]||(n[2]=[a("div",{class:"i-mdi-resize-bottom-right w-4 h-4 text-primary-3 opacity-50 hover:opacity-100"},null,-1)])],544),a("div",{ref_key:"resizeHandleLeft",ref:me,class:"absolute bottom-0 left-0 w-4 h-4 cursor-sw-resize",onMousedown:ge},[...n[3]||(n[3]=[a("div",{class:"i-mdi-resize-bottom-right w-4 h-4 text-primary-3 opacity-50 hover:opacity-100 transform scale-x-[-1]"},null,-1)])],544)])],4)):Q("",!0)}}}),Ge=Object.assign(je,{__name:"VideoPlayer"}),Je=J({__name:"default",setup(L){const{showPlayerBar:s,currentVideo:h,currentIndex:f,isPlaying:u,canPlayPrevious:_,canPlayNext:I,isFloatingPlayerOpen:P,previousVideo:E,nextVideo:x,closePlayer:r,closeFloatingPlayer:p}=K(),z=()=>{p()},D=(V,C)=>{};return(V,C)=>{const B=Xe,H=Ge;return w(),k("div",{class:ze(["min-h-screen bg-bg-color",{"pb-20":i(s)}])},[Le(V.$slots,"default"),i(s)?(w(),Ee(B,{key:0})):Q("",!0),g(H,{isOpen:i(P),initialVideoIndex:i(f),onClose:z,onVideoChange:D},null,8,["isOpen","initialVideoIndex"])],2)}}});export{Je as default};
