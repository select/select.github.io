import{g as X,a as Z,b as G,_ as j}from"./CnVP4b7Y.js";import{_ as tt}from"./BLwd57ic.js";import{e as U,c as d,f as $,o as i,a as e,t as p,F as L,r as z,g as a,n as Y,h as _,i as q,b as A,w,d as y,j as K,v as Q,k as I,l as et,m as O,u as st,p as at,q as lt}from"./B3JNotKg.js";import"./DXLsplbg.js";const it={key:0,class:"p-2 rounded text-xs"},nt={class:"font-medium text-primary-4 line-clamp-1"},ot={class:"text-primary-3 line-clamp-1"},rt={key:0,class:"text-primary-3 line-clamp-1"},ct={key:1,class:"mt-1 flex gap-2 flex-wrap"},dt=["title"],ut=["title"],mt={key:2,class:"mt-1 flex gap-1 flex-wrap"},pt=["title"],ht={key:3,class:"mt-1 text-xs text-primary-3"},ft={key:0,class:"mr-2"},gt={key:1},yt={key:4,class:"mt-2 flex gap-2 flex-wrap items-center"},xt=["href","title"],vt=U({__name:"AdminMusicDataDisplay",props:{songData:{default:void 0}},setup(o){return(h,u)=>o.songData?(i(),d("div",it,[e("div",nt,p(o.songData.title),1),e("div",ot,"by "+p(o.songData.artist),1),o.songData.album?(i(),d("div",rt,p(o.songData.album),1)):$("",!0),o.songData.tags?.length||o.songData.genres?.length||o.songData.artistTags?.length?(i(),d("div",ct,[(i(!0),d(L,null,z(o.songData.tags?.slice(0,3)||[],s=>(i(),d("span",{key:`song-${s}`,class:"inline-block bg-accent/20 text-black px-1 rounded text-xs mr-1"},p(s),1))),128)),(i(!0),d(L,null,z(o.songData.genres?.slice(0,3)||[],s=>(i(),d("span",{key:`genre-${s}`,class:"inline-block bg-primary-3/30 text-primary-4 px-1 rounded text-xs mr-1",title:`Genre: ${s}`},p(s),9,dt))),128)),(i(!0),d(L,null,z(o.songData.artistTags?.slice(0,2)||[],s=>(i(),d("span",{key:`artist-${s}`,class:"inline-block bg-primary-2/60 text-primary-4 px-1 rounded text-xs mr-1",title:`Artist tag: ${s}`},p(s),9,ut))),128))])):$("",!0),o.songData.lastfmTags?.length?(i(),d("div",mt,[(i(!0),d(L,null,z(o.songData.lastfmTags.slice(0,3),s=>(i(),d("span",{key:`lastfm-${s}`,class:"inline-block bg-red-500/20 text-red-300 px-1 rounded text-xs",title:`Last.fm tag: ${s}`},p(s),9,pt))),128))])):$("",!0),o.songData.listeners||o.songData.playcount?(i(),d("div",ht,[o.songData.listeners?(i(),d("span",ft," ðŸŽ§ "+p(o.songData.listeners.toLocaleString()),1)):$("",!0),o.songData.playcount?(i(),d("span",gt," â–¶ï¸ "+p(o.songData.playcount.toLocaleString()),1)):$("",!0)])):$("",!0),o.songData.odesli&&Object.keys(o.songData.odesli).length>0?(i(),d("div",yt,[u[0]||(u[0]=e("span",{class:"text-xs text-primary-3 mr-1"},"Listen on:",-1)),(i(!0),d(L,null,z(o.songData.odesli,(s,l)=>(i(),d("a",{key:l,href:("getPlatformUrl"in h?h.getPlatformUrl:a(Z))(l,s),target:"_blank",rel:"noopener noreferrer",class:"text-primary-3 hover:text-accent transition-colors",title:`Listen on ${("getPlatformName"in h?h.getPlatformName:a(X))(l)}`},[e("div",{class:Y([("getPlatformIcon"in h?h.getPlatformIcon:a(G))(l),"text-sm"])},null,2)],8,xt))),128))])):$("",!0)])):$("",!0)}}),bt=Object.assign(vt,{__name:"AdminMusicDataDisplay"}),$t={key:0,class:"space-y-4"},_t={class:"flex items-center justify-between mb-3"},kt={class:"text-sm font-medium text-primary-4"},wt={class:"overflow-x-auto"},Ct={class:"w-full border-collapse text-sm"},Dt={class:"p-2"},St=["onUpdate:modelValue","placeholder"],At={class:"p-2 text-center"},Mt={class:"p-2"},Tt=["onUpdate:modelValue","placeholder"],Et={class:"p-2"},Pt={class:"flex items-center gap-2"},Lt={class:"w-12 h-2 bg-primary-1 rounded-full overflow-hidden"},Vt={class:"text-xs text-primary-3 font-mono"},Rt={class:"p-2"},zt={key:0,class:"text-xs text-primary-3 text-center"},Ft={key:1,class:"mt-3 p-2 bg-red-500/10 border border-red-500/20 rounded text-xs text-red-400 text-center"},Ot=U({__name:"AdminSearchForm",props:{parsedTitles:{default:void 0},videoId:{}},emits:["searchComplete","searchError","cancel"],setup(o,{emit:h}){const u=o,s=h,l=_(null),r=_(null),k=_([]);q(()=>{u.parsedTitles&&(k.value=u.parsedTitles.map(x=>({artist:x.artist,title:x.title})))});const P=async x=>{l.value=x;const m=k.value[x];if(!m||!m.artist||!m.title){r.value="Artist and title are required",l.value=null;return}try{const b=await $fetch("/api/metadata/musicbrainz-search",{method:"POST",body:{artist:m.artist,title:m.title}});b.success&&b.results?.length>0?(r.value=null,s("searchComplete",b.results)):(r.value="No search results found",s("searchError","No search results found"))}catch(b){const T=b instanceof Error?b.message:"Unknown error occurred";r.value=`Search failed: ${T}`,s("searchError",`Search failed: ${T}`)}finally{l.value=null}},v=()=>{r.value=null,s("cancel")},M=x=>{const m=k.value[x];if(m){const b=m.artist;m.artist=m.title,m.title=b}};return(x,m)=>{const b=j;return o.parsedTitles?.length?(i(),d("div",$t,[e("div",_t,[e("h4",kt," Parsed Titles ("+p(o.parsedTitles.length)+" found) ",1),A(b,{size:"small",variant:"ghost",class:"text-xs",onClick:v},{default:w(()=>[...m[2]||(m[2]=[y(" Cancel ",-1)])]),_:1})]),e("div",wt,[e("table",Ct,[m[8]||(m[8]=e("thead",null,[e("tr",{class:"border-b border-primary-2/50"},[e("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Artist "),e("th",{class:"text-center p-2 font-medium text-primary-4 text-xs w-12"}),e("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Title "),e("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Confidence "),e("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Action ")])],-1)),e("tbody",null,[(i(!0),d(L,null,z(o.parsedTitles,(T,E)=>(i(),d("tr",{key:E,class:"border-b border-primary-2/30 hover:bg-bg-gradient transition-colors"},[e("td",Dt,[K(e("input",{"onUpdate:modelValue":V=>a(k)[E].artist=V,class:"w-full bg-transparent border border-primary-2/50 rounded px-2 py-1 text-primary-4 text-xs focus:border-accent focus:outline-none",placeholder:T.artist,"data-input":"",onKeydown:m[0]||(m[0]=I(()=>{},["stop"]))},null,40,St),[[Q,a(k)[E].artist]])]),e("td",At,[A(b,{size:"small",variant:"ghost",class:"!p-1 !min-w-0 hover:bg-accent/20",title:"Swap artist and title",onClick:V=>M(E)},{default:w(()=>[...m[3]||(m[3]=[e("div",{class:"i-mdi-swap-horizontal text-xs"},null,-1)])]),_:1},8,["onClick"])]),e("td",Mt,[K(e("input",{"onUpdate:modelValue":V=>a(k)[E].title=V,class:"w-full bg-transparent border border-primary-2/50 rounded px-2 py-1 text-primary-3 text-xs focus:border-accent focus:outline-none",placeholder:T.title,"data-input":"",onKeydown:m[1]||(m[1]=I(()=>{},["stop"]))},null,40,Tt),[[Q,a(k)[E].title]])]),e("td",Et,[e("div",Pt,[e("div",Lt,[e("div",{class:"h-full bg-accent rounded-full transition-all",style:et({width:`${T.confidence*100}%`})},null,4)]),e("span",Vt,p(Math.round(T.confidence*100))+"% ",1)])]),e("td",Rt,[A(b,{size:"small",variant:"primary",disabled:a(l)===E,class:"text-xs",onClick:V=>P(E)},{default:w(()=>[a(l)===E?(i(),d(L,{key:0},[m[4]||(m[4]=e("div",{class:"i-mdi-loading animate-spin mr-1"},null,-1)),m[5]||(m[5]=y(" Searching... ",-1))],64)):(i(),d(L,{key:1},[m[6]||(m[6]=e("div",{class:"i-mdi-magnify mr-1"},null,-1)),m[7]||(m[7]=y(" Search ",-1))],64))]),_:2},1032,["disabled","onClick"])])]))),128))])])]),a(l)!==null?(i(),d("div",zt,' Searching MusicBrainz for "'+p(o.parsedTitles[a(l)]?.artist)+" - "+p(o.parsedTitles[a(l)]?.title)+'"... ',1)):$("",!0),a(r)?(i(),d("div",Ft,p(a(r)),1)):$("",!0)])):$("",!0)}}}),Ut=Object.assign(Ot,{__name:"AdminSearchForm"}),jt={key:0,class:"space-y-2"},Nt=["onClick"],Bt={class:"text-xs font-medium text-primary-4 line-clamp-1"},Ht={class:"text-xs text-primary-3 line-clamp-1"},It={class:"flex justify-between items-center mt-1"},Kt={class:"text-xs text-primary-3"},Qt={class:"text-xs text-accent"},Yt=U({__name:"AdminSearchResultsSelection",props:{videoId:{},searchResults:{default:void 0}},emits:["matchComplete","matchError","cancel"],setup(o,{emit:h}){const u=o,s=h,l=_(!1),r=async P=>{l.value=!0;try{const v=await $fetch("/api/metadata/musicbrainz",{method:"POST",body:{videoId:u.videoId,mbid:P}});v.success&&v.data?s("matchComplete",v.data):s("matchError","Failed to match recording")}catch(v){const M=v instanceof Error?v.message:"Unknown error occurred";s("matchError",`Error matching recording: ${M}`)}finally{l.value=!1}},k=()=>{s("cancel")};return(P,v)=>{const M=j;return o.searchResults?.length?(i(),d("div",jt,[v[2]||(v[2]=e("div",{class:"text-xs font-medium text-primary-4 mb-2"}," Select best match: ",-1)),(i(!0),d(L,null,z(o.searchResults.slice(0,3),x=>(i(),d("div",{key:x.id,class:Y(["bg-primary-2 p-2 rounded cursor-pointer hover:bg-primary-3/20 transition-colors",{"opacity-50 pointer-events-none":a(l)}]),onClick:m=>r(x.id)},[e("div",Bt,p(x.title),1),e("div",Ht," by "+p(x.artist),1),e("div",It,[e("span",Kt,p(x.releaseCount)+" release"+p(x.releaseCount!==1?"s":""),1),e("span",Qt,p(x.score)+"%",1)])],10,Nt))),128)),a(l)?(i(),O(M,{key:0,size:"small",variant:"ghost",disabled:"",class:"text-xs"},{default:w(()=>[...v[0]||(v[0]=[y(" Matching... ",-1)])]),_:1})):(i(),O(M,{key:1,size:"small",variant:"ghost",class:"text-xs",onClick:k},{default:w(()=>[...v[1]||(v[1]=[y(" Cancel ",-1)])]),_:1}))])):$("",!0)}}}),qt=Object.assign(Yt,{__name:"AdminSearchResultsSelection"});function S(o){return o.replace(/\s*\((Original\s+Mix|Radio\s+Edit|Extended\s+Mix|Club\s+Mix|Remix|Remaster|Remastered|Version)\)\s*/gi,"").replace(/\s*[-â€“~|:]\s*$/,"").replace(/^\s*[-â€“~|:]\s*/,"").replace(/\s*[()\[\]{}]\s*$/,"").replace(/^\s*[()\[\]{}]\s*/,"").replace(/\s*[,;.!?]\s*$/,"").replace(/\s*[-â€“~|:]\s*[-â€“~|:]\s*/g," - ").replace(/\s+/g," ").trim()}function Wt(o){const h=[],u=Jt(o);let s=u.match(/^(.+?)\s*[-â€“]\s*([^-â€“]+?)(?:\s*[-â€“].*)?$/);if(s&&s[1]&&s[2]){const[,l,r]=s;h.push({artist:S(l),title:S(r),confidence:.9})}if(s=u.match(/^(.+?)\s*~\s*(.+?)(?:\s*~.*)?$/),s&&s[1]&&s[2]){const[,l,r]=s;h.push({artist:S(l),title:S(r),confidence:.85})}if(s=u.match(/^([^-]+?)\s*-\s*([^-]+?)(?:\s*-.*)?$/),s&&s[1]&&s[2]){const[,l,r]=s,k=["live","version","remix","cover","acoustic","instrumental","edit","remaster","demo","alternate","extended","radio","single"],P=["feat","ft","featuring","vs","x","with","and","&"],v=k.some(b=>l.toLowerCase().includes(b)),M=P.some(b=>r.toLowerCase().includes(b)),x=r.length<25&&r.split(" ").length<=3&&!/[()[\]]/.test(r);(v||x&&!M&&r.length<l.length*.7)&&h.push({artist:S(r),title:S(l),confidence:.75})}if(s=u.match(/^(.+?)\s*:\s*(.+)$/),s&&s[1]&&s[2]){const[,l,r]=s;h.push({artist:S(l),title:S(r),confidence:.8})}if(s=u.match(/^(.+?)\s*\|\s*([^|]+?)(?:\s*\|.*)?$/),s&&s[1]&&s[2]){const[,l,r]=s;h.push({artist:S(l),title:S(r),confidence:.8})}if(s=u.match(/^(.+?)\s*["'"](.+?)["'"].*$/),s&&s[1]&&s[2]){const[,l,r]=s;h.push({artist:S(l),title:S(r),confidence:.85})}if(s=u.match(/^(.+?)\s+([A-Z\s]{3,})(?:\s|$)/),s&&s[1]&&s[2]){const[,l,r]=s;r.trim().split(" ").length<=5&&h.push({artist:S(l),title:S(r),confidence:.7})}return h.length===0&&h.push({artist:"Unknown Artist",title:S(u||o),confidence:.1}),h.sort((l,r)=>r.confidence-l.confidence)}function Jt(o){return o.replace(/\s*\[Official Music Video\]/gi,"").replace(/\s*\[4K Remaster\]/gi,"").replace(/\s*\[(Official|Music|Video|Audio|Lyric|Live|HD|4K|HQ|MV)\s?(Video|Audio|Music|Performance|MV)?\]/gi,"").replace(/\s*\((Official|Music|Video|Audio|Lyric|Live|HD|4K|HQ|MV)\s?(Video|Audio|Music|Performance|MV)?\)/gi,"").replace(/\s*\(\d{4}\)/g,"").replace(/\s*\/\d{4}\/\s*/g,"").replace(/\s*\((Stereo|Mono|Remastered?|Remaster|\d{4}\s*Remaster(ed)?)\)/gi,"").replace(/\s*\[(Stereo|Mono|Remastered?|Remaster|\d{4}\s*Remaster(ed)?)\]/gi,"").replace(/\s*\b(HD|4K|1080p|720p|HQ|High Quality)\b/gi,"").replace(/\s*[fF]t\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*[Ff]eat\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*[Ff]eaturing\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*\([^)]*\)/g,"").replace(/\s+/g," ").trim()}function Xt(o){return S(o.replace(/\s*(Official|Music|VEVO|Records|Entertainment)$/gi,"").replace(/\s*-.*$/,"").trim())}const Zt={class:"rounded-lg shadow-sm"},Gt={class:"flex items-center justify-between mb-4"},te={class:"text-lg font-semibold flex items-center gap-2"},ee={key:0,class:"text-center py-8"},se={key:1,class:"overflow-x-auto"},ae={class:"w-full border-collapse"},le={class:"border-b border-primary-2/30 hover:bg-bg-gradient transition-colors"},ie={class:"p-3"},ne={class:"flex items-center gap-3"},oe={class:"flex-shrink-0"},re=["src","alt"],ce={class:"flex-1 min-w-0"},de={class:"font-medium text-primary-4 line-clamp-2 text-sm"},ue=["href"],me={class:"p-3"},pe={class:"text-sm text-primary-3"},he={class:"p-3"},fe={class:"text-sm text-primary-3 font-mono"},ge={class:"p-3"},ye={class:"min-w-48"},xe={key:0,class:"text-xs text-primary-3"},ve={class:"p-3"},be={class:"flex flex-wrap items-center gap-2"},$e={key:0,class:"border-b border-primary-2/30"},_e={colspan:"5",class:"p-3 space-y-4"},ke=U({__name:"AdminVideoList",props:{videos:{default:()=>[]}},setup(o){const h=o,u=_({}),s=_({}),l=_({}),r=_({}),k=async()=>{if(h.videos.length!==0)try{const c=await $fetch("/api/metadata/all",{method:"POST"}),n=h.videos.map(C=>C.id),R={};for(const C of n)c[C]&&(R[C]=c[C]);u.value={...u.value,...R}}catch(c){console.warn("Failed to load existing song data:",c)}};q(async()=>{await k()});const P=(c,n)=>{u.value[c]=n,delete s.value[c],delete l.value[c]},v=c=>{console.error("Match error:",c)},M=(c,n)=>{s.value[c]=n},x=c=>{console.error("Search error:",c)},m=c=>{delete s.value[c],delete l.value[c]},b=c=>{const n=Wt(c.title);if(n.length===0||n.length===1&&n[0]&&n[0].confidence<=.1){const C={artist:Xt(c.channel)||"Unknown Artist",title:c.title,confidence:.2};n.length===0?n.push(C):n[0]=C}l.value[c.id]=n},T=c=>{delete l.value[c]},E=c=>{delete u.value[c],delete s.value[c],delete l.value[c]},V=async c=>{try{r.value[c]=!0;const n=await $fetch("/api/musicbrainz/artist-tags",{method:"POST",body:{youtubeId:c}});n.success&&n.data&&(u.value[c]=n.data)}catch(n){console.error("Error fetching artist tags:",n)}finally{delete r.value[c]}},F=async c=>{try{r.value[c]=!0;const n=await $fetch("/api/metadata/odesli",{method:"POST",body:{youtubeId:c}});u.value[c]=n}catch(n){console.error("Error augmenting with Odesli:",n)}finally{delete r.value[c]}},N=async c=>{try{r.value[c]=!0;const n=u.value[c];if(!n?.artist||!n?.title){console.error("Cannot augment with Last.fm: missing artist or title");return}const R=await $fetch("/api/metadata/lastfm",{method:"POST",body:{youtubeId:c,artist:n.artist,title:n.title}});u.value[c]=R}catch(n){console.error("Error augmenting with Last.fm:",n)}finally{delete r.value[c]}};return(c,n)=>{const R=bt,C=j,B=Ut,f=qt;return i(),d("div",Zt,[e("div",Gt,[e("h3",te,[n[2]||(n[2]=e("div",{class:"i-mdi-playlist-music"},null,-1)),y(" Video List ("+p(o.videos.length)+" videos) ",1)])]),o.videos.length?(i(),d("div",se,[e("table",ae,[n[7]||(n[7]=e("thead",null,[e("tr",{class:"border-b border-primary-2"},[e("th",{class:"text-left p-3 font-medium text-primary-4"},"Video"),e("th",{class:"text-left p-3 font-medium text-primary-4"},"Channel"),e("th",{class:"text-left p-3 font-medium text-primary-4"},"Duration"),e("th",{class:"text-left p-3 font-medium text-primary-4"},"Music Data"),e("th",{class:"text-left p-3 font-medium text-primary-4"},"Actions")])],-1)),e("tbody",null,[(i(!0),d(L,null,z(o.videos,t=>(i(),d(L,{key:t.id},[e("tr",le,[e("td",ie,[e("div",ne,[e("div",oe,[e("img",{src:`https://i.ytimg.com/vi/${t.id}/hqdefault.jpg`,alt:t.title,class:"w-12 h-12 rounded-full object-cover bg-primary-1"},null,8,re)]),e("div",ce,[e("h4",de,p(t.title),1),e("a",{href:`https://www.youtube.com/watch?v=${t.id}`,target:"_blank",rel:"noopener noreferrer",class:"text-xs text-primary-3 hover:text-accent transition-colors"}," Watch on YouTube ",8,ue)])])]),e("td",me,[e("span",pe,p(t.channel),1)]),e("td",he,[e("span",fe,p(t.duration),1)]),e("td",ge,[e("div",ye,[A(R,{"song-data":a(u)[t.id]},null,8,["song-data"]),!a(u)[t.id]&&!a(s)[t.id]?.length&&!a(l)[t.id]?.length?(i(),d("div",xe)):$("",!0)])]),e("td",ve,[e("div",be,[!a(u)[t.id]&&!a(l)[t.id]?.length?(i(),O(C,{key:0,icon:"i-mdi-text-search",size:"small",variant:"ghost",onClick:g=>b(t)},{default:w(()=>[...n[4]||(n[4]=[y(" Search ",-1)])]),_:1},8,["onClick"])):$("",!0),a(u)[t.id]&&!a(u)[t.id]?.artistTags?.length&&!a(u)[t.id]?.tags?.length?(i(),O(C,{key:1,icon:"i-mdi-tag-plus",size:"small",variant:"ghost",disabled:a(r)[t.id],onClick:g=>V(t.id)},{default:w(()=>[...n[5]||(n[5]=[y(" Add Artist Tags ",-1)])]),_:1},8,["disabled","onClick"])):$("",!0),A(C,{icon:"i-mdi-cloud-sync",size:"small",variant:"ghost",disabled:a(r)[t.id],onClick:g=>F(t.id)},{default:w(()=>[y(p(a(r)[t.id]?"Augmenting...":"Odesli"),1)]),_:2},1032,["disabled","onClick"]),A(C,{icon:"i-mdi-database-search",size:"small",variant:"ghost",disabled:a(r)[t.id]||!a(u)[t.id]?.artist||!a(u)[t.id]?.title,onClick:g=>N(t.id)},{default:w(()=>[y(p(a(r)[t.id]?"Augmenting...":"Last.fm"),1)]),_:2},1032,["disabled","onClick"]),a(u)[t.id]?(i(),O(C,{key:2,icon:"i-mdi-delete",size:"small",variant:"ghost",onClick:g=>E(t.id)},{default:w(()=>[...n[6]||(n[6]=[y(" Clear ",-1)])]),_:1},8,["onClick"])):$("",!0)])])]),a(l)[t.id]?.length||a(s)[t.id]?.length?(i(),d("tr",$e,[e("td",_e,[a(l)[t.id]?.length?(i(),O(B,{key:0,"video-id":t.id,"parsed-titles":a(l)[t.id],onSearchComplete:g=>M(t.id,g),onSearchError:n[0]||(n[0]=g=>x(g)),onCancel:g=>T(t.id)},null,8,["video-id","parsed-titles","onSearchComplete","onCancel"])):$("",!0),a(s)[t.id]?.length?(i(),O(f,{key:1,"video-id":t.id,"search-results":a(s)[t.id],onMatchComplete:g=>P(t.id,g),onMatchError:n[1]||(n[1]=g=>v(g)),onCancel:g=>m(t.id)},null,8,["video-id","search-results","onMatchComplete","onCancel"])):$("",!0)])])):$("",!0)],64))),128))])])])):(i(),d("div",ee,[...n[3]||(n[3]=[e("div",{class:"i-mdi-video-outline text-4xl mb-2"},null,-1),e("p",{class:""},"No videos found in this playlist.",-1)])]))])}}}),we=Object.assign(ke,{__name:"AdminVideoList"}),Ce={class:"p-8 max-w-6xl mx-auto"},De={class:"flex items-center justify-between mb-8"},Se={class:"flex flex-col gap-6"},Ae={class:"rounded-lg mb-8 shadow-sm"},Me={key:0,class:"rounded-lg p-4 mb-8"},Te={class:"flex items-center gap-2"},Ee={key:1,class:"rounded-lg p-4 mb-8"},Pe={class:"flex items-center gap-2"},Le={class:"rounded-lg shadow-sm"},Ve={class:"flex items-center justify-between mb-4"},Re={key:0,class:"text-center py-8"},ze={key:1,class:"text-center py-8"},Fe={key:2,class:"space-y-4"},Oe={class:"flex-1"},Ue={class:"font-medium text-primary-3"},je={class:"text-sm"},Ne={key:0,class:"text-xs mt-1 line-clamp-2"},Be={class:"flex items-center gap-2 ml-4"},He={key:2,class:"rounded-lg shadow-sm"},Ie={class:"flex items-center justify-between mb-4"},Ke={class:"text-xl font-semibold flex items-center gap-2"},Qe={key:0,class:"text-center py-8"},Ye={key:2,class:"text-center py-8"},Ze=U({__name:"admin",setup(o){st({title:"Admin Panel - Music Playlist View",meta:[{name:"description",content:"Manage your YouTube playlists"}]});const h=_(""),u=_(!1),s=_(""),l=_(""),r=_([]),k=_(!0),P=_(null),v=_(null),M=_(null),x=_(null),m=_(null),b=_([]),T=_(!1);at(async()=>{await F()});const E=f=>{const t=f.trim(),g=t.match(/[?&]list=([a-zA-Z0-9_-]+)/);return g&&g[1]?g[1]:t},V=async()=>{if(h.value.trim()){u.value=!0,s.value="",l.value="";try{const f=E(h.value);if(!f)throw new Error("Invalid playlist ID or URL");const t=await $fetch(`/api/playlists/${f}`);if(t.success)l.value=`Successfully loaded playlist: ${t.data.title}`,h.value="",await F();else throw new Error("Failed to fetch playlist")}catch(f){console.error("Error fetching playlist:",f),s.value=f.data?.message||f.message||"Failed to fetch playlist. Please check the playlist ID and try again."}finally{u.value=!1}}},F=async()=>{try{k.value=!0;const f=await $fetch("/index.json");f.success&&(r.value=f.data)}catch(f){console.error("Error loading cached playlists:",f)}finally{k.value=!1}},N=async f=>{try{P.value=f;const t=await $fetch(`/api/playlists/${f}`);t.success&&(await F(),l.value=`Successfully updated playlist: ${t.data.title}`,s.value="")}catch(t){console.error("Error refreshing playlist:",t),s.value="Failed to refresh playlist",l.value=""}finally{P.value=null}},c=async f=>{if(confirm("Are you sure you want to delete this cached playlist?"))try{v.value=f,await $fetch(`/api/playlists/${f}`,{method:"DELETE"}),await F(),l.value="Successfully deleted cached playlist",s.value=""}catch(t){console.error("Error deleting playlist:",t),s.value="Failed to delete playlist",l.value=""}finally{v.value=null}},n=f=>new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),R=async f=>{try{M.value=f.id,T.value=!0;const t=await $fetch(`/playlist/${f.fileName}`);if(t)m.value=f,b.value=t.videos||[];else throw new Error("Failed to load playlist videos")}catch(t){console.error("Error loading playlist for editing:",t),s.value="Failed to load playlist videos",l.value=""}finally{M.value=null,T.value=!1}},C=()=>{m.value=null,b.value=[]},B=async f=>{try{x.value=f,s.value="",l.value="";const t=await $fetch("/api/playlists/update-data",{method:"POST",body:{playlistId:f}});if(t.success)l.value=t.message,await F();else throw new Error("Failed to update playlist music data")}catch(t){console.error("Error updating playlist music data:",t),s.value=t.data?.message||t.message||"Failed to update playlist music data",l.value=""}finally{x.value=null}};return(f,t)=>{const g=j,W=tt,J=we;return i(),d("div",Ce,[e("div",De,[t[2]||(t[2]=e("h1",{class:"text-3xl font-bold flex items-center gap-3"},[e("div",{class:"i-mdi-cog"}),y(" Admin Panel ")],-1)),A(g,{icon:"i-mdi-arrow-left",variant:"primary",to:"/"},{default:w(()=>[...t[1]||(t[1]=[y(" Back to Playlists ",-1)])]),_:1})]),e("div",Se,[e("div",Ae,[t[3]||(t[3]=e("h2",{class:"text-xl font-semibold mb-4 flex items-center gap-2"},[e("div",{class:"i-mdi-plus"}),y(" Add New Playlist ")],-1)),e("form",{class:"space-y-4",onSubmit:I(V,["prevent"])},[A(W,{id:"playlistId",modelValue:a(h),"onUpdate:modelValue":t[0]||(t[0]=D=>lt(h)?h.value=D:null),label:"YouTube Playlist ID or URL",placeholder:"Enter playlist ID (e.g., PLrAXtmRdnEQy8VVXvSgb5eKzwJJxd0FMz) or full URL",class:"max-w-xl","help-text":"You can paste either the playlist ID or the full YouTube playlist URL",disabled:a(u),required:""},null,8,["modelValue","disabled"]),A(g,{type:"submit",icon:"i-mdi-download",size:"medium",disabled:!a(h).trim(),loading:a(u),"show-text-while-loading":!0},{default:w(()=>[y(p(a(u)?"Loading...":"Load Playlist"),1)]),_:1},8,["disabled","loading"])],32)]),a(l)?(i(),d("div",Me,[e("div",Te,[t[4]||(t[4]=e("div",{class:"i-mdi-check-circle"},null,-1)),t[5]||(t[5]=e("strong",null,"Success:",-1)),y(" "+p(a(l)),1)])])):$("",!0),a(s)?(i(),d("div",Ee,[e("div",Pe,[t[6]||(t[6]=e("div",{class:"i-mdi-alert-circle"},null,-1)),t[7]||(t[7]=e("strong",null,"Error:",-1)),y(" "+p(a(s)),1)])])):$("",!0),e("div",Le,[e("div",Ve,[t[9]||(t[9]=e("h2",{class:"text-xl font-semibold flex items-center gap-2"},[e("div",{class:"i-mdi-playlist-play"}),y(" Cached Playlists ")],-1)),A(g,{icon:"i-mdi-refresh",size:"small",loading:a(k),onClick:F},{default:w(()=>[...t[8]||(t[8]=[y(" Refresh ",-1)])]),_:1},8,["loading"])]),a(k)?(i(),d("div",Re,[...t[10]||(t[10]=[e("div",{class:"i-mdi-loading animate-spin text-2xl mb-2"},null,-1),e("p",{class:""},"Loading cached playlists...",-1)])])):a(r).length?(i(),d("div",Fe,[(i(!0),d(L,null,z(a(r),D=>(i(),d("div",{key:D.id,class:"flex items-center justify-between rounded-lg hover:bg-bg-gradient py-6"},[e("div",Oe,[e("h3",Ue,p(D.title),1),e("p",je,p(D.videoCount)+" videos â€¢ Last updated: "+p(n(D.lastFetched)),1),D.description?(i(),d("p",Ne,p(D.description),1)):$("",!0)]),e("div",Be,[A(g,{icon:"i-mdi-database-plus",size:"small",variant:"primary",loading:a(x)===D.id,onClick:H=>B(D.id)},{default:w(()=>[...t[12]||(t[12]=[y(" Update All Music Data ",-1)])]),_:1},8,["loading","onClick"]),A(g,{icon:"i-mdi-pencil",size:"small",variant:"secondary",loading:a(M)===D.id,onClick:H=>R(D)},{default:w(()=>[...t[13]||(t[13]=[y(" Edit ",-1)])]),_:1},8,["loading","onClick"]),A(g,{icon:"i-mdi-refresh",size:"small",loading:a(P)===D.id,onClick:H=>N(D.id)},{default:w(()=>[...t[14]||(t[14]=[y(" Update ",-1)])]),_:1},8,["loading","onClick"]),A(g,{icon:"i-mdi-delete",size:"small",variant:"danger",loading:a(v)===D.id,onClick:H=>c(D.id)},{default:w(()=>[...t[15]||(t[15]=[y(" Delete ",-1)])]),_:1},8,["loading","onClick"])])]))),128))])):(i(),d("div",ze,[...t[11]||(t[11]=[e("div",{class:"i-mdi-playlist-remove text-4xl mb-2"},null,-1),e("p",{class:""},"No cached playlists found.",-1)])]))]),a(m)?(i(),d("div",He,[e("div",Ie,[e("h2",Ke,[t[16]||(t[16]=e("div",{class:"i-mdi-pencil"},null,-1)),y(" Editing: "+p(a(m).title),1)]),A(g,{icon:"i-mdi-close",size:"small",variant:"ghost",onClick:C},{default:w(()=>[...t[17]||(t[17]=[y(" Close ",-1)])]),_:1})]),a(T)?(i(),d("div",Qe,[...t[18]||(t[18]=[e("div",{class:"i-mdi-loading animate-spin text-2xl mb-2"},null,-1),e("p",{class:""},"Loading playlist videos...",-1)])])):a(b).length?(i(),O(J,{key:1,videos:a(b)},null,8,["videos"])):(i(),d("div",Ye,[...t[19]||(t[19]=[e("div",{class:"i-mdi-video-off text-4xl mb-2"},null,-1),e("p",{class:""},"No videos found in this playlist.",-1)])]))])):$("",!0)])])}}});export{Ze as default};
