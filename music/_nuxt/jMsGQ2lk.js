import{z as R,g as v,s as V,B as A,A as c,I as o,J as O}from"./C16Bt2mp.js";const w=R("playlistStore",()=>{const t=v(null),i=v(null),u=v(!1),d=v(""),g=V(()=>t.value!==null),I=V(()=>t.value?.videos||[]),y=n=>[...n].sort((a,s)=>a.createdAt&&!s.createdAt?-1:!a.createdAt&&s.createdAt?1:a.createdAt&&s.createdAt?s.createdAt-a.createdAt:0),x=n=>({...n,videos:y(n.videos)});return{currentPlaylist:t,loading:u,error:d,hasCurrentPlaylist:g,originalCurrentPlaylist:i,currentVideos:I,loadFirstPlaylist:async()=>{try{u.value=!0,d.value="";const n=await $fetch("/index.json");if(!n.success||!n.data.length){t.value=null,i.value=null;return}const a=n.data[0],s=await $fetch(`/playlist/${a?.fileName}`),f=x(s);t.value=f,i.value=JSON.parse(JSON.stringify(f))}catch(n){console.error("Error loading first playlist:",n),d.value=n.data?.message||n.message||"Failed to load playlist",t.value=null,i.value=null}finally{u.value=!1}},setCurrentPlaylistVideos:n=>{t.value&&(t.value={...t.value,videos:n})},findVideoIndex:n=>t.value?t.value.videos.findIndex(a=>a.id===n):-1,sortVideosByCreatedAt:y}}),e=O({isPlaying:!1,currentVideo:null,currentIndex:0,isPlayerReady:!1,showPlayerBar:!1,isFloatingPlayerOpen:!1,youtubePlayerInstance:null}),C=()=>{const{currentVideos:t}=A(w()),i=V(()=>e.currentVideo?t.value.findIndex(l=>l.id===e.currentVideo?.id)>0:!1),u=V(()=>{if(!e.currentVideo)return!1;const r=t.value.findIndex(l=>l.id===e.currentVideo?.id);return r===-1?t.value.length>0:r<t.value.length-1}),d=r=>{e.currentVideo=r,e.showPlayerBar=!!r},g=r=>{e.isPlaying=r},I=r=>{e.isPlayerReady=r},y=r=>{e.youtubePlayerInstance=r},x=()=>{const r=e.youtubePlayerInstance;!r||!e.isPlayerReady||(e.isPlaying?r.pauseVideo():r.playVideo())},P=r=>{r>=0&&r<t.value.length&&(e.currentIndex=r,e.currentVideo=t.value[r]||null)},p=()=>{if(!e.currentVideo)return;const r=t.value.findIndex(l=>l.id===e.currentVideo?.id);if(r>0){const l=r-1;e.currentIndex=l,e.currentVideo=t.value[l]||null}},h=()=>{if(!e.currentVideo)return;const r=t.value.findIndex(l=>l.id===e.currentVideo?.id);if(r!==-1&&r<t.value.length-1){const l=r+1;e.currentIndex=l,e.currentVideo=t.value[l]||null}else r===-1&&t.value.length>0&&(e.currentIndex=0,e.currentVideo=t.value[0]||null)},n=r=>{P(r)},a=()=>{e.showPlayerBar=!1,e.isFloatingPlayerOpen=!1,e.currentVideo=null,e.isPlaying=!1,e.isPlayerReady=!1,e.youtubePlayerInstance=null},s=(r=0)=>{P(r),e.showPlayerBar=!0,e.isFloatingPlayerOpen=!0},f=()=>{e.isFloatingPlayerOpen=!0},F=()=>{e.isFloatingPlayerOpen=!1};return{isPlaying:c(o(e,"isPlaying")),currentVideo:o(e,"currentVideo"),currentIndex:c(o(e,"currentIndex")),isPlayerReady:c(o(e,"isPlayerReady")),showPlayerBar:c(o(e,"showPlayerBar")),isFloatingPlayerOpen:c(o(e,"isFloatingPlayerOpen")),canPlayPrevious:i,canPlayNext:u,setCurrentVideo:d,setIsPlaying:g,setIsPlayerReady:I,setCurrentIndex:P,setYouTubePlayerInstance:y,togglePlayPause:x,previousVideo:p,nextVideo:h,playVideo:n,closePlayer:a,initializeGlobalPlayer:s,openFloatingPlayer:f,closeFloatingPlayer:F}};export{w as a,C as u};
