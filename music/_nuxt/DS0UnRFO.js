import{_ as oe}from"./B-8TTQKA.js";import{e as G,z as M,c as C,f as U,g as s,o as _,a,b as w,t as F,w as z,h as r,x as S,y as se,q as Pe,A as be,l as ke,E as Ee,m as Le,n as ze}from"./B4jWD9Im.js";import{b as P,a as Me,u as ie}from"./BQ0GorY9.js";import"./ClQAiVSp.js";import"./CqtHE6ii.js";import"./cTjeiag2.js";const Ce={key:0,class:"fixed bottom-0 left-1/2 transform -translate-x-1/2 z-40 bg-primary-1 p-4 rounded-xl mb-3"},Ve={class:"w-full sm:w-md md:w-2xl lg:w-3xl mx-auto flex items-center gap-4"},Ye=["src","alt"],Re={class:"flex-1 min-w-0"},Se={class:"text-primary-4 font-medium text-sm line-clamp-1"},Be={class:"text-primary-3 text-xs line-clamp-1"},De={class:"flex items-center gap-2"},Ie={key:0,class:"i-mdi-pause w-5 h-5"},He={key:1,class:"i-mdi-play w-5 h-5"},$e={class:"text-primary-3 text-xs flex-shrink-0 hidden sm:block"},Te=G({__name:"VideoPlayerBar",setup(V){const{currentVideo:o,isPlaying:c,canPlayPrevious:x,canPlayNext:i}=M(P()),{togglePlayPause:g,previousVideo:b,nextVideo:k,closePlayer:y}=P();return(E,d)=>{const f=oe;return s(o)?(_(),C("div",Ce,[a("div",Ve,[a("img",{src:`https://i.ytimg.com/vi/${s(o).id}/hqdefault.jpg`,alt:s(o).title,class:"w-12 h-9 object-cover rounded flex-shrink-0"},null,8,Ye),a("div",Re,[a("h3",Se,F(s(o).title),1),a("p",Be,F(s(o).channel),1)]),a("div",De,[w(f,{variant:"secondary",disabled:!s(x),class:"!p-2",onClick:s(b)},{default:z(()=>[...d[0]||(d[0]=[a("div",{class:"i-mdi-skip-previous w-4 h-4"},null,-1)])]),_:1},8,["disabled","onClick"]),w(f,{variant:"primary",class:"!p-2",onClick:s(g)},{default:z(()=>[s(c)?(_(),C("div",Ie)):(_(),C("div",He))]),_:1},8,["onClick"]),w(f,{variant:"secondary",disabled:!s(i),class:"!p-2",onClick:s(k)},{default:z(()=>[...d[1]||(d[1]=[a("div",{class:"i-mdi-skip-next w-4 h-4"},null,-1)])]),_:1},8,["disabled","onClick"])]),a("div",$e,F(s(o).duration),1),w(f,{variant:"ghost",class:"!p-2",onClick:s(y)},{default:z(()=>[...d[2]||(d[2]=[a("div",{class:"i-mdi-close text-xl"},null,-1)])]),_:1},8,["onClick"])])])):U("",!0)}}}),Xe=Object.assign(Te,{__name:"VideoPlayerBar"}),Ne={class:"hidden group-hover:flex absolute -top-6 right-3 gap-1"},Oe={class:"w-8 h-8 bg-primary-1 rounded-t-2xl shadow-xl flex items-center justify-center"},We={class:"bg-primary-1 rounded-2xl shadow-xl overflow-hidden h-full"},Ae={class:"p-4 h-full"},je={class:"bg-black rounded-2xl overflow-hidden h-full"},Fe=G({__name:"VideoPlayer",props:{isOpen:{type:Boolean,default:!1},initialVideoIndex:{default:0}},emits:["close","videoChange"],setup(V,{emit:o}){const c=V,x=o,{currentVideo:i,currentIndex:g,isPlayerReady:b,canPlayNext:k}=M(P()),{setIsPlaying:y,setIsPlayerReady:E,setCurrentIndex:d,setYouTubePlayerInstance:f,togglePlayPause:le,previousVideo:re,nextVideo:q,closePlayer:de,initializeGlobalPlayer:ue}=P(),{currentVideos:ce}=M(Me()),{videoPlayerPosition:l}=M(ie()),{updateMediaSessionMetadata:K,updateMediaSessionPlaybackState:L}=ie(),J=r(),B=r(),me=r(),ve=r(),he=r();let p=null;const t=r({x:l.value.x,y:l.value.y,width:l.value.width,height:l.value.height}),D=r(!1),I=r(!1),H=r(!1),$=r({x:0,y:0}),u=r({x:0,y:0,width:0,height:0});S(()=>c.initialVideoIndex,e=>{e!==void 0&&d(e)},{immediate:!0}),S(()=>c.isOpen,e=>{e?(ce.value.length>0&&ue(g.value),se(()=>{pe()})):T()}),S([i,g],([e,n])=>{e&&(xe(),x("videoChange",e,n),K(e))});const pe=()=>{if(i.value){if(window.YT&&window.YT.Player)Q();else if(!window.onYouTubeIframeAPIReady){const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";const n=document.getElementsByTagName("script")[0];n&&n.parentNode?n.parentNode.insertBefore(e,n):document.head.appendChild(e),window.onYouTubeIframeAPIReady=()=>{Q()}}}},Q=()=>{!J.value||!i.value||(T(),p=new window.YT.Player("youtube-player",{height:"100%",width:"100%",videoId:i.value.id,playerVars:{autoplay:1,controls:1,modestbranding:1,rel:0,showinfo:0},events:{onReady:ye,onStateChange:fe}}))},ye=()=>{E(!0),y(!0),f(p),i.value&&K(i.value),L("playing")},fe=e=>{const n=e.data,m=0,v=1,h=2;switch(n){case v:y(!0),L("playing");break;case h:y(!1),L("paused");break;case m:y(!1),L("none"),k.value&&q();break}},xe=()=>{!p||!b.value||!i.value||p.loadVideoById(i.value.id)},T=()=>{p&&typeof p.destroy=="function"&&(p.destroy(),p=null,E(!1),f(null),L("none"))},ge=e=>{if(!B.value)return;D.value=!0;const n=B.value.getBoundingClientRect();$.value={x:e.clientX-n.left,y:e.clientY-n.top},document.addEventListener("mousemove",X),document.addEventListener("mouseup",N),e.preventDefault()},X=e=>{if(!D.value)return;const n=e.clientX-$.value.x,m=e.clientY-$.value.y,v=window.innerWidth-t.value.width,h=window.innerHeight-t.value.height;t.value.x=Math.max(0,Math.min(n,v)),t.value.y=Math.max(0,Math.min(m,h))},N=()=>{D.value=!1,document.removeEventListener("mousemove",X),document.removeEventListener("mouseup",N),l.value={...t.value}},we=e=>{I.value=!0,u.value={x:e.clientX,y:e.clientY,width:t.value.width,height:t.value.height},document.addEventListener("mousemove",O),document.addEventListener("mouseup",W),e.preventDefault()},O=e=>{if(!I.value)return;const n=e.clientX-u.value.x,m=e.clientY-u.value.y,v=Math.max(280,Math.min(800,u.value.width+n)),h=Math.max(200,Math.min(600,u.value.height+m)),Y=window.innerWidth-v,R=window.innerHeight-h;t.value.width=v,t.value.height=h,t.value.x>Y&&(t.value.x=Math.max(0,Y)),t.value.y>R&&(t.value.y=Math.max(0,R))},W=()=>{I.value=!1,document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",W),l.value={...t.value}},_e=e=>{H.value=!0,u.value={x:e.clientX,y:e.clientY,width:t.value.width,height:t.value.height},document.addEventListener("mousemove",A),document.addEventListener("mouseup",j),e.preventDefault()},A=e=>{if(!H.value)return;const n=e.clientX-u.value.x,m=e.clientY-u.value.y,v=Math.max(280,Math.min(800,u.value.width-n)),h=Math.max(200,Math.min(600,u.value.height+m)),Y=v-t.value.width,R=Math.max(0,t.value.x-Y),ae=window.innerHeight-h;t.value.width=v,t.value.height=h,t.value.x=R,t.value.y>ae&&(t.value.y=Math.max(0,ae))},j=()=>{H.value=!1,document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",j),l.value={...t.value}},Z=()=>{const e=window.innerWidth-t.value.width,n=window.innerHeight-t.value.height;t.value.x=Math.max(0,Math.min(t.value.x,e)),t.value.y=Math.max(0,Math.min(t.value.y,n)),(t.value.x!==l.value.x||t.value.y!==l.value.y)&&(l.value={...t.value})},ee=()=>{de(),x("close")},te=e=>{if(c.isOpen)switch(e.code){case"Escape":ee();break;case"Space":e.preventDefault(),le();break;case"ArrowLeft":e.preventDefault(),re();break;case"ArrowRight":e.preventDefault(),q();break}},ne=()=>{c.isOpen&&Z()};return Pe(()=>{document.addEventListener("keydown",te),window.addEventListener("resize",ne),c.isOpen&&se(()=>{Z()})}),be(()=>{document.removeEventListener("keydown",te),window.removeEventListener("resize",ne),document.removeEventListener("mousemove",X),document.removeEventListener("mouseup",N),document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",W),document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",j),T()}),S(l,e=>{t.value={...e}},{deep:!0}),(e,n)=>{const m=oe;return V.isOpen?(_(),C("div",{key:0,ref_key:"playerWrapper",ref:B,style:ke({position:"fixed",left:`${s(t).x}px`,top:`${s(t).y}px`,width:`${s(t).width}px`,height:`${s(t).height}px`,zIndex:50,minWidth:"280px",minHeight:"200px",maxWidth:"800px",maxHeight:"600px"}),class:"select-none group"},[a("div",Ne,[a("div",{ref_key:"dragHandle",ref:me,class:"w-8 h-8 bg-primary-1 rounded-t-2xl shadow-lg flex items-center justify-center cursor-move",onMousedown:ge},[...n[0]||(n[0]=[a("div",{class:"i-mdi-drag w-4 h-4 text-primary-3"},null,-1)])],544),a("div",Oe,[w(m,{variant:"ghost",class:"!p-2",onClick:ee},{default:z(()=>[...n[1]||(n[1]=[a("div",{class:"i-mdi-close w-5 h-5"},null,-1)])]),_:1})])]),a("div",We,[a("div",Ae,[a("div",je,[a("div",{id:"youtube-player",ref_key:"playerContainer",ref:J,class:"w-full h-full"},null,512)])]),a("div",{ref_key:"resizeHandle",ref:ve,class:"absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",onMousedown:we},[...n[2]||(n[2]=[a("div",{class:"i-mdi-resize-bottom-right w-4 h-4 text-primary-3 opacity-50 hover:opacity-100"},null,-1)])],544),a("div",{ref_key:"resizeHandleLeft",ref:he,class:"absolute bottom-0 left-0 w-4 h-4 cursor-sw-resize",onMousedown:_e},[...n[3]||(n[3]=[a("div",{class:"i-mdi-resize-bottom-right w-4 h-4 text-primary-3 opacity-50 hover:opacity-100 transform scale-x-[-1]"},null,-1)])],544)])],4)):U("",!0)}}}),Ge=Object.assign(Fe,{__name:"VideoPlayer"}),et=G({__name:"default",setup(V){const{showPlayerBar:o,isFloatingPlayerOpen:c,currentIndex:x}=M(P()),{closeFloatingPlayer:i}=P(),g=()=>{i()},b=()=>{};return(k,y)=>{const E=Xe,d=Ge;return _(),C("div",{class:ze(["min-h-screen bg-bg-color",{"pb-20":s(o)}])},[Ee(k.$slots,"default"),s(o)?(_(),Le(E,{key:0})):U("",!0),w(d,{"is-open":s(c),"initial-video-index":s(x),onClose:g,onVideoChange:b},null,8,["is-open","initial-video-index"])],2)}}});export{et as default};
