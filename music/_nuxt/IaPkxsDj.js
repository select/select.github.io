import{_ as N}from"./j781501x.js";import{_ as q}from"./CjG4Jjg0.js";import{g as tt,a as et,b as st}from"./cTjeiag2.js";import{e as U,c as r,f as k,o as n,a as t,t as f,F as R,r as z,g as l,n as J,h as b,i as W,b as T,w as C,d as y,j as Q,v as Y,k as I,l as lt,m as O,p as H,q as X,s as Z,u as at}from"./CKJZimam.js";import"./CORN1g8T.js";const it={key:0,class:"p-2 rounded text-xs"},nt={class:"font-medium text-primary-4 line-clamp-1"},ot={class:"text-primary-3 line-clamp-1"},rt={key:0,class:"text-primary-3 line-clamp-1"},dt={key:1,class:"mt-1 flex gap-2 flex-wrap"},ct=["title"],ut=["title"],mt={key:2,class:"mt-1 flex gap-1 flex-wrap"},gt=["title"],pt={key:3,class:"mt-1 text-xs text-primary-3"},ft={key:0,class:"mr-2"},ht={key:1},yt={key:4,class:"mt-2 flex gap-2 flex-wrap items-center"},xt=["href","title"],vt=U({__name:"AdminMusicDataDisplay",props:{songData:{default:void 0}},setup(c){return(h,u)=>c.songData?(n(),r("div",it,[t("div",nt,f(c.songData.title),1),t("div",ot,"by "+f(c.songData.artist),1),c.songData.album?(n(),r("div",rt,f(c.songData.album),1)):k("",!0),c.songData.tags?.length||c.songData.genres?.length||c.songData.artistTags?.length?(n(),r("div",dt,[(n(!0),r(R,null,z(c.songData.tags?.slice(0,3)||[],s=>(n(),r("span",{key:`song-${s}`,class:"inline-block bg-accent/20 text-black px-1 rounded text-xs mr-1"},f(s),1))),128)),(n(!0),r(R,null,z(c.songData.genres?.slice(0,3)||[],s=>(n(),r("span",{key:`genre-${s}`,class:"inline-block bg-primary-3/30 text-primary-4 px-1 rounded text-xs mr-1",title:`Genre: ${s}`},f(s),9,ct))),128)),(n(!0),r(R,null,z(c.songData.artistTags?.slice(0,2)||[],s=>(n(),r("span",{key:`artist-${s}`,class:"inline-block bg-primary-2/60 text-primary-4 px-1 rounded text-xs mr-1",title:`Artist tag: ${s}`},f(s),9,ut))),128))])):k("",!0),c.songData.lastfmTags?.length?(n(),r("div",mt,[(n(!0),r(R,null,z(c.songData.lastfmTags.slice(0,3),s=>(n(),r("span",{key:`lastfm-${s}`,class:"inline-block bg-red-500/20 text-red-300 px-1 rounded text-xs",title:`Last.fm tag: ${s}`},f(s),9,gt))),128))])):k("",!0),c.songData.listeners||c.songData.playcount?(n(),r("div",pt,[c.songData.listeners?(n(),r("span",ft," ðŸŽ§ "+f(c.songData.listeners.toLocaleString()),1)):k("",!0),c.songData.playcount?(n(),r("span",ht," â–¶ï¸ "+f(c.songData.playcount.toLocaleString()),1)):k("",!0)])):k("",!0),c.songData.odesli&&Object.keys(c.songData.odesli).length>0?(n(),r("div",yt,[u[0]||(u[0]=t("span",{class:"text-xs text-primary-3 mr-1"},"Listen on:",-1)),(n(!0),r(R,null,z(c.songData.odesli,(s,o)=>(n(),r("a",{key:o,href:("getPlatformUrl"in h?h.getPlatformUrl:l(et))(o,s),target:"_blank",rel:"noopener noreferrer",class:"text-primary-3 hover:text-accent transition-colors",title:`Listen on ${("getPlatformName"in h?h.getPlatformName:l(tt))(o)}`},[t("div",{class:J([("getPlatformIcon"in h?h.getPlatformIcon:l(st))(o),"text-sm"])},null,2)],8,xt))),128))])):k("",!0)])):k("",!0)}}),bt=Object.assign(vt,{__name:"AdminMusicDataDisplay"}),_t={key:0,class:"space-y-4"},$t={class:"flex items-center justify-between mb-3"},kt={class:"text-sm font-medium text-primary-4"},wt={class:"overflow-x-auto"},Ct={class:"w-full border-collapse text-sm"},Tt={class:"p-2"},St=["onUpdate:modelValue","placeholder"],At={class:"p-2 text-center"},Dt={class:"p-2"},Et=["onUpdate:modelValue","placeholder"],Mt={class:"p-2"},Pt={class:"flex items-center gap-2"},Lt={class:"w-12 h-2 bg-primary-1 rounded-full overflow-hidden"},Vt={class:"text-xs text-primary-3 font-mono"},Rt={class:"p-2"},Ft={key:0,class:"text-xs text-primary-3 text-center"},zt={key:1,class:"mt-3 p-2 bg-red-500/10 border border-red-500/20 rounded text-xs text-red-400 text-center"},Ot=U({__name:"AdminSearchForm",props:{parsedTitles:{default:void 0},videoId:{}},emits:["searchComplete","searchError","cancel"],setup(c,{emit:h}){const u=c,s=h,o=b(null),d=b(null),w=b([]);W(()=>{u.parsedTitles&&(w.value=u.parsedTitles.map(x=>({artist:x.artist,title:x.title})))});const _=async x=>{o.value=x;const p=w.value[x];if(!p||!p.artist||!p.title){d.value="Artist and title are required",o.value=null;return}try{const $=await $fetch("/api/metadata/musicbrainz-search",{method:"POST",body:{artist:p.artist,title:p.title}});$.success&&$.results?.length>0?(d.value=null,s("searchComplete",$.results)):(d.value="No search results found",s("searchError","No search results found"))}catch($){const F=$ instanceof Error?$.message:"Unknown error occurred";d.value=`Search failed: ${F}`,s("searchError",`Search failed: ${F}`)}finally{o.value=null}},v=()=>{d.value=null,s("cancel")},S=x=>{const p=w.value[x];if(p){const $=p.artist;p.artist=p.title,p.title=$}};return(x,p)=>{const $=N;return c.parsedTitles?.length?(n(),r("div",_t,[t("div",$t,[t("h4",kt," Parsed Titles ("+f(c.parsedTitles.length)+" found) ",1),T($,{size:"small",variant:"ghost",class:"text-xs",onClick:v},{default:C(()=>[...p[2]||(p[2]=[y(" Cancel ",-1)])]),_:1})]),t("div",wt,[t("table",Ct,[p[8]||(p[8]=t("thead",null,[t("tr",{class:"border-b border-primary-2/50"},[t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Artist "),t("th",{class:"text-center p-2 font-medium text-primary-4 text-xs w-12"}),t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Title "),t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Confidence "),t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Action ")])],-1)),t("tbody",null,[(n(!0),r(R,null,z(c.parsedTitles,(F,P)=>(n(),r("tr",{key:P,class:"border-b border-primary-2/30 hover:bg-bg-gradient transition-colors"},[t("td",Tt,[Q(t("input",{"onUpdate:modelValue":L=>l(w)[P].artist=L,class:"w-full bg-transparent border border-primary-2/50 rounded px-2 py-1 text-primary-4 text-xs focus:border-accent focus:outline-none",placeholder:F.artist,"data-input":"",onKeydown:p[0]||(p[0]=I(()=>{},["stop"]))},null,40,St),[[Y,l(w)[P].artist]])]),t("td",At,[T($,{size:"small",variant:"ghost",class:"!p-1 !min-w-0 hover:bg-accent/20",title:"Swap artist and title",onClick:L=>S(P)},{default:C(()=>[...p[3]||(p[3]=[t("div",{class:"i-mdi-swap-horizontal text-xs"},null,-1)])]),_:1},8,["onClick"])]),t("td",Dt,[Q(t("input",{"onUpdate:modelValue":L=>l(w)[P].title=L,class:"w-full bg-transparent border border-primary-2/50 rounded px-2 py-1 text-primary-3 text-xs focus:border-accent focus:outline-none",placeholder:F.title,"data-input":"",onKeydown:p[1]||(p[1]=I(()=>{},["stop"]))},null,40,Et),[[Y,l(w)[P].title]])]),t("td",Mt,[t("div",Pt,[t("div",Lt,[t("div",{class:"h-full bg-accent rounded-full transition-all",style:lt({width:`${F.confidence*100}%`})},null,4)]),t("span",Vt,f(Math.round(F.confidence*100))+"% ",1)])]),t("td",Rt,[T($,{size:"small",variant:"primary",disabled:l(o)===P,class:"text-xs",onClick:L=>_(P)},{default:C(()=>[l(o)===P?(n(),r(R,{key:0},[p[4]||(p[4]=t("div",{class:"i-mdi-loading animate-spin mr-1"},null,-1)),p[5]||(p[5]=y(" Searching... ",-1))],64)):(n(),r(R,{key:1},[p[6]||(p[6]=t("div",{class:"i-mdi-magnify mr-1"},null,-1)),p[7]||(p[7]=y(" Search ",-1))],64))]),_:2},1032,["disabled","onClick"])])]))),128))])])]),l(o)!==null?(n(),r("div",Ft,' Searching MusicBrainz for "'+f(c.parsedTitles[l(o)]?.artist)+" - "+f(c.parsedTitles[l(o)]?.title)+'"... ',1)):k("",!0),l(d)?(n(),r("div",zt,f(l(d)),1)):k("",!0)])):k("",!0)}}}),Bt=Object.assign(Ot,{__name:"AdminSearchForm"}),Ut={key:0,class:"space-y-2"},jt=["onClick"],Nt={class:"text-xs font-medium text-primary-4 line-clamp-1"},Ht={class:"text-xs text-primary-3 line-clamp-1"},It={class:"flex justify-between items-center mt-1"},Kt={class:"text-xs text-primary-3"},Qt={class:"text-xs text-accent"},Yt=U({__name:"AdminSearchResultsSelection",props:{videoId:{},searchResults:{default:void 0}},emits:["matchComplete","matchError","cancel"],setup(c,{emit:h}){const u=c,s=h,o=b(!1),d=async _=>{o.value=!0;try{const v=await $fetch("/api/metadata/musicbrainz",{method:"POST",body:{videoId:u.videoId,mbid:_}});v.success&&v.data?s("matchComplete",v.data):s("matchError","Failed to match recording")}catch(v){const S=v instanceof Error?v.message:"Unknown error occurred";s("matchError",`Error matching recording: ${S}`)}finally{o.value=!1}},w=()=>{s("cancel")};return(_,v)=>{const S=N;return c.searchResults?.length?(n(),r("div",Ut,[v[2]||(v[2]=t("div",{class:"text-xs font-medium text-primary-4 mb-2"}," Select best match: ",-1)),(n(!0),r(R,null,z(c.searchResults.slice(0,3),x=>(n(),r("div",{key:x.id,class:J(["bg-primary-2 p-2 rounded cursor-pointer hover:bg-primary-3/20 transition-colors",{"opacity-50 pointer-events-none":l(o)}]),onClick:p=>d(x.id)},[t("div",Nt,f(x.title),1),t("div",Ht," by "+f(x.artist),1),t("div",It,[t("span",Kt,f(x.releaseCount)+" release"+f(x.releaseCount!==1?"s":""),1),t("span",Qt,f(x.score)+"%",1)])],10,jt))),128)),l(o)?(n(),O(S,{key:0,size:"small",variant:"ghost",disabled:"",class:"text-xs"},{default:C(()=>[...v[0]||(v[0]=[y(" Matching... ",-1)])]),_:1})):(n(),O(S,{key:1,size:"small",variant:"ghost",class:"text-xs",onClick:w},{default:C(()=>[...v[1]||(v[1]=[y(" Cancel ",-1)])]),_:1}))])):k("",!0)}}}),qt=Object.assign(Yt,{__name:"AdminSearchResultsSelection"});function M(c){return c.replace(/\s*\((Original\s+Mix|Radio\s+Edit|Extended\s+Mix|Club\s+Mix|Remix|Remaster|Remastered|Version)\)\s*/gi,"").replace(/\s*[-â€“~|:]\s*$/,"").replace(/^\s*[-â€“~|:]\s*/,"").replace(/\s*[()\[\]{}]\s*$/,"").replace(/^\s*[()\[\]{}]\s*/,"").replace(/\s*[,;.!?]\s*$/,"").replace(/\s*[-â€“~|:]\s*[-â€“~|:]\s*/g," - ").replace(/\s+/g," ").trim()}function Jt(c){const h=[],u=Wt(c);let s=u.match(/^(.+?)\s*[-â€“]\s*([^-â€“]+?)(?:\s*[-â€“].*)?$/);if(s&&s[1]&&s[2]){const[,o,d]=s;h.push({artist:M(o),title:M(d),confidence:.9})}if(s=u.match(/^(.+?)\s*~\s*(.+?)(?:\s*~.*)?$/),s&&s[1]&&s[2]){const[,o,d]=s;h.push({artist:M(o),title:M(d),confidence:.85})}if(s=u.match(/^([^-]+?)\s*-\s*([^-]+?)(?:\s*-.*)?$/),s&&s[1]&&s[2]){const[,o,d]=s,w=["live","version","remix","cover","acoustic","instrumental","edit","remaster","demo","alternate","extended","radio","single"],_=["feat","ft","featuring","vs","x","with","and","&"],v=w.some($=>o.toLowerCase().includes($)),S=_.some($=>d.toLowerCase().includes($)),x=d.length<25&&d.split(" ").length<=3&&!/[()[\]]/.test(d);(v||x&&!S&&d.length<o.length*.7)&&h.push({artist:M(d),title:M(o),confidence:.75})}if(s=u.match(/^(.+?)\s*:\s*(.+)$/),s&&s[1]&&s[2]){const[,o,d]=s;h.push({artist:M(o),title:M(d),confidence:.8})}if(s=u.match(/^(.+?)\s*\|\s*([^|]+?)(?:\s*\|.*)?$/),s&&s[1]&&s[2]){const[,o,d]=s;h.push({artist:M(o),title:M(d),confidence:.8})}if(s=u.match(/^(.+?)\s*["'"](.+?)["'"].*$/),s&&s[1]&&s[2]){const[,o,d]=s;h.push({artist:M(o),title:M(d),confidence:.85})}if(s=u.match(/^(.+?)\s+([A-Z\s]{3,})(?:\s|$)/),s&&s[1]&&s[2]){const[,o,d]=s;d.trim().split(" ").length<=5&&h.push({artist:M(o),title:M(d),confidence:.7})}return h.length===0&&h.push({artist:"Unknown Artist",title:M(u||c),confidence:.1}),h.sort((o,d)=>d.confidence-o.confidence)}function Wt(c){return c.replace(/\s*\[Official Music Video\]/gi,"").replace(/\s*\[4K Remaster\]/gi,"").replace(/\s*\[(Official|Music|Video|Audio|Lyric|Live|HD|4K|HQ|MV)\s?(Video|Audio|Music|Performance|MV)?\]/gi,"").replace(/\s*\((Official|Music|Video|Audio|Lyric|Live|HD|4K|HQ|MV)\s?(Video|Audio|Music|Performance|MV)?\)/gi,"").replace(/\s*\(\d{4}\)/g,"").replace(/\s*\/\d{4}\/\s*/g,"").replace(/\s*\((Stereo|Mono|Remastered?|Remaster|\d{4}\s*Remaster(ed)?)\)/gi,"").replace(/\s*\[(Stereo|Mono|Remastered?|Remaster|\d{4}\s*Remaster(ed)?)\]/gi,"").replace(/\s*\b(HD|4K|1080p|720p|HQ|High Quality)\b/gi,"").replace(/\s*[fF]t\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*[Ff]eat\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*[Ff]eaturing\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*\([^)]*\)/g,"").replace(/\s+/g," ").trim()}function Xt(c){return M(c.replace(/\s*(Official|Music|VEVO|Records|Entertainment)$/gi,"").replace(/\s*-.*$/,"").trim())}const Zt={class:"rounded-lg shadow-sm"},Gt={class:"flex items-center justify-between mb-4"},te={class:"text-lg font-semibold flex items-center gap-2"},ee={key:0,class:"text-center py-8"},se={key:1,class:"overflow-x-auto"},le={class:"w-full border-collapse"},ae={class:"border-b border-primary-2/30 hover:bg-bg-gradient transition-colors"},ie={class:"p-3"},ne={class:"flex items-center gap-3"},oe={class:"flex-shrink-0"},re=["src","alt"],de={class:"flex-1 min-w-0"},ce={class:"font-medium text-primary-4 line-clamp-2 text-sm"},ue=["href"],me={class:"p-3"},ge={class:"text-sm text-primary-3"},pe={class:"p-3"},fe={class:"text-sm text-primary-3 font-mono"},he={class:"p-3"},ye={class:"min-w-48"},xe={key:0,class:"text-xs text-primary-3"},ve={class:"p-3"},be={class:"flex flex-wrap items-center gap-2"},_e={key:0,class:"border-b border-primary-2/30"},$e={colspan:"5",class:"p-3 space-y-4"},ke=U({__name:"AdminVideoList",props:{videos:{default:()=>[]}},setup(c){const h=c,u=b({}),s=b({}),o=b({}),d=b({}),w=async()=>{if(h.videos.length!==0)try{const a=await $fetch("/api/metadata/all",{method:"POST"}),e=h.videos.map(m=>m.id),A={};for(const m of e)a[m]&&(A[m]=a[m]);u.value={...u.value,...A}}catch(a){console.warn("Failed to load existing song data:",a)}};W(async()=>{await w()});const _=(a,e)=>{u.value[a]=e,delete s.value[a],delete o.value[a]},v=a=>{console.error("Match error:",a)},S=(a,e)=>{s.value[a]=e},x=a=>{console.error("Search error:",a)},p=a=>{delete s.value[a],delete o.value[a]},$=a=>{const e=Jt(a.title);if(e.length===0||e.length===1&&e[0]&&e[0].confidence<=.1){const m={artist:Xt(a.channel)||"Unknown Artist",title:a.title,confidence:.2};e.length===0?e.push(m):e[0]=m}o.value[a.id]=e},F=a=>{delete o.value[a]},P=a=>{delete u.value[a],delete s.value[a],delete o.value[a]},L=async a=>{try{d.value[a]=!0;const e=await $fetch("/api/musicbrainz/artist-tags",{method:"POST",body:{youtubeId:a}});e.success&&e.data&&(u.value[a]=e.data)}catch(e){console.error("Error fetching artist tags:",e)}finally{delete d.value[a]}},j=async a=>{try{d.value[a]=!0;const e=await $fetch("/api/metadata/odesli",{method:"POST",body:{youtubeId:a}});u.value[a]=e}catch(e){console.error("Error augmenting with Odesli:",e)}finally{delete d.value[a]}},B=async a=>{try{d.value[a]=!0;const e=u.value[a];if(!e?.artist||!e?.title){console.error("Cannot augment with Last.fm: missing artist or title");return}const A=await $fetch("/api/metadata/lastfm",{method:"POST",body:{youtubeId:a,artist:e.artist,title:e.title}});u.value[a]=A}catch(e){console.error("Error augmenting with Last.fm:",e)}finally{delete d.value[a]}};return(a,e)=>{const A=bt,m=N,i=Bt,D=qt;return n(),r("div",Zt,[t("div",Gt,[t("h3",te,[e[2]||(e[2]=t("div",{class:"i-mdi-playlist-music"},null,-1)),y(" Video List ("+f(c.videos.length)+" videos) ",1)])]),c.videos.length?(n(),r("div",se,[t("table",le,[e[7]||(e[7]=t("thead",null,[t("tr",{class:"border-b border-primary-2"},[t("th",{class:"text-left p-3 font-medium text-primary-4"},"Video"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Channel"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Duration"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Music Data"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Actions")])],-1)),t("tbody",null,[(n(!0),r(R,null,z(c.videos,g=>(n(),r(R,{key:g.id},[t("tr",ae,[t("td",ie,[t("div",ne,[t("div",oe,[t("img",{src:`https://i.ytimg.com/vi/${g.id}/hqdefault.jpg`,alt:g.title,class:"w-12 h-12 rounded-full object-cover bg-primary-1"},null,8,re)]),t("div",de,[t("h4",ce,f(g.title),1),t("a",{href:`https://www.youtube.com/watch?v=${g.id}`,target:"_blank",rel:"noopener noreferrer",class:"text-xs text-primary-3 hover:text-accent transition-colors"}," Watch on YouTube ",8,ue)])])]),t("td",me,[t("span",ge,f(g.channel),1)]),t("td",pe,[t("span",fe,f(g.duration),1)]),t("td",he,[t("div",ye,[T(A,{"song-data":l(u)[g.id]},null,8,["song-data"]),!l(u)[g.id]&&!l(s)[g.id]?.length&&!l(o)[g.id]?.length?(n(),r("div",xe)):k("",!0)])]),t("td",ve,[t("div",be,[!l(u)[g.id]&&!l(o)[g.id]?.length?(n(),O(m,{key:0,icon:"i-mdi-text-search",size:"small",variant:"ghost",onClick:E=>$(g)},{default:C(()=>[...e[4]||(e[4]=[y(" Search ",-1)])]),_:1},8,["onClick"])):k("",!0),l(u)[g.id]&&!l(u)[g.id]?.artistTags?.length&&!l(u)[g.id]?.tags?.length?(n(),O(m,{key:1,icon:"i-mdi-tag-plus",size:"small",variant:"ghost",disabled:l(d)[g.id],onClick:E=>L(g.id)},{default:C(()=>[...e[5]||(e[5]=[y(" Add Artist Tags ",-1)])]),_:1},8,["disabled","onClick"])):k("",!0),T(m,{icon:"i-mdi-cloud-sync",size:"small",variant:"ghost",disabled:l(d)[g.id],onClick:E=>j(g.id)},{default:C(()=>[y(f(l(d)[g.id]?"Augmenting...":"Odesli"),1)]),_:2},1032,["disabled","onClick"]),T(m,{icon:"i-mdi-database-search",size:"small",variant:"ghost",disabled:l(d)[g.id]||!l(u)[g.id]?.artist||!l(u)[g.id]?.title,onClick:E=>B(g.id)},{default:C(()=>[y(f(l(d)[g.id]?"Augmenting...":"Last.fm"),1)]),_:2},1032,["disabled","onClick"]),l(u)[g.id]?(n(),O(m,{key:2,icon:"i-mdi-delete",size:"small",variant:"ghost",onClick:E=>P(g.id)},{default:C(()=>[...e[6]||(e[6]=[y(" Clear ",-1)])]),_:1},8,["onClick"])):k("",!0)])])]),l(o)[g.id]?.length||l(s)[g.id]?.length?(n(),r("tr",_e,[t("td",$e,[l(o)[g.id]?.length?(n(),O(i,{key:0,"video-id":g.id,"parsed-titles":l(o)[g.id],onSearchComplete:E=>S(g.id,E),onSearchError:e[0]||(e[0]=E=>x(E)),onCancel:E=>F(g.id)},null,8,["video-id","parsed-titles","onSearchComplete","onCancel"])):k("",!0),l(s)[g.id]?.length?(n(),O(D,{key:1,"video-id":g.id,"search-results":l(s)[g.id],onMatchComplete:E=>_(g.id,E),onMatchError:e[1]||(e[1]=E=>v(E)),onCancel:E=>p(g.id)},null,8,["video-id","search-results","onMatchComplete","onCancel"])):k("",!0)])])):k("",!0)],64))),128))])])])):(n(),r("div",ee,[...e[3]||(e[3]=[t("div",{class:"i-mdi-video-outline text-4xl mb-2"},null,-1),t("p",{class:""},"No videos found in this playlist.",-1)])]))])}}}),we=Object.assign(ke,{__name:"AdminVideoList"}),Ce={class:"rounded-lg shadow-sm"},Te={class:"flex items-center justify-between mb-4"},Se={key:0,class:"text-center py-8"},Ae={key:1,class:"rounded-lg p-4 mb-6 bg-red-900/20 border border-red-500/30"},De={class:"flex items-center gap-2 text-red-400"},Ee={key:2,class:"space-y-6"},Me={key:0,class:"rounded-lg p-4 bg-green-900/20 border border-green-500/30"},Pe={class:"flex items-center gap-2 text-green-400"},Le={class:"flex gap-4 text-sm"},Ve={class:"flex items-center gap-2"},Re={class:"flex items-center gap-2"},Fe={class:"mb-4"},ze={class:"text-lg font-medium mb-3 flex items-center gap-2"},Oe={key:0,class:"text-center py-8"},Be={key:1,class:"flex flex-wrap gap-2 max-h-96 overflow-y-auto p-4 bg-primary-1 rounded-lg"},Ue=["onClick"],je={class:"text-lg font-medium mb-3 flex items-center gap-2"},Ne={key:0,class:"text-center py-8"},He={class:""},Ie={key:1,class:"flex flex-wrap gap-2 max-h-96 overflow-y-auto p-4 bg-red-900/10 rounded-lg border border-red-500/20"},Ke=["onClick"],Qe={class:"flex items-center gap-3 pt-4 border-t border-primary-2"},Ye=U({__name:"AdminTagBlacklist",setup(c){const h=b(!0),u=b(!1),s=b(""),o=b(""),d=b(""),w=b([]),_=b([]),v=b([]),S=H(()=>{const a=d.value.toLowerCase().trim(),e=w.value.filter(A=>!_.value.includes(A));return a?e.filter(A=>A.toLowerCase().includes(a)):e}),x=H(()=>{const a=d.value.toLowerCase().trim();return a?_.value.filter(e=>e.toLowerCase().includes(a)):_.value}),p=H(()=>{const a=[..._.value].sort(),e=[...v.value].sort();return JSON.stringify(a)!==JSON.stringify(e)}),$=async()=>{try{h.value=!0,s.value="",o.value="";const a=await $fetch("/api/playlists/tags");if(a.success)w.value=a.data.availableTags,_.value=[...a.data.blacklistedTags],v.value=[...a.data.blacklistedTags];else throw new Error("Failed to load tags")}catch(a){console.error("Error loading tags:",a),s.value=a.message||"Failed to load tags"}finally{h.value=!1}},F=a=>{_.value.includes(a)||(_.value.push(a),_.value.sort()),B()},P=a=>{const e=_.value.indexOf(a);e>-1&&_.value.splice(e,1),B()},L=async()=>{try{u.value=!0,s.value="",o.value="";const a=await $fetch("/api/playlists/tags",{method:"POST",body:{blacklistedTags:_.value}});if(a.success)v.value=[..._.value],o.value=a.message;else throw new Error("Failed to save blacklist")}catch(a){console.error("Error saving blacklist:",a),s.value=a.data?.message||a.message||"Failed to save blacklist"}finally{u.value=!1}},j=()=>{_.value=[...v.value],B()},B=()=>{s.value="",o.value=""};return X(async()=>{await $()}),(a,e)=>{const A=N,m=q;return n(),r("div",Ce,[t("div",Te,[e[2]||(e[2]=t("h2",{class:"text-xl font-semibold flex items-center gap-2"},[t("div",{class:"i-mdi-tag-multiple"}),y(" Tag Blacklist Management ")],-1)),T(A,{icon:"i-mdi-refresh",size:"small",loading:l(h),onClick:$},{default:C(()=>[...e[1]||(e[1]=[y(" Refresh ",-1)])]),_:1},8,["loading"])]),l(h)?(n(),r("div",Se,[...e[3]||(e[3]=[t("div",{class:"i-mdi-loading animate-spin text-2xl mb-2"},null,-1),t("p",{class:""},"Loading tags...",-1)])])):l(s)?(n(),r("div",Ae,[t("div",De,[e[4]||(e[4]=t("div",{class:"i-mdi-alert-circle"},null,-1)),e[5]||(e[5]=t("strong",null,"Error:",-1)),y(" "+f(l(s)),1)])])):(n(),r("div",Ee,[l(o)?(n(),r("div",Me,[t("div",Pe,[e[6]||(e[6]=t("div",{class:"i-mdi-check-circle"},null,-1)),e[7]||(e[7]=t("strong",null,"Success:",-1)),y(" "+f(l(o)),1)])])):k("",!0),t("div",Le,[t("div",Ve,[e[8]||(e[8]=t("div",{class:"i-mdi-tag text-primary-3"},null,-1)),t("span",null,f(l(w).length)+" total tags",1)]),t("div",Re,[e[9]||(e[9]=t("div",{class:"i-mdi-block-helper text-red-400"},null,-1)),t("span",null,f(l(_).length)+" blacklisted",1)])]),t("div",Fe,[T(m,{id:"tagFilter",modelValue:l(d),"onUpdate:modelValue":e[0]||(e[0]=i=>Z(d)?d.value=i:null),label:"Filter tags",placeholder:"Search tags...",icon:"i-mdi-magnify",class:"max-w-md"},null,8,["modelValue"])]),t("div",null,[t("h3",ze,[e[10]||(e[10]=t("div",{class:"i-mdi-tag-outline"},null,-1)),y(" Available Tags ("+f(l(S).length)+") ",1)]),l(S).length===0?(n(),r("div",Oe,[...e[11]||(e[11]=[t("div",{class:"i-mdi-tag-off text-4xl mb-2"},null,-1),t("p",{class:""},"No tags found matching your filter.",-1)])])):(n(),r("div",Be,[(n(!0),r(R,null,z(l(S),i=>(n(),r("button",{key:i,class:"inline-flex items-center gap-1 px-3 py-1 text-sm rounded-full transition-colors bg-primary-2 text-primary-4 hover:bg-red-600 hover:text-white border border-primary-3",onClick:D=>F(i)},[y(f(i)+" ",1),e[12]||(e[12]=t("div",{class:"i-mdi-plus text-xs"},null,-1))],8,Ue))),128))]))]),t("div",null,[t("h3",je,[e[13]||(e[13]=t("div",{class:"i-mdi-block-helper text-red-400"},null,-1)),y(" Blacklisted Tags ("+f(l(x).length)+") ",1)]),l(x).length===0?(n(),r("div",Ne,[e[14]||(e[14]=t("div",{class:"i-mdi-tag-check text-4xl mb-2"},null,-1)),t("p",He," No blacklisted tags"+f(l(d)?" matching your filter":"")+". ",1)])):(n(),r("div",Ie,[(n(!0),r(R,null,z(l(x),i=>(n(),r("button",{key:i,class:"inline-flex items-center gap-1 px-3 py-1 text-sm rounded-full transition-colors bg-red-600 text-white hover:bg-green-600 border border-red-500",onClick:D=>P(i)},[y(f(i)+" ",1),e[15]||(e[15]=t("div",{class:"i-mdi-close text-xs"},null,-1))],8,Ke))),128))]))]),t("div",Qe,[T(A,{icon:"i-mdi-content-save",loading:l(u),disabled:!l(p),onClick:L},{default:C(()=>[...e[16]||(e[16]=[y(" Save Changes ",-1)])]),_:1},8,["loading","disabled"]),T(A,{icon:"i-mdi-undo",variant:"ghost",disabled:!l(p),onClick:j},{default:C(()=>[...e[17]||(e[17]=[y(" Reset Changes ",-1)])]),_:1},8,["disabled"])])]))])}}}),qe=Object.assign(Ye,{__name:"AdminTagBlacklist"}),Je={class:"p-8 max-w-6xl mx-auto"},We={class:"flex items-center justify-between mb-8"},Xe={class:"flex gap-3"},Ze={class:"flex flex-col gap-6"},Ge={class:"rounded-lg mb-8 shadow-sm"},ts={key:0,class:"rounded-lg p-4 mb-8"},es={class:"flex items-center gap-2"},ss={key:1,class:"rounded-lg p-4 mb-8"},ls={class:"flex items-center gap-2"},as={class:"rounded-lg shadow-sm"},is={class:"flex items-center justify-between mb-4"},ns={key:0,class:"text-center py-8"},os={key:1,class:"text-center py-8"},rs={key:2,class:"space-y-4"},ds={class:"flex-1"},cs={class:"font-medium text-primary-3"},us={class:"text-sm"},ms={key:0,class:"text-xs mt-1 line-clamp-2"},gs={class:"flex items-center gap-2 ml-4"},ps={key:2,class:"rounded-lg shadow-sm"},fs={class:"flex items-center justify-between mb-4"},hs={class:"text-xl font-semibold flex items-center gap-2"},ys={key:0,class:"text-center py-8"},xs={key:2,class:"text-center py-8"},ws=U({__name:"admin",setup(c){at({title:"Admin Panel - Music Playlist View",meta:[{name:"description",content:"Manage your YouTube playlists"}]});const h=b(""),u=b(!1),s=b(""),o=b(""),d=b([]),w=b(!0),_=b(null),v=b(null),S=b(null),x=b(null),p=b([]),$=b(!1);X(async()=>{await L()});const F=m=>{const i=m.trim(),D=i.match(/[?&]list=([a-zA-Z0-9_-]+)/);return D&&D[1]?D[1]:i},P=async()=>{if(h.value.trim()){u.value=!0,s.value="",o.value="";try{const m=F(h.value);if(!m)throw new Error("Invalid playlist ID or URL");const i=await $fetch(`/api/playlists/${m}`);if(i.success)o.value=`Successfully loaded playlist: ${i.data.title}`,h.value="",await L();else throw new Error("Failed to fetch playlist")}catch(m){console.error("Error fetching playlist:",m),s.value=m.data?.message||m.message||"Failed to fetch playlist. Please check the playlist ID and try again."}finally{u.value=!1}}},L=async()=>{try{w.value=!0;const m=await $fetch("/index.json");m.success&&(d.value=m.data)}catch(m){console.error("Error loading cached playlists:",m)}finally{w.value=!1}},j=async m=>{try{_.value=m;const i=await $fetch(`/api/playlists/${m}`);i.success&&(await L(),o.value=`Successfully updated playlist: ${i.data.title}`,s.value="")}catch(i){console.error("Error refreshing playlist:",i),s.value="Failed to refresh playlist",o.value=""}finally{_.value=null}},B=async m=>{if(confirm("Are you sure you want to delete this cached playlist?"))try{v.value=m,await $fetch(`/api/playlists/${m}`,{method:"DELETE"}),await L(),o.value="Successfully deleted cached playlist",s.value=""}catch(i){console.error("Error deleting playlist:",i),s.value="Failed to delete playlist",o.value=""}finally{v.value=null}},a=m=>new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),e=async m=>{try{S.value=m.id,$.value=!0;const i=await $fetch(`/playlist/${m.fileName}`);if(i)x.value=m,p.value=i.videos||[];else throw new Error("Failed to load playlist videos")}catch(i){console.error("Error loading playlist for editing:",i),s.value="Failed to load playlist videos",o.value=""}finally{S.value=null,$.value=!1}},A=()=>{x.value=null,p.value=[]};return(m,i)=>{const D=N,g=q,E=we,G=qe;return n(),r("div",Je,[t("div",We,[i[3]||(i[3]=t("h1",{class:"text-3xl font-bold flex items-center gap-3"},[t("div",{class:"i-mdi-cog"}),y(" Admin Panel ")],-1)),t("div",Xe,[T(D,{icon:"i-mdi-music-note-plus",variant:"secondary",to:"/curate"},{default:C(()=>[...i[1]||(i[1]=[y(" Curate Songs ",-1)])]),_:1}),T(D,{icon:"i-mdi-arrow-left",variant:"primary",to:"/"},{default:C(()=>[...i[2]||(i[2]=[y(" Back to Playlists ",-1)])]),_:1})])]),t("div",Ze,[t("div",Ge,[i[4]||(i[4]=t("h2",{class:"text-xl font-semibold mb-4 flex items-center gap-2"},[t("div",{class:"i-mdi-plus"}),y(" Add New Playlist ")],-1)),t("form",{class:"space-y-4",onSubmit:I(P,["prevent"])},[T(g,{id:"playlistId",modelValue:l(h),"onUpdate:modelValue":i[0]||(i[0]=V=>Z(h)?h.value=V:null),label:"YouTube Playlist ID or URL",placeholder:"Enter playlist ID (e.g., PLrAXtmRdnEQy8VVXvSgb5eKzwJJxd0FMz) or full URL",class:"max-w-xl","help-text":"You can paste either the playlist ID or the full YouTube playlist URL",disabled:l(u),required:""},null,8,["modelValue","disabled"]),T(D,{type:"submit",icon:"i-mdi-download",size:"medium",disabled:!l(h).trim(),loading:l(u),"show-text-while-loading":!0},{default:C(()=>[y(f(l(u)?"Loading...":"Load Playlist"),1)]),_:1},8,["disabled","loading"])],32)]),l(o)?(n(),r("div",ts,[t("div",es,[i[5]||(i[5]=t("div",{class:"i-mdi-check-circle"},null,-1)),i[6]||(i[6]=t("strong",null,"Success:",-1)),y(" "+f(l(o)),1)])])):k("",!0),l(s)?(n(),r("div",ss,[t("div",ls,[i[7]||(i[7]=t("div",{class:"i-mdi-alert-circle"},null,-1)),i[8]||(i[8]=t("strong",null,"Error:",-1)),y(" "+f(l(s)),1)])])):k("",!0),t("div",as,[t("div",is,[i[10]||(i[10]=t("h2",{class:"text-xl font-semibold flex items-center gap-2"},[t("div",{class:"i-mdi-playlist-play"}),y(" Cached Playlists ")],-1)),T(D,{icon:"i-mdi-refresh",size:"small",loading:l(w),onClick:L},{default:C(()=>[...i[9]||(i[9]=[y(" Refresh ",-1)])]),_:1},8,["loading"])]),l(w)?(n(),r("div",ns,[...i[11]||(i[11]=[t("div",{class:"i-mdi-loading animate-spin text-2xl mb-2"},null,-1),t("p",{class:""},"Loading cached playlists...",-1)])])):l(d).length?(n(),r("div",rs,[(n(!0),r(R,null,z(l(d),V=>(n(),r("div",{key:V.id,class:"flex items-center justify-between rounded-lg hover:bg-bg-gradient py-6"},[t("div",ds,[t("h3",cs,f(V.title),1),t("p",us,f(V.videoCount)+" videos â€¢ Last updated: "+f(a(V.lastFetched)),1),V.description?(n(),r("p",ms,f(V.description),1)):k("",!0)]),t("div",gs,[T(D,{icon:"i-mdi-pencil",size:"small",variant:"secondary",loading:l(S)===V.id,onClick:K=>e(V)},{default:C(()=>[...i[13]||(i[13]=[y(" Edit ",-1)])]),_:1},8,["loading","onClick"]),T(D,{icon:"i-mdi-refresh",size:"small",loading:l(_)===V.id,onClick:K=>j(V.id)},{default:C(()=>[...i[14]||(i[14]=[y(" Update ",-1)])]),_:1},8,["loading","onClick"]),T(D,{icon:"i-mdi-delete",size:"small",variant:"danger",loading:l(v)===V.id,onClick:K=>B(V.id)},{default:C(()=>[...i[15]||(i[15]=[y(" Delete ",-1)])]),_:1},8,["loading","onClick"])])]))),128))])):(n(),r("div",os,[...i[12]||(i[12]=[t("div",{class:"i-mdi-playlist-remove text-4xl mb-2"},null,-1),t("p",{class:""},"No cached playlists found.",-1)])]))]),l(x)?(n(),r("div",ps,[t("div",fs,[t("h2",hs,[i[16]||(i[16]=t("div",{class:"i-mdi-pencil"},null,-1)),y(" Editing: "+f(l(x).title),1)]),T(D,{icon:"i-mdi-close",size:"small",variant:"ghost",onClick:A},{default:C(()=>[...i[17]||(i[17]=[y(" Close ",-1)])]),_:1})]),l($)?(n(),r("div",ys,[...i[18]||(i[18]=[t("div",{class:"i-mdi-loading animate-spin text-2xl mb-2"},null,-1),t("p",{class:""},"Loading playlist videos...",-1)])])):l(p).length?(n(),O(E,{key:1,videos:l(p)},null,8,["videos"])):(n(),r("div",xs,[...i[19]||(i[19]=[t("div",{class:"i-mdi-video-off text-4xl mb-2"},null,-1),t("p",{class:""},"No videos found in this playlist.",-1)])]))])):k("",!0),T(G)])])}}});export{ws as default};
