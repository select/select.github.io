import{_ as N}from"./DsvBw2rw.js";import{_ as L}from"./DNDLGk8p.js";import{e as P,h,p as k,c as u,a as e,m as U,f as E,g as l,w as S,F,r as Y,o as d,d as c,b as f,n as C,D as O,u as R,q,t as _}from"./5CB9Sz-F.js";import{g as z}from"./BH_bQjJi.js";import"./rtDB2gST.js";const H={class:"space-y-4"},K={class:"flex items-center justify-between mb-4"},X={class:"flex items-center gap-3"},G={class:"flex-1 flex items-center gap-3"},J=["disabled","onClick"],Q=["disabled","onClick"],W={key:0,class:"i-mdi-loading animate-spin text-2xl"},Z={key:1,class:"i-mdi-check-circle text-2xl"},tt=P({__name:"CurationInterface",props:{song:{},musicTitle:{},channel:{}},emits:["cancel","success"],setup(V,{emit:b}){const s=V,i=b,o=h(!1),m=n=>{if(!n)return{artist:"",title:""};const a=n.split("_");return a.length>=2?{artist:decodeURIComponent(a[0]).trim(),title:decodeURIComponent(a[1]).trim()}:{artist:"",title:""}},y=[{key:"channel",label:"Channel Name",condition:()=>!!s.channel,getData:()=>({artist:s.channel?.replace(" - Topic","")||"",title:s.song.title})},{key:"youtube",label:"YouTube Title",condition:()=>!!(s.song.artist||s.song.title),getData:()=>s.song},{key:"youtube-metadata",label:"YouTube Metadata",condition:()=>!!(s.song.youtube?.title||s.song.youtube?.channel),getData:()=>({artist:s.song.youtube?.channel||"",title:s.song.youtube?.title||""})},{key:"youtube2",label:"YouTube2 Title",condition:()=>!0,getData:()=>({title:s.musicTitle,artist:s.channel})},{key:"ai",label:"AI Parsed",condition:()=>!!(s.song.ai?.artist||s.song.ai?.title),getData:()=>({artist:s.song.ai?.artist||"",title:s.song.ai?.title||""})},{key:"lastfm",label:"Last.fm Parsed",condition:()=>{const n=m(s.song.lastfm?.id);return!!(n.artist||n.title)},getData:()=>m(s.song.lastfm?.id)},{key:"musicbrainz",label:"MusicBrainz",condition:()=>!!s.song.musicbrainz?.trackMbid,getData:()=>({artist:s.song.artist||"",title:s.song.title})}],T=k(()=>y.filter(n=>n.condition()).map(n=>({key:n.key,label:n.label,data:O(n.getData())}))),w=n=>{const a=n.artist;n.artist=n.title,n.title=a},I=async(n,a)=>{if(!a.artist||!a.title){alert("Please fill in both artist and title");return}if(!o.value)try{o.value=!0,await $fetch("/api/metadata/curate",{method:"POST",body:{youtubeId:s.song.youtubeId,artist:a.artist,title:a.title}}),i("success",a.artist,a.title)}catch(v){console.error("Error curating song:",v),alert("Failed to curate song metadata"),o.value=!1}};return(n,a)=>{const v=N,p=L;return d(),u("div",H,[e("div",K,[a[2]||(a[2]=e("h3",{class:"text-xl font-semibold text-primary-4"}," Choose Artist & Title ",-1)),l(o)?E("",!0):(d(),U(v,{key:0,variant:"secondary",icon:"i-mdi-close",onClick:a[0]||(a[0]=t=>n.$emit("cancel"))},{default:S(()=>[...a[1]||(a[1]=[c(" Skip ",-1)])]),_:1}))]),(d(!0),u(F,null,Y(l(T),t=>(d(),u("div",{key:t.key,class:"bg-primary-1 rounded-lg pl-3"},[e("div",X,[e("div",G,[f(p,{modelValue:t.data.artist,"onUpdate:modelValue":r=>t.data.artist=r,placeholder:"Artist",size:"small",label:"Artist",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue"]),e("button",{disabled:l(o),class:C(["w-10 h-10 flex items-center justify-center rounded-full transition-all",l(o)?"text-primary-3 cursor-not-allowed":"text-primary-3 hover:text-primary-4 hover:bg-primary-2"]),title:"Swap artist and title",onClick:r=>w(t.data)},[...a[3]||(a[3]=[e("div",{class:"i-mdi-swap-horizontal text-xl"},null,-1)])],10,J),f(p,{modelValue:t.data.title,"onUpdate:modelValue":r=>t.data.title=r,placeholder:"Title",size:"small",label:"Title",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue"])]),e("button",{disabled:l(o),class:C(["w-12 h-12 flex items-center justify-center rounded-full transition-all",l(o)?"text-primary-3 cursor-not-allowed":"text-primary-3 hover:text-accent hover:bg-accent/10 hover:scale-110"]),title:"Save this option",onClick:r=>I(t.key,t.data)},[l(o)?(d(),u("div",W)):(d(),u("div",Z))],10,Q)])]))),128))])}}}),et=Object.assign(tt,{__name:"CurationInterface"}),st={class:"container mx-auto px-4 py-8 max-w-4xl"},at={class:"flex items-center justify-between mb-8"},it={key:0,class:"flex items-center justify-center py-12"},nt={key:1,class:"bg-primary-1 border border-error rounded-lg p-6"},lt={class:"flex items-center gap-2 text-error mb-4"},ot={key:2,class:"bg-primary-1 rounded-lg p-8 text-center"},rt={key:3,class:"space-y-6"},dt={class:"bg-bg-gradient rounded-lg p-6"},ut={class:"bg-primary-1 rounded-lg p-4"},ct={class:"flex items-center justify-between"},mt={class:"text-sm text-primary-3"},pt={class:"text-accent font-semibold"},gt={class:"bg-bg-gradient rounded-lg p-6"},ft={class:"mb-6 aspect-video rounded-lg overflow-hidden bg-black"},bt=["src"],yt={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},vt={class:"bg-primary-1 rounded-lg p-3 text-center"},xt={class:"bg-primary-1 rounded-lg p-3 text-center"},_t={class:"bg-primary-1 rounded-lg p-3 text-center"},Dt=P({__name:"curate",setup(V){R({title:"Curate Music Data - Music Playlist View",meta:[{name:"description",content:"Curate and improve music metadata"}]});const b=h(!0),s=h(""),i=h(null),o=h(""),m=z("curated-songs",[]),y=z("skipped-songs",[]),T=k(()=>m.value.length),w=k(()=>i.value?!!(i.value.odesli||i.value.musicbrainz?.externalIdsTrack||i.value.musicbrainz?.externalIdsArtist):!1),I=k(()=>i.value?!!(i.value.ai?.artist&&i.value.ai?.title):!1),n=k(()=>i.value?!!i.value.lastfm?.id:!1),a=async(p=!1)=>{try{p&&i.value?.youtubeId&&(y.value.includes(i.value.youtubeId)||y.value.push(i.value.youtubeId)),b.value=!0,s.value="";const r=(await $fetch("/playlist/PLHh-DPsAXiAUVUVA9DpRtiYRrwgvqg8Fx.json")).videos||[],D=await $fetch("/api/metadata/all",{method:"POST"}),$=r.filter(A=>{const x=D[A.id];if(m.value.includes(A.id)||y.value.includes(A.id)||x?.curated)return!1;const M=!!(x?.odesli||x?.musicbrainz?.externalIdsTrack||x?.musicbrainz?.externalIdsArtist),j=!!x?.lastfm?.id;return!M&&!j});if($.length===0){i.value=null;return}const g=$[Math.floor(Math.random()*$.length)],B=D[g.id];o.value=g.channel,i.value={youtubeId:g.id,title:g.title,musicTitle:g.musicTitle,artist:g.artist,lastFetched:new Date().toISOString(),...B}}catch(t){console.error("Error loading random song:",t),s.value="Failed to load songs for curation"}finally{b.value=!1}},v=(p,t)=>{i.value?.youtubeId&&(m.value.includes(i.value.youtubeId)||m.value.push(i.value.youtubeId)),console.log(`Successfully curated: ${p} - ${t}`),a()};return q(()=>{a()}),(p,t)=>{const r=N,D=et;return d(),u("div",st,[e("div",at,[t[2]||(t[2]=e("h1",{class:"text-3xl font-bold flex items-center gap-3"},[e("div",{class:"i-mdi-music-note-plus"}),c(" Curate Music Data ")],-1)),f(r,{icon:"i-mdi-arrow-left",variant:"primary",to:"/"},{default:S(()=>[...t[1]||(t[1]=[c(" Back to Playlists ",-1)])]),_:1})]),l(b)?(d(),u("div",it,[...t[3]||(t[3]=[e("div",{class:"flex items-center gap-3 text-primary-3"},[e("div",{class:"i-mdi-loading animate-spin text-2xl"}),e("span",null,"Loading random song...")],-1)])])):l(s)?(d(),u("div",nt,[e("div",lt,[t[4]||(t[4]=e("div",{class:"i-mdi-alert-circle"},null,-1)),t[5]||(t[5]=e("strong",null,"Error:",-1)),c(" "+_(l(s)),1)]),f(r,{variant:"primary",onClick:a},{default:S(()=>[...t[6]||(t[6]=[c(" Try Again ",-1)])]),_:1})])):l(i)?(d(),u("div",rt,[e("div",dt,[f(D,{song:l(i),channel:l(o),onCancel:t[0]||(t[0]=()=>a(!0)),onSuccess:v},null,8,["song","channel"])]),e("div",ut,[e("div",ct,[e("div",mt,[t[11]||(t[11]=c(" Songs curated this session: ",-1)),e("span",pt,_(l(T)),1)])])]),e("div",gt,[t[15]||(t[15]=e("h2",{class:"text-xl font-semibold mb-4 flex items-center gap-2"},[e("div",{class:"i-mdi-music"}),c(" Current Song ")],-1)),e("div",ft,[e("iframe",{src:`https://www.youtube.com/embed/${l(i).youtubeId}`,class:"w-full h-full",frameborder:"0",allow:`
							accelerometer;
							autoplay;
							clipboard-write;
							encrypted-media;
							gyroscope;
							picture-in-picture;
						`,allowfullscreen:""},null,8,bt)]),e("div",yt,[e("div",vt,[t[12]||(t[12]=e("div",{class:"text-xs text-primary-3 mb-1"},"External IDs",-1)),e("div",{class:C(["text-lg font-semibold",l(w)?"text-accent":"text-error"])},_(l(w)?"Yes":"No"),3)]),e("div",xt,[t[13]||(t[13]=e("div",{class:"text-xs text-primary-3 mb-1"},"AI Data",-1)),e("div",{class:C(["text-lg font-semibold",l(I)?"text-accent":"text-error"])},_(l(I)?"Yes":"No"),3)]),e("div",_t,[t[14]||(t[14]=e("div",{class:"text-xs text-primary-3 mb-1"},"Last.fm Data",-1)),e("div",{class:C(["text-lg font-semibold",l(n)?"text-accent":"text-error"])},_(l(n)?"Yes":"No"),3)])])])])):(d(),u("div",ot,[t[8]||(t[8]=e("div",{class:"i-mdi-music-note-off text-6xl text-primary-3 mb-4"},null,-1)),t[9]||(t[9]=e("h2",{class:"text-xl font-semibold text-primary-4 mb-2"}," No Songs Need Curation ",-1)),t[10]||(t[10]=e("p",{class:"text-primary-3 mb-4"}," All songs in the playlist have been curated or have metadata! ",-1)),f(r,{variant:"primary",to:"/"},{default:S(()=>[...t[7]||(t[7]=[c(" Back to Playlists ",-1)])]),_:1})]))])}}});export{Dt as default};
