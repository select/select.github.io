import{g as X,a as Z,b as G,_ as j}from"./Cjlxa7Tx.js";import{_ as tt}from"./xt4bKdUw.js";import{e as U,c as d,f as b,o as n,a as t,t as f,F as V,r as F,g as i,n as Y,h as _,i as q,b as S,w,d as y,j as K,v as Q,k as H,l as et,m as z,u as st,p as at,q as lt}from"./CarEuZ8t.js";import"./y86ykaDD.js";const it={key:0,class:"p-2 rounded text-xs"},nt={class:"font-medium text-primary-4 line-clamp-1"},ot={class:"text-primary-3 line-clamp-1"},rt={key:0,class:"text-primary-3 line-clamp-1"},ct={key:1,class:"mt-1 flex gap-2 flex-wrap"},dt=["title"],ut=["title"],mt={key:2,class:"mt-2 flex gap-2 flex-wrap items-center"},pt=["href","title"],ht=U({__name:"AdminMusicDataDisplay",props:{songData:{default:void 0}},setup(u){return(h,p)=>u.songData?(n(),d("div",it,[t("div",nt,f(u.songData.title),1),t("div",ot,"by "+f(u.songData.artist),1),u.songData.album?(n(),d("div",rt,f(u.songData.album),1)):b("",!0),u.songData.tags?.length||u.songData.genres?.length||u.songData.artistTags?.length?(n(),d("div",ct,[(n(!0),d(V,null,F(u.songData.tags?.slice(0,3)||[],s=>(n(),d("span",{key:`song-${s}`,class:"inline-block bg-accent/20 text-black px-1 rounded text-xs mr-1"},f(s),1))),128)),(n(!0),d(V,null,F(u.songData.genres?.slice(0,3)||[],s=>(n(),d("span",{key:`genre-${s}`,class:"inline-block bg-primary-3/30 text-primary-4 px-1 rounded text-xs mr-1",title:`Genre: ${s}`},f(s),9,dt))),128)),(n(!0),d(V,null,F(u.songData.artistTags?.slice(0,2)||[],s=>(n(),d("span",{key:`artist-${s}`,class:"inline-block bg-primary-2/60 text-primary-4 px-1 rounded text-xs mr-1",title:`Artist tag: ${s}`},f(s),9,ut))),128))])):b("",!0),u.songData.odesli&&Object.keys(u.songData.odesli).length>0?(n(),d("div",mt,[p[0]||(p[0]=t("span",{class:"text-xs text-primary-3 mr-1"},"Listen on:",-1)),(n(!0),d(V,null,F(u.songData.odesli,(s,l)=>(n(),d("a",{key:l,href:("getPlatformUrl"in h?h.getPlatformUrl:i(Z))(l,s),target:"_blank",rel:"noopener noreferrer",class:"text-primary-3 hover:text-accent transition-colors",title:`Listen on ${("getPlatformName"in h?h.getPlatformName:i(X))(l)}`},[t("div",{class:Y([("getPlatformIcon"in h?h.getPlatformIcon:i(G))(l),"text-sm"])},null,2)],8,pt))),128))])):b("",!0)])):b("",!0)}}),ft=Object.assign(ht,{__name:"AdminMusicDataDisplay"}),gt={key:0,class:"space-y-4"},yt={class:"flex items-center justify-between mb-3"},xt={class:"text-sm font-medium text-primary-4"},vt={class:"overflow-x-auto"},_t={class:"w-full border-collapse text-sm"},bt={class:"p-2"},$t=["onUpdate:modelValue","placeholder"],wt={class:"p-2 text-center"},kt={class:"p-2"},Ct=["onUpdate:modelValue","placeholder"],At={class:"p-2"},Dt={class:"flex items-center gap-2"},St={class:"w-12 h-2 bg-primary-1 rounded-full overflow-hidden"},Mt={class:"text-xs text-primary-3 font-mono"},Et={class:"p-2"},Pt={key:0,class:"text-xs text-primary-3 text-center"},Tt={key:1,class:"mt-3 p-2 bg-red-500/10 border border-red-500/20 rounded text-xs text-red-400 text-center"},Vt=U({__name:"AdminSearchForm",props:{parsedTitles:{default:void 0},videoId:{}},emits:["searchComplete","searchError","cancel"],setup(u,{emit:h}){const p=u,s=h,l=_(null),o=_(null),$=_([]);q(()=>{p.parsedTitles&&($.value=p.parsedTitles.map(g=>({artist:g.artist,title:g.title})))});const P=async g=>{l.value=g;const m=$.value[g];if(!m||!m.artist||!m.title){o.value="Artist and title are required",l.value=null;return}try{const v=await $fetch("/api/musicbrainz/search",{method:"POST",body:{artist:m.artist,title:m.title}});v.success&&v.results?.length>0?(o.value=null,s("searchComplete",v.results)):(o.value="No search results found",s("searchError","No search results found"))}catch(v){const M=v instanceof Error?v.message:"Unknown error occurred";o.value=`Search failed: ${M}`,s("searchError",`Search failed: ${M}`)}finally{l.value=null}},x=()=>{o.value=null,s("cancel")},D=g=>{const m=$.value[g];if(m){const v=m.artist;m.artist=m.title,m.title=v}};return(g,m)=>{const v=j;return u.parsedTitles?.length?(n(),d("div",gt,[t("div",yt,[t("h4",xt," Parsed Titles ("+f(u.parsedTitles.length)+" found) ",1),S(v,{size:"small",variant:"ghost",class:"text-xs",onClick:x},{default:w(()=>[...m[2]||(m[2]=[y(" Cancel ",-1)])]),_:1})]),t("div",vt,[t("table",_t,[m[8]||(m[8]=t("thead",null,[t("tr",{class:"border-b border-primary-2/50"},[t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Artist "),t("th",{class:"text-center p-2 font-medium text-primary-4 text-xs w-12"}),t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Title "),t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Confidence "),t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Action ")])],-1)),t("tbody",null,[(n(!0),d(V,null,F(u.parsedTitles,(M,E)=>(n(),d("tr",{key:E,class:"border-b border-primary-2/30 hover:bg-bg-gradient transition-colors"},[t("td",bt,[K(t("input",{"onUpdate:modelValue":R=>i($)[E].artist=R,class:"w-full bg-transparent border border-primary-2/50 rounded px-2 py-1 text-primary-4 text-xs focus:border-accent focus:outline-none",placeholder:M.artist,"data-input":"",onKeydown:m[0]||(m[0]=H(()=>{},["stop"]))},null,40,$t),[[Q,i($)[E].artist]])]),t("td",wt,[S(v,{size:"small",variant:"ghost",class:"!p-1 !min-w-0 hover:bg-accent/20",title:"Swap artist and title",onClick:R=>D(E)},{default:w(()=>[...m[3]||(m[3]=[t("div",{class:"i-mdi-swap-horizontal text-xs"},null,-1)])]),_:1},8,["onClick"])]),t("td",kt,[K(t("input",{"onUpdate:modelValue":R=>i($)[E].title=R,class:"w-full bg-transparent border border-primary-2/50 rounded px-2 py-1 text-primary-3 text-xs focus:border-accent focus:outline-none",placeholder:M.title,"data-input":"",onKeydown:m[1]||(m[1]=H(()=>{},["stop"]))},null,40,Ct),[[Q,i($)[E].title]])]),t("td",At,[t("div",Dt,[t("div",St,[t("div",{class:"h-full bg-accent rounded-full transition-all",style:et({width:`${M.confidence*100}%`})},null,4)]),t("span",Mt,f(Math.round(M.confidence*100))+"% ",1)])]),t("td",Et,[S(v,{size:"small",variant:"primary",disabled:i(l)===E,class:"text-xs",onClick:R=>P(E)},{default:w(()=>[i(l)===E?(n(),d(V,{key:0},[m[4]||(m[4]=t("div",{class:"i-mdi-loading animate-spin mr-1"},null,-1)),m[5]||(m[5]=y(" Searching... ",-1))],64)):(n(),d(V,{key:1},[m[6]||(m[6]=t("div",{class:"i-mdi-magnify mr-1"},null,-1)),m[7]||(m[7]=y(" Search ",-1))],64))]),_:2},1032,["disabled","onClick"])])]))),128))])])]),i(l)!==null?(n(),d("div",Pt,' Searching MusicBrainz for "'+f(u.parsedTitles[i(l)]?.artist)+" - "+f(u.parsedTitles[i(l)]?.title)+'"... ',1)):b("",!0),i(o)?(n(),d("div",Tt,f(i(o)),1)):b("",!0)])):b("",!0)}}}),Rt=Object.assign(Vt,{__name:"AdminSearchForm"}),Lt={key:0,class:"space-y-2"},zt=["onClick"],Ft={class:"text-xs font-medium text-primary-4 line-clamp-1"},Ot={class:"text-xs text-primary-3 line-clamp-1"},Ut={class:"flex justify-between items-center mt-1"},jt={class:"text-xs text-primary-3"},Nt={class:"text-xs text-accent"},It=U({__name:"AdminSearchResultsSelection",props:{videoId:{},searchResults:{default:void 0}},emits:["matchComplete","matchError","cancel"],setup(u,{emit:h}){const p=u,s=h,l=_(!1),o=async P=>{l.value=!0;try{const x=await $fetch("/api/musicbrainz/match",{method:"POST",body:{videoId:p.videoId,selectedMbid:P}});x.success&&x.data?s("matchComplete",x.data):s("matchError","Failed to match recording")}catch(x){const D=x instanceof Error?x.message:"Unknown error occurred";s("matchError",`Error matching recording: ${D}`)}finally{l.value=!1}},$=()=>{s("cancel")};return(P,x)=>{const D=j;return u.searchResults?.length?(n(),d("div",Lt,[x[2]||(x[2]=t("div",{class:"text-xs font-medium text-primary-4 mb-2"}," Select best match: ",-1)),(n(!0),d(V,null,F(u.searchResults.slice(0,3),g=>(n(),d("div",{key:g.id,class:Y(["bg-primary-2 p-2 rounded cursor-pointer hover:bg-primary-3/20 transition-colors",{"opacity-50 pointer-events-none":i(l)}]),onClick:m=>o(g.id)},[t("div",Ft,f(g.title),1),t("div",Ot," by "+f(g.artist),1),t("div",Ut,[t("span",jt,f(g.releaseCount)+" release"+f(g.releaseCount!==1?"s":""),1),t("span",Nt,f(g.score)+"%",1)])],10,zt))),128)),i(l)?(n(),z(D,{key:0,size:"small",variant:"ghost",disabled:"",class:"text-xs"},{default:w(()=>[...x[0]||(x[0]=[y(" Matching... ",-1)])]),_:1})):(n(),z(D,{key:1,size:"small",variant:"ghost",class:"text-xs",onClick:$},{default:w(()=>[...x[1]||(x[1]=[y(" Cancel ",-1)])]),_:1}))])):b("",!0)}}}),Bt=Object.assign(It,{__name:"AdminSearchResultsSelection"});function C(u){return u.replace(/\s*\((Original\s+Mix|Radio\s+Edit|Extended\s+Mix|Club\s+Mix|Remix|Remaster|Remastered|Version)\)\s*/gi,"").replace(/\s*[-–~|:]\s*$/,"").replace(/^\s*[-–~|:]\s*/,"").replace(/\s*[()\[\]{}]\s*$/,"").replace(/^\s*[()\[\]{}]\s*/,"").replace(/\s*[,;.!?]\s*$/,"").replace(/\s*[-–~|:]\s*[-–~|:]\s*/g," - ").replace(/\s+/g," ").trim()}function Ht(u){const h=[],p=Kt(u);let s=p.match(/^(.+?)\s*[-–]\s*([^-–]+?)(?:\s*[-–].*)?$/);if(s&&s[1]&&s[2]){const[,l,o]=s;h.push({artist:C(l),title:C(o),confidence:.9})}if(s=p.match(/^(.+?)\s*~\s*(.+?)(?:\s*~.*)?$/),s&&s[1]&&s[2]){const[,l,o]=s;h.push({artist:C(l),title:C(o),confidence:.85})}if(s=p.match(/^([^-]+?)\s*-\s*([^-]+?)(?:\s*-.*)?$/),s&&s[1]&&s[2]){const[,l,o]=s,$=["live","version","remix","cover","acoustic","instrumental","edit","remaster","demo","alternate","extended","radio","single"],P=["feat","ft","featuring","vs","x","with","and","&"],x=$.some(v=>l.toLowerCase().includes(v)),D=P.some(v=>o.toLowerCase().includes(v)),g=o.length<25&&o.split(" ").length<=3&&!/[()[\]]/.test(o);(x||g&&!D&&o.length<l.length*.7)&&h.push({artist:C(o),title:C(l),confidence:.75})}if(s=p.match(/^(.+?)\s*:\s*(.+)$/),s&&s[1]&&s[2]){const[,l,o]=s;h.push({artist:C(l),title:C(o),confidence:.8})}if(s=p.match(/^(.+?)\s*\|\s*([^|]+?)(?:\s*\|.*)?$/),s&&s[1]&&s[2]){const[,l,o]=s;h.push({artist:C(l),title:C(o),confidence:.8})}if(s=p.match(/^(.+?)\s*["'"](.+?)["'"].*$/),s&&s[1]&&s[2]){const[,l,o]=s;h.push({artist:C(l),title:C(o),confidence:.85})}if(s=p.match(/^(.+?)\s+([A-Z\s]{3,})(?:\s|$)/),s&&s[1]&&s[2]){const[,l,o]=s;o.trim().split(" ").length<=5&&h.push({artist:C(l),title:C(o),confidence:.7})}return h.length===0&&h.push({artist:"Unknown Artist",title:C(p||u),confidence:.1}),h.sort((l,o)=>o.confidence-l.confidence)}function Kt(u){return u.replace(/\s*\[Official Music Video\]/gi,"").replace(/\s*\[4K Remaster\]/gi,"").replace(/\s*\[(Official|Music|Video|Audio|Lyric|Live|HD|4K|HQ|MV)\s?(Video|Audio|Music|Performance|MV)?\]/gi,"").replace(/\s*\((Official|Music|Video|Audio|Lyric|Live|HD|4K|HQ|MV)\s?(Video|Audio|Music|Performance|MV)?\)/gi,"").replace(/\s*\(\d{4}\)/g,"").replace(/\s*\/\d{4}\/\s*/g,"").replace(/\s*\((Stereo|Mono|Remastered?|Remaster|\d{4}\s*Remaster(ed)?)\)/gi,"").replace(/\s*\[(Stereo|Mono|Remastered?|Remaster|\d{4}\s*Remaster(ed)?)\]/gi,"").replace(/\s*\b(HD|4K|1080p|720p|HQ|High Quality)\b/gi,"").replace(/\s*[fF]t\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*[Ff]eat\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*[Ff]eaturing\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*\([^)]*\)/g,"").replace(/\s+/g," ").trim()}function Qt(u){return C(u.replace(/\s*(Official|Music|VEVO|Records|Entertainment)$/gi,"").replace(/\s*-.*$/,"").trim())}const Yt={class:"rounded-lg shadow-sm"},qt={class:"flex items-center justify-between mb-4"},Jt={class:"text-lg font-semibold flex items-center gap-2"},Wt={key:0,class:"text-center py-8"},Xt={key:1,class:"overflow-x-auto"},Zt={class:"w-full border-collapse"},Gt={class:"border-b border-primary-2/30 hover:bg-bg-gradient transition-colors"},te={class:"p-3"},ee={class:"flex items-center gap-3"},se={class:"flex-shrink-0"},ae=["src","alt"],le={class:"flex-1 min-w-0"},ie={class:"font-medium text-primary-4 line-clamp-2 text-sm"},ne=["href"],oe={class:"p-3"},re={class:"text-sm text-primary-3"},ce={class:"p-3"},de={class:"text-sm text-primary-3 font-mono"},ue={class:"p-3"},me={class:"min-w-48"},pe={key:0,class:"text-xs text-primary-3"},he={class:"p-3"},fe={class:"flex flex-wrap items-center gap-2"},ge={key:0,class:"border-b border-primary-2/30"},ye={colspan:"5",class:"p-3 space-y-4"},xe=U({__name:"AdminVideoList",props:{videos:{default:()=>[]}},setup(u){const h=u,p=_({}),s=_({}),l=_({}),o=_({}),$=async()=>{if(h.videos.length!==0)try{const c=await $fetch("/api/metadata/all",{method:"POST"}),r=h.videos.map(A=>A.id),O={};for(const A of r)c[A]&&(O[A]=c[A]);p.value={...p.value,...O}}catch(c){console.warn("Failed to load existing song data:",c)}};q(async()=>{await $()});const P=(c,r)=>{p.value[c]=r,delete s.value[c],delete l.value[c]},x=c=>{console.error("Match error:",c)},D=(c,r)=>{s.value[c]=r},g=c=>{console.error("Search error:",c)},m=c=>{delete s.value[c],delete l.value[c]},v=c=>{const r=Ht(c.title);if(r.length===0||r.length===1&&r[0]&&r[0].confidence<=.1){const A={artist:Qt(c.channel)||"Unknown Artist",title:c.title,confidence:.2};r.length===0?r.push(A):r[0]=A}l.value[c.id]=r},M=c=>{delete l.value[c]},E=c=>{delete p.value[c],delete s.value[c],delete l.value[c]},R=async c=>{try{o.value[c]=!0;const r=await $fetch("/api/musicbrainz/artist-tags",{method:"POST",body:{youtubeId:c}});r.success&&r.data&&(p.value[c]=r.data)}catch(r){console.error("Error fetching artist tags:",r)}finally{delete o.value[c]}},L=async c=>{try{o.value[c]=!0;const r=await $fetch("/api/metadata/odesli-augment",{method:"POST",body:{youtubeId:c}});p.value[c]=r}catch(r){console.error("Error augmenting with Odesli:",r)}finally{delete o.value[c]}};return(c,r)=>{const O=ft,A=j,N=Rt,I=Bt;return n(),d("div",Yt,[t("div",qt,[t("h3",Jt,[r[2]||(r[2]=t("div",{class:"i-mdi-playlist-music"},null,-1)),y(" Video List ("+f(u.videos.length)+" videos) ",1)])]),u.videos.length?(n(),d("div",Xt,[t("table",Zt,[r[7]||(r[7]=t("thead",null,[t("tr",{class:"border-b border-primary-2"},[t("th",{class:"text-left p-3 font-medium text-primary-4"},"Video"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Channel"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Duration"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Music Data"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Actions")])],-1)),t("tbody",null,[(n(!0),d(V,null,F(u.videos,a=>(n(),d(V,{key:a.id},[t("tr",Gt,[t("td",te,[t("div",ee,[t("div",se,[t("img",{src:`https://i.ytimg.com/vi/${a.id}/hqdefault.jpg`,alt:a.title,class:"w-12 h-12 rounded-full object-cover bg-primary-1"},null,8,ae)]),t("div",le,[t("h4",ie,f(a.title),1),t("a",{href:`https://www.youtube.com/watch?v=${a.id}`,target:"_blank",rel:"noopener noreferrer",class:"text-xs text-primary-3 hover:text-accent transition-colors"}," Watch on YouTube ",8,ne)])])]),t("td",oe,[t("span",re,f(a.channel),1)]),t("td",ce,[t("span",de,f(a.duration),1)]),t("td",ue,[t("div",me,[S(O,{"song-data":i(p)[a.id]},null,8,["song-data"]),!i(p)[a.id]&&!i(s)[a.id]?.length&&!i(l)[a.id]?.length?(n(),d("div",pe)):b("",!0)])]),t("td",he,[t("div",fe,[!i(p)[a.id]&&!i(l)[a.id]?.length?(n(),z(A,{key:0,icon:"i-mdi-text-search",size:"small",variant:"ghost",onClick:e=>v(a)},{default:w(()=>[...r[4]||(r[4]=[y(" Search ",-1)])]),_:1},8,["onClick"])):b("",!0),i(p)[a.id]&&!i(p)[a.id]?.artistTags?.length&&!i(p)[a.id]?.tags?.length?(n(),z(A,{key:1,icon:"i-mdi-tag-plus",size:"small",variant:"ghost",disabled:i(o)[a.id],onClick:e=>R(a.id)},{default:w(()=>[...r[5]||(r[5]=[y(" Add Artist Tags ",-1)])]),_:1},8,["disabled","onClick"])):b("",!0),S(A,{icon:"i-mdi-cloud-sync",size:"small",variant:"ghost",disabled:i(o)[a.id],onClick:e=>L(a.id)},{default:w(()=>[y(f(i(o)[a.id]?"Augmenting...":"Augment"),1)]),_:2},1032,["disabled","onClick"]),i(p)[a.id]?(n(),z(A,{key:2,icon:"i-mdi-delete",size:"small",variant:"ghost",onClick:e=>E(a.id)},{default:w(()=>[...r[6]||(r[6]=[y(" Clear ",-1)])]),_:1},8,["onClick"])):b("",!0)])])]),i(l)[a.id]?.length||i(s)[a.id]?.length?(n(),d("tr",ge,[t("td",ye,[i(l)[a.id]?.length?(n(),z(N,{key:0,"video-id":a.id,"parsed-titles":i(l)[a.id],onSearchComplete:e=>D(a.id,e),onSearchError:r[0]||(r[0]=e=>g(e)),onCancel:e=>M(a.id)},null,8,["video-id","parsed-titles","onSearchComplete","onCancel"])):b("",!0),i(s)[a.id]?.length?(n(),z(I,{key:1,"video-id":a.id,"search-results":i(s)[a.id],onMatchComplete:e=>P(a.id,e),onMatchError:r[1]||(r[1]=e=>x(e)),onCancel:e=>m(a.id)},null,8,["video-id","search-results","onMatchComplete","onCancel"])):b("",!0)])])):b("",!0)],64))),128))])])])):(n(),d("div",Wt,[...r[3]||(r[3]=[t("div",{class:"i-mdi-video-outline text-4xl mb-2"},null,-1),t("p",{class:""},"No videos found in this playlist.",-1)])]))])}}}),ve=Object.assign(xe,{__name:"AdminVideoList"}),_e={class:"p-8 max-w-6xl mx-auto"},be={class:"flex items-center justify-between mb-8"},$e={class:"flex flex-col gap-6"},we={class:"rounded-lg mb-8 shadow-sm"},ke={key:0,class:"rounded-lg p-4 mb-8"},Ce={class:"flex items-center gap-2"},Ae={key:1,class:"rounded-lg p-4 mb-8"},De={class:"flex items-center gap-2"},Se={class:"rounded-lg shadow-sm"},Me={class:"flex items-center justify-between mb-4"},Ee={key:0,class:"text-center py-8"},Pe={key:1,class:"text-center py-8"},Te={key:2,class:"space-y-4"},Ve={class:"flex-1"},Re={class:"font-medium text-primary-3"},Le={class:"text-sm"},ze={key:0,class:"text-xs mt-1 line-clamp-2"},Fe={class:"flex items-center gap-2 ml-4"},Oe={key:2,class:"rounded-lg shadow-sm"},Ue={class:"flex items-center justify-between mb-4"},je={class:"text-xl font-semibold flex items-center gap-2"},Ne={key:0,class:"text-center py-8"},Ie={key:2,class:"text-center py-8"},Ye=U({__name:"admin",setup(u){st({title:"Admin Panel - Music Playlist View",meta:[{name:"description",content:"Manage your YouTube playlists"}]});const h=_(""),p=_(!1),s=_(""),l=_(""),o=_([]),$=_(!0),P=_(null),x=_(null),D=_(null),g=_(null),m=_(null),v=_([]),M=_(!1);at(async()=>{await L()});const E=a=>{const e=a.trim(),T=e.match(/[?&]list=([a-zA-Z0-9_-]+)/);return T&&T[1]?T[1]:e},R=async()=>{if(h.value.trim()){p.value=!0,s.value="",l.value="";try{const a=E(h.value);if(!a)throw new Error("Invalid playlist ID or URL");const e=await $fetch(`/api/playlists/${a}`);if(e.success)l.value=`Successfully loaded playlist: ${e.data.title}`,h.value="",await L();else throw new Error("Failed to fetch playlist")}catch(a){console.error("Error fetching playlist:",a),s.value=a.data?.message||a.message||"Failed to fetch playlist. Please check the playlist ID and try again."}finally{p.value=!1}}},L=async()=>{try{$.value=!0;const a=await $fetch("/index.json");a.success&&(o.value=a.data)}catch(a){console.error("Error loading cached playlists:",a)}finally{$.value=!1}},c=async a=>{try{P.value=a;const e=await $fetch(`/api/playlists/${a}`);e.success&&(await L(),l.value=`Successfully updated playlist: ${e.data.title}`,s.value="")}catch(e){console.error("Error refreshing playlist:",e),s.value="Failed to refresh playlist",l.value=""}finally{P.value=null}},r=async a=>{if(confirm("Are you sure you want to delete this cached playlist?"))try{x.value=a,await $fetch(`/api/playlists/${a}`,{method:"DELETE"}),await L(),l.value="Successfully deleted cached playlist",s.value=""}catch(e){console.error("Error deleting playlist:",e),s.value="Failed to delete playlist",l.value=""}finally{x.value=null}},O=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),A=async a=>{try{D.value=a.id,M.value=!0;const e=await $fetch(`/playlist/${a.fileName}`);if(e)m.value=a,v.value=e.videos||[];else throw new Error("Failed to load playlist videos")}catch(e){console.error("Error loading playlist for editing:",e),s.value="Failed to load playlist videos",l.value=""}finally{D.value=null,M.value=!1}},N=()=>{m.value=null,v.value=[]},I=async a=>{try{g.value=a,s.value="",l.value="";const e=await $fetch("/api/playlists/update-data",{method:"POST",body:{playlistId:a}});if(e.success)l.value=e.message,await L();else throw new Error("Failed to update playlist music data")}catch(e){console.error("Error updating playlist music data:",e),s.value=e.data?.message||e.message||"Failed to update playlist music data",l.value=""}finally{g.value=null}};return(a,e)=>{const T=j,J=tt,W=ve;return n(),d("div",_e,[t("div",be,[e[2]||(e[2]=t("h1",{class:"text-3xl font-bold flex items-center gap-3"},[t("div",{class:"i-mdi-cog"}),y(" Admin Panel ")],-1)),S(T,{icon:"i-mdi-arrow-left",variant:"primary",to:"/"},{default:w(()=>[...e[1]||(e[1]=[y(" Back to Playlists ",-1)])]),_:1})]),t("div",$e,[t("div",we,[e[3]||(e[3]=t("h2",{class:"text-xl font-semibold mb-4 flex items-center gap-2"},[t("div",{class:"i-mdi-plus"}),y(" Add New Playlist ")],-1)),t("form",{class:"space-y-4",onSubmit:H(R,["prevent"])},[S(J,{id:"playlistId",modelValue:i(h),"onUpdate:modelValue":e[0]||(e[0]=k=>lt(h)?h.value=k:null),label:"YouTube Playlist ID or URL",placeholder:"Enter playlist ID (e.g., PLrAXtmRdnEQy8VVXvSgb5eKzwJJxd0FMz) or full URL",class:"max-w-xl","help-text":"You can paste either the playlist ID or the full YouTube playlist URL",disabled:i(p),required:""},null,8,["modelValue","disabled"]),S(T,{type:"submit",icon:"i-mdi-download",size:"medium",disabled:!i(h).trim(),loading:i(p),"show-text-while-loading":!0},{default:w(()=>[y(f(i(p)?"Loading...":"Load Playlist"),1)]),_:1},8,["disabled","loading"])],32)]),i(l)?(n(),d("div",ke,[t("div",Ce,[e[4]||(e[4]=t("div",{class:"i-mdi-check-circle"},null,-1)),e[5]||(e[5]=t("strong",null,"Success:",-1)),y(" "+f(i(l)),1)])])):b("",!0),i(s)?(n(),d("div",Ae,[t("div",De,[e[6]||(e[6]=t("div",{class:"i-mdi-alert-circle"},null,-1)),e[7]||(e[7]=t("strong",null,"Error:",-1)),y(" "+f(i(s)),1)])])):b("",!0),t("div",Se,[t("div",Me,[e[9]||(e[9]=t("h2",{class:"text-xl font-semibold flex items-center gap-2"},[t("div",{class:"i-mdi-playlist-play"}),y(" Cached Playlists ")],-1)),S(T,{icon:"i-mdi-refresh",size:"small",loading:i($),onClick:L},{default:w(()=>[...e[8]||(e[8]=[y(" Refresh ",-1)])]),_:1},8,["loading"])]),i($)?(n(),d("div",Ee,[...e[10]||(e[10]=[t("div",{class:"i-mdi-loading animate-spin text-2xl mb-2"},null,-1),t("p",{class:""},"Loading cached playlists...",-1)])])):i(o).length?(n(),d("div",Te,[(n(!0),d(V,null,F(i(o),k=>(n(),d("div",{key:k.id,class:"flex items-center justify-between rounded-lg hover:bg-bg-gradient py-6"},[t("div",Ve,[t("h3",Re,f(k.title),1),t("p",Le,f(k.videoCount)+" videos • Last updated: "+f(O(k.lastFetched)),1),k.description?(n(),d("p",ze,f(k.description),1)):b("",!0)]),t("div",Fe,[S(T,{icon:"i-mdi-database-plus",size:"small",variant:"primary",loading:i(g)===k.id,onClick:B=>I(k.id)},{default:w(()=>[...e[12]||(e[12]=[y(" Update All Music Data ",-1)])]),_:1},8,["loading","onClick"]),S(T,{icon:"i-mdi-pencil",size:"small",variant:"secondary",loading:i(D)===k.id,onClick:B=>A(k)},{default:w(()=>[...e[13]||(e[13]=[y(" Edit ",-1)])]),_:1},8,["loading","onClick"]),S(T,{icon:"i-mdi-refresh",size:"small",loading:i(P)===k.id,onClick:B=>c(k.id)},{default:w(()=>[...e[14]||(e[14]=[y(" Update ",-1)])]),_:1},8,["loading","onClick"]),S(T,{icon:"i-mdi-delete",size:"small",variant:"danger",loading:i(x)===k.id,onClick:B=>r(k.id)},{default:w(()=>[...e[15]||(e[15]=[y(" Delete ",-1)])]),_:1},8,["loading","onClick"])])]))),128))])):(n(),d("div",Pe,[...e[11]||(e[11]=[t("div",{class:"i-mdi-playlist-remove text-4xl mb-2"},null,-1),t("p",{class:""},"No cached playlists found.",-1)])]))]),i(m)?(n(),d("div",Oe,[t("div",Ue,[t("h2",je,[e[16]||(e[16]=t("div",{class:"i-mdi-pencil"},null,-1)),y(" Editing: "+f(i(m).title),1)]),S(T,{icon:"i-mdi-close",size:"small",variant:"ghost",onClick:N},{default:w(()=>[...e[17]||(e[17]=[y(" Close ",-1)])]),_:1})]),i(M)?(n(),d("div",Ne,[...e[18]||(e[18]=[t("div",{class:"i-mdi-loading animate-spin text-2xl mb-2"},null,-1),t("p",{class:""},"Loading playlist videos...",-1)])])):i(v).length?(n(),z(W,{key:1,videos:i(v)},null,8,["videos"])):(n(),d("div",Ie,[...e[19]||(e[19]=[t("div",{class:"i-mdi-video-off text-4xl mb-2"},null,-1),t("p",{class:""},"No videos found in this playlist.",-1)])]))])):b("",!0)])])}}});export{Ye as default};
