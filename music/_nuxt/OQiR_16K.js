import{h as D,G as x,x as z,H as ce,I as we,y as de,s as Se,J as Z,K as fe,L as be,q as ve,M as K,N as ge,O as Pe,p as F,P as I,D as le,g as Te,i as Ee,Q as q,z as xe}from"./nhAStCas.js";import{D as Q}from"./C-dq6sfJ.js";function U(e,t){return ce()?(we(e,t),!0):!1}const X=new WeakMap,ke=(...e)=>{var t;const n=e[0],r=(t=Z())===null||t===void 0?void 0:t.proxy,s=r??ce();if(s==null&&!fe())throw new Error("injectLocal must be called in setup");return s&&X.has(s)&&n in X.get(s)?X.get(s)[n]:be(...e)},Ie=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const pe=e=>e!=null,Ve=Object.prototype.toString,Oe=e=>Ve.call(e)==="[object Object]",N=()=>{};function Ae(...e){if(e.length!==1)return ge(...e);const t=e[0];return typeof t=="function"?K(Pe(()=>({get:t,set:N}))):D(t)}function ee(e,t){function n(...r){return new Promise((s,i)=>{Promise.resolve(e(()=>t.apply(this,r),{fn:t,thisArg:this,args:r})).then(s).catch(i)})}return n}const me=e=>e();function De(e,t={}){let n,r,s=N;const i=a=>{clearTimeout(a),s(),s=N};let d;return a=>{const u=x(e),c=x(t.maxWait);return n&&i(n),u<=0||c!==void 0&&c<=0?(r&&(i(r),r=void 0),Promise.resolve(a())):new Promise((l,p)=>{s=t.rejectOnCancel?p:l,d=a,c&&!r&&(r=setTimeout(()=>{n&&i(n),r=void 0,l(d())},c)),n=setTimeout(()=>{r&&i(r),r=void 0,l(a())},u)})}}function Fe(...e){let t=0,n,r=!0,s=N,i,d,o,a,u;!Se(e[0])&&typeof e[0]=="object"?{delay:d,trailing:o=!0,leading:a=!0,rejectOnCancel:u=!1}=e[0]:[d,o=!0,a=!0,u=!1]=e;const c=()=>{n&&(clearTimeout(n),n=void 0,s(),s=N)};return p=>{const v=x(d),S=Date.now()-t,P=()=>i=p();return c(),v<=0?(t=Date.now(),P()):(S>v?(t=Date.now(),(a||!r)&&P()):o&&(i=new Promise((b,f)=>{s=u?f:b,n=setTimeout(()=>{t=Date.now(),r=!0,b(P()),c()},Math.max(0,v-S))})),!a&&!n&&(n=setTimeout(()=>r=!0,v)),r=!1,i)}}function Me(e=me,t={}){const{initialState:n="active"}=t,r=Ae(n==="active");function s(){r.value=!1}function i(){r.value=!0}const d=(...o)=>{r.value&&e(...o)};return{isActive:K(r),pause:s,resume:i,eventFilter:d}}function se(e){return e.endsWith("rem")?Number.parseFloat(e)*16:Number.parseFloat(e)}function B(e){return Array.isArray(e)?e:[e]}function We(e){return Z()}function Ce(e,t=200,n={}){return ee(De(t,n),e)}function he(e,t=200,n=!1,r=!0,s=!1){return ee(Fe(t,n,r,s),e)}function nt(e,t=200,n=!0,r=!0){if(t<=0)return e;const s=D(x(e)),i=he(()=>{s.value=e.value},t,n,r);return z(e,()=>i()),s}function Le(e,t,n={}){const{eventFilter:r=me,...s}=n;return z(e,ee(r,t),s)}function Ne(e,t,n={}){const{eventFilter:r,initialState:s="active",...i}=n,{eventFilter:d,pause:o,resume:a,isActive:u}=Me(r,{initialState:s});return{stop:Le(e,t,{...i,eventFilter:d}),pause:o,resume:a,isActive:u}}const Re=Ne;function G(e,t=!0,n){We()?ve(e,n):t?e():de(e)}function _e(e,t,n){return z(e,t,{...n,immediate:!0})}const C=Ie?window:void 0;function R(e){var t;const n=x(e);return(t=n?.$el)!==null&&t!==void 0?t:n}function _(...e){const t=[],n=()=>{t.forEach(o=>o()),t.length=0},r=(o,a,u,c)=>(o.addEventListener(a,u,c),()=>o.removeEventListener(a,u,c)),s=F(()=>{const o=B(x(e[0])).filter(a=>a!=null);return o.every(a=>typeof a!="string")?o:void 0}),i=_e(()=>{var o,a;return[(o=(a=s.value)===null||a===void 0?void 0:a.map(u=>R(u)))!==null&&o!==void 0?o:[C].filter(u=>u!=null),B(x(s.value?e[1]:e[0])),B(Te(s.value?e[2]:e[1])),x(s.value?e[3]:e[2])]},([o,a,u,c])=>{if(n(),!o?.length||!a?.length||!u?.length)return;const l=Oe(c)?{...c}:c;t.push(...o.flatMap(p=>a.flatMap(v=>u.map(S=>r(p,v,S,l)))))},{flush:"post"}),d=()=>{i(),n()};return U(n),d}function ze(){const e=I(!1),t=Z();return t&&ve(()=>{e.value=!0},t),e}function Y(e){const t=ze();return F(()=>(t.value,!!e()))}function ye(e,t,n={}){const{window:r=C,...s}=n;let i;const d=Y(()=>r&&"MutationObserver"in r),o=()=>{i&&(i.disconnect(),i=void 0)},a=z(F(()=>{const l=B(x(e)).map(R).filter(pe);return new Set(l)}),l=>{o(),d.value&&l.size&&(i=new MutationObserver(t),l.forEach(p=>i.observe(p,s)))},{immediate:!0,flush:"post"}),u=()=>i?.takeRecords(),c=()=>{a(),o()};return U(c),{isSupported:d,stop:c,takeRecords:u}}const je=Symbol("vueuse-ssr-width");function He(){const e=fe()?ke(je,null):null;return typeof e=="number"?e:void 0}function Be(e,t={}){const{window:n=C,ssrWidth:r=He()}=t,s=Y(()=>n&&"matchMedia"in n&&typeof n.matchMedia=="function"),i=I(typeof r=="number"),d=I(),o=I(!1),a=u=>{o.value=u.matches};return Ee(()=>{if(i.value){i.value=!s.value,o.value=x(e).split(",").some(u=>{const c=u.includes("not all"),l=u.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),p=u.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let v=!!(l||p);return l&&v&&(v=r>=se(l[1])),p&&v&&(v=r<=se(p[1])),c?!v:v});return}s.value&&(d.value=n.matchMedia(x(e)),o.value=d.value.matches)}),_(d,"change",a,{passive:!0}),F(()=>o.value)}const J=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$="__vueuse_ssr_handlers__",Je=$e();function $e(){return $ in J||(J[$]=J[$]||{}),J[$]}function Ke(e,t){return Je[e]||t}function Ue(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const Ge={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},ae="vueuse-storage";function ie(e,t,n,r={}){var s;const{flush:i="pre",deep:d=!0,listenToStorageChanges:o=!0,writeDefaults:a=!0,mergeDefaults:u=!1,shallow:c,window:l=C,eventFilter:p,onError:v=m=>{console.error(m)},initOnMounted:S}=r,P=(c?I:D)(typeof t=="function"?t():t),b=F(()=>x(e));if(!n)try{n=Ke("getDefaultStorage",()=>C?.localStorage)()}catch(m){v(m)}if(!n)return P;const f=x(t),g=Ue(f),T=(s=r.serializer)!==null&&s!==void 0?s:Ge[g],{pause:E,resume:O}=Re(P,m=>L(m),{flush:i,deep:d,eventFilter:p});z(b,()=>W(),{flush:i});let A=!1;const y=m=>{S&&!A||W(m)},V=m=>{S&&!A||j(m)};l&&o&&(n instanceof Storage?_(l,"storage",y,{passive:!0}):_(l,ae,V)),S?G(()=>{A=!0,W()}):W();function h(m,w){if(l){const k={key:b.value,oldValue:m,newValue:w,storageArea:n};l.dispatchEvent(n instanceof Storage?new StorageEvent("storage",k):new CustomEvent(ae,{detail:k}))}}function L(m){try{const w=n.getItem(b.value);if(m==null)h(w,null),n.removeItem(b.value);else{const k=T.write(m);w!==k&&(n.setItem(b.value,k),h(w,k))}}catch(w){v(w)}}function M(m){const w=m?m.newValue:n.getItem(b.value);if(w==null)return a&&f!=null&&n.setItem(b.value,T.write(f)),f;if(!m&&u){const k=T.read(w);return typeof u=="function"?u(k,f):g==="object"&&!Array.isArray(k)?{...f,...k}:k}else return typeof w!="string"?w:T.read(w)}function W(m){if(!(m&&m.storageArea!==n)){if(m&&m.key==null){P.value=f;return}if(!(m&&m.key!==b.value)){E();try{const w=T.write(P.value);(m===void 0||m?.newValue!==w)&&(P.value=M(m))}catch(w){v(w)}finally{m?de(O):O()}}}}function j(m){W(m.detail)}return P}function Ye(e,t,n={}){const{window:r=C,...s}=n;let i;const d=Y(()=>r&&"ResizeObserver"in r),o=()=>{i&&(i.disconnect(),i=void 0)},a=z(F(()=>{const c=x(e);return Array.isArray(c)?c.map(l=>R(l)):[R(c)]}),c=>{if(o(),d.value&&r){i=new ResizeObserver(t);for(const l of c)l&&i.observe(l,s)}},{immediate:!0,flush:"post"}),u=()=>{o(),a()};return U(u),{isSupported:d,stop:u}}function ot(e,t={}){const{reset:n=!0,windowResize:r=!0,windowScroll:s=!0,immediate:i=!0,updateTiming:d="sync"}=t,o=I(0),a=I(0),u=I(0),c=I(0),l=I(0),p=I(0),v=I(0),S=I(0);function P(){const f=R(e);if(!f){n&&(o.value=0,a.value=0,u.value=0,c.value=0,l.value=0,p.value=0,v.value=0,S.value=0);return}const g=f.getBoundingClientRect();o.value=g.height,a.value=g.bottom,u.value=g.left,c.value=g.right,l.value=g.top,p.value=g.width,v.value=g.x,S.value=g.y}function b(){d==="sync"?P():d==="next-frame"&&requestAnimationFrame(()=>P())}return Ye(e,b),z(()=>R(e),f=>!f&&b()),ye(e,b,{attributeFilter:["style","class"]}),s&&_("scroll",b,{capture:!0,passive:!0}),r&&_("resize",b,{passive:!0}),G(()=>{i&&b()}),{height:o,bottom:a,left:u,right:c,top:l,width:p,x:v,y:S,update:b}}function rt(e,t,n={}){const{root:r,rootMargin:s="0px",threshold:i=0,window:d=C,immediate:o=!0}=n,a=Y(()=>d&&"IntersectionObserver"in d),u=F(()=>B(x(e)).map(R).filter(pe));let c=N;const l=I(o),p=a.value?z(()=>[u.value,R(r),l.value],([S,P])=>{if(c(),!l.value||!S.length)return;const b=new IntersectionObserver(t,{root:R(P),rootMargin:s,threshold:i});S.forEach(f=>f&&b.observe(f)),c=()=>{b.disconnect(),c=N}},{immediate:o,flush:"post"}):N,v=()=>{c(),p(),l.value=!1};return U(v),{isSupported:a,isActive:l,pause(){c(),l.value=!1},resume(){l.value=!0},stop:v}}const ue=1;function Qe(e,t={}){const{throttle:n=0,idle:r=200,onStop:s=N,onScroll:i=N,offset:d={left:0,right:0,top:0,bottom:0},observe:o={mutation:!1},eventListenerOptions:a={capture:!1,passive:!0},behavior:u="auto",window:c=C,onError:l=h=>{console.error(h)}}=t,p=typeof o=="boolean"?{mutation:o}:o,v=I(0),S=I(0),P=F({get(){return v.value},set(h){f(h,void 0)}}),b=F({get(){return S.value},set(h){f(void 0,h)}});function f(h,L){var M,W,j,m;if(!c)return;const w=x(e);if(!w)return;(M=w instanceof Document?c.document.body:w)===null||M===void 0||M.scrollTo({top:(W=x(L))!==null&&W!==void 0?W:b.value,left:(j=x(h))!==null&&j!==void 0?j:P.value,behavior:x(u)});const k=(w==null||(m=w.document)===null||m===void 0?void 0:m.documentElement)||w?.documentElement||w;P!=null&&(v.value=k.scrollLeft),b!=null&&(S.value=k.scrollTop)}const g=I(!1),T=le({left:!0,right:!1,top:!0,bottom:!1}),E=le({left:!1,right:!1,top:!1,bottom:!1}),O=h=>{g.value&&(g.value=!1,E.left=!1,E.right=!1,E.top=!1,E.bottom=!1,s(h))},A=Ce(O,n+r),y=h=>{var L;if(!c)return;const M=(h==null||(L=h.document)===null||L===void 0?void 0:L.documentElement)||h?.documentElement||R(h),{display:W,flexDirection:j,direction:m}=getComputedStyle(M),w=m==="rtl"?-1:1,k=M.scrollLeft;E.left=k<v.value,E.right=k>v.value;const te=Math.abs(k*w)<=(d.left||0),ne=Math.abs(k*w)+M.clientWidth>=M.scrollWidth-(d.right||0)-ue;W==="flex"&&j==="row-reverse"?(T.left=ne,T.right=te):(T.left=te,T.right=ne),v.value=k;let H=M.scrollTop;h===c.document&&!H&&(H=c.document.body.scrollTop),E.top=H<S.value,E.bottom=H>S.value;const oe=Math.abs(H)<=(d.top||0),re=Math.abs(H)+M.clientHeight>=M.scrollHeight-(d.bottom||0)-ue;W==="flex"&&j==="column-reverse"?(T.top=re,T.bottom=oe):(T.top=oe,T.bottom=re),S.value=H},V=h=>{var L;c&&(y((L=h.target.documentElement)!==null&&L!==void 0?L:h.target),g.value=!0,A(h),i(h))};return _(e,"scroll",n?he(V,n,!0,!1):V,a),G(()=>{try{const h=x(e);if(!h)return;y(h)}catch(h){l(h)}}),p?.mutation&&e!=null&&e!==c&&e!==document&&ye(e,()=>{const h=x(e);h&&y(h)},{attributes:!0,childList:!0,subtree:!0}),_(e,"scrollend",O,a),{x:P,y:b,isScrolling:g,arrivedState:T,directions:E,measure(){const h=x(e);c&&h&&y(h)}}}function lt(e={}){const{window:t=C,...n}=e;return Qe(t,n)}function st(e={}){const{window:t=C,initialWidth:n=Number.POSITIVE_INFINITY,initialHeight:r=Number.POSITIVE_INFINITY,listenOrientation:s=!0,includeScrollbar:i=!0,type:d="inner"}=e,o=I(n),a=I(r),u=()=>{if(t)if(d==="outer")o.value=t.outerWidth,a.value=t.outerHeight;else if(d==="visual"&&t.visualViewport){const{width:l,height:p,scale:v}=t.visualViewport;o.value=Math.round(l*v),a.value=Math.round(p*v)}else i?(o.value=t.innerWidth,a.value=t.innerHeight):(o.value=t.document.documentElement.clientWidth,a.value=t.document.documentElement.clientHeight)};u(),G(u);const c={passive:!0};return _("resize",u,c),t&&d==="visual"&&t.visualViewport&&_(t.visualViewport,"resize",u,c),s&&z(Be("(orientation: portrait)"),()=>u()),{width:o,height:a}}const Xe=q("playlistStore",()=>{const e=D(null),t=D(null),n=D(!1),r=D(""),s=F(()=>e.value!==null),i=F(()=>e.value?.videos||[]),d=l=>[...l].sort((p,v)=>p.createdAt&&!v.createdAt?-1:!p.createdAt&&v.createdAt?1:p.createdAt&&v.createdAt?v.createdAt-p.createdAt:0),o=l=>({...l,videos:d(l.videos)});return{currentPlaylist:e,loading:n,error:r,hasCurrentPlaylist:s,originalCurrentPlaylist:t,currentVideos:i,loadFirstPlaylist:async()=>{try{n.value=!0,r.value="";const l=await $fetch("/index.json");if(!l.success||!l.data.length){e.value=null,t.value=null;return}const p=l.data[0],v=await $fetch(`/playlist/${p?.fileName}`),S=o(v);e.value=S,t.value=JSON.parse(JSON.stringify(S))}catch(l){console.error("Error loading first playlist:",l),r.value=l.data?.message||l.message||"Failed to load playlist",e.value=null,t.value=null}finally{n.value=!1}},setCurrentPlaylistVideos:l=>{e.value&&(e.value={...e.value,videos:l})},findVideoIndex:l=>e.value?e.value.videos.findIndex(p=>p.id===l):-1,sortVideosByCreatedAt:d}}),Ze=q("Player",()=>{const e=D(!1),t=D(null),n=D(0),r=D(!1),s=D(!1),i=D(!1),d=D(null),{currentVideos:o}=xe(Xe()),a=F(()=>t.value?o.value.findIndex(V=>V.id===t.value?.id)>0:!1),u=F(()=>{if(!t.value)return!1;const y=o.value.findIndex(V=>V.id===t.value?.id);return y===-1?o.value.length>0:y<o.value.length-1}),c=y=>{t.value=y,s.value=!!y},l=y=>{e.value=y},p=y=>{r.value=y},v=y=>{d.value=y},S=()=>{!d.value||!r.value||(e.value?d.value.pauseVideo():d.value.playVideo())},P=y=>{y>=0&&y<o.value.length&&(n.value=y,t.value=o.value[y]||null)};return{isPlaying:e,currentVideo:t,currentIndex:n,isPlayerReady:r,showPlayerBar:s,isFloatingPlayerOpen:i,canPlayPrevious:a,canPlayNext:u,setCurrentVideo:c,setIsPlaying:l,setIsPlayerReady:p,setCurrentIndex:P,setYouTubePlayerInstance:v,togglePlayPause:S,previousVideo:()=>{if(!t.value)return;const y=o.value.findIndex(V=>V.id===t.value?.id);if(y>0){const V=y-1;n.value=V,t.value=o.value[V]||null}},nextVideo:()=>{if(!t.value)return;const y=o.value.findIndex(V=>V.id===t.value?.id);if(y!==-1&&y<o.value.length-1){const V=y+1;n.value=V,t.value=o.value[V]||null}else y===-1&&o.value.length>0&&(n.value=0,t.value=o.value[0]||null)},playVideo:y=>{P(y)},closePlayer:()=>{s.value=!1,i.value=!1,t.value=null,e.value=!1,r.value=!1,d.value=null},initializeGlobalPlayer:(y=0)=>{P(y),s.value=!0,i.value=!0},openFloatingPlayer:()=>{i.value=!0},closeFloatingPlayer:()=>{i.value=!1}}}),qe={simple:{playPause:" ",nextTrack:"ArrowRight",previousTrack:"ArrowLeft",volumeUp:"ArrowUp",volumeDown:"ArrowDown",mute:"m",seekForward:"l",seekBackward:"j",focusSearch:"ctrl+k"},winamp:{playPause:"c",nextTrack:"b",previousTrack:"z",volumeUp:"ArrowUp",volumeDown:"ArrowDown",mute:"m",seekForward:"v",seekBackward:"c",focusSearch:"ctrl+k"},youtube:{playPause:"k",nextTrack:"n",previousTrack:"p",volumeUp:"ArrowUp",volumeDown:"ArrowDown",mute:"m",seekForward:"l",seekBackward:"j",focusSearch:"ctrl+k"}},at=q("userSettingsStore",()=>{const e=D({keyboardShortcutScheme:"winamp",selectedPlatforms:Q}),t=D(!0),n=ie("video-view-mode","list"),r=ie("video-player-position",{x:100,y:100,width:320,height:240}),s=F(()=>e.value.customShortcuts?e.value.customShortcuts:qe[e.value.keyboardShortcutScheme]),i=F(()=>[{value:"simple",label:"Simple (Space, Arrow Keys)"},{value:"winamp",label:"Winamp Style (X, Z, B, C, V)"},{value:"youtube",label:"YouTube Style (K, J, L, N, P)"}]),d=f=>{e.value.keyboardShortcutScheme=f,e.value.customShortcuts=void 0,l()},o=f=>{e.value.selectedPlatforms=f,l()},a=()=>{e.value={keyboardShortcutScheme:"simple",selectedPlatforms:Q},l()},u=()=>{t.value=!0},c=()=>{t.value=!1},l=()=>{localStorage.setItem("userSettings",JSON.stringify(e.value))},p=()=>{try{const f=localStorage.getItem("userSettings");if(f){const g=JSON.parse(f);e.value={keyboardShortcutScheme:g.keyboardShortcutScheme||"simple",customShortcuts:g.customShortcuts,selectedPlatforms:g.selectedPlatforms||Q}}}catch(f){console.warn("Failed to load user settings:",f),a()}},v=f=>{if(!t.value)return;const g=Ze();if(!S(f,g)&&f.ctrlKey&&f.key.toLowerCase()==="k"){f.preventDefault();const E=document.getElementById("search");E&&E.focus()}},S=(f,g)=>{const T=f.target;if(T instanceof HTMLInputElement||T instanceof HTMLTextAreaElement||T instanceof HTMLSelectElement||T?.contentEditable==="true"||T?.closest("input, textarea, select, [contenteditable]")||T?.closest("[class*='input'], [class*='select'], [class*='dropdown']")||T?.closest("[role='textbox'], [role='combobox'], [role='searchbox']")||T?.closest("[data-input], [data-multiselect]"))return!1;const E=s.value,O=f.key.toLowerCase();let A=!1;return O===E.playPause||e.value.keyboardShortcutScheme==="youtube"&&O===" "?(f.preventDefault(),g.togglePlayPause(),A=!0):O===E.nextTrack?(f.preventDefault(),g.nextVideo(),A=!0):O===E.previousTrack?(f.preventDefault(),g.previousVideo(),A=!0):(O===E.mute||O===E.volumeUp||O===E.volumeDown||O===E.seekForward||O===E.seekBackward)&&(f.preventDefault(),A=!0),A},P=()=>{document.addEventListener("keydown",v)},b=()=>{document.removeEventListener("keydown",v)};return p(),P(),{settings:K(e),shortcutsEnabled:K(t),viewMode:n,videoPlayerPosition:r,currentKeyboardShortcuts:s,availableShortcutSchemes:i,setKeyboardShortcutScheme:d,setSelectedPlatforms:o,resetToDefaults:a,loadSettings:p,saveSettings:l,handleKeyboardEvent:S,enableShortcuts:u,disableShortcuts:c,setupGlobalListeners:P,cleanupGlobalListeners:b}});export{Xe as a,rt as b,Ce as c,lt as d,ot as e,st as f,_ as g,he as h,Ze as i,nt as r,at as u};
