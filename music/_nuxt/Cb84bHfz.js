import{_ as N}from"./Dk86iks7.js";import{_ as U}from"./BoL-tO2v.js";import{e as P,h,p as k,c as u,a as e,m as j,f as E,g as i,w,F,r as Y,o as r,d as m,b as f,n as S,D as O,u as R,q,t as _}from"./VHrLwLmr.js";import{g as z}from"./Ca0y52ut.js";import"./Dfu5kdPR.js";const H={class:"space-y-4"},K={class:"flex items-center justify-between mb-4"},X={class:"flex items-center gap-3"},G={class:"flex-1 grid grid-cols-2 gap-3"},J=["onClick","disabled"],Q={key:0,class:"i-mdi-loading animate-spin text-2xl"},W={key:1,class:"i-mdi-check-circle text-2xl"},Z=P({__name:"CurationInterface",props:{song:{},musicTitle:{},channel:{}},emits:["cancel","success"],setup(V,{emit:v}){const s=V,a=v,d=h(!1),p=l=>{if(!l)return{artist:"",title:""};const n=l.split("_");return n.length>=2?{artist:decodeURIComponent(n[0]).trim(),title:decodeURIComponent(n[1]).trim()}:{artist:"",title:""}},b=[{key:"channel",label:"Channel Name",condition:()=>!!s.channel,getData:()=>({artist:s.channel||"",title:s.song.title})},{key:"youtube",label:"YouTube Title",condition:()=>!!(s.song.artist||s.song.title),getData:()=>s.song},{key:"youtube2",label:"YouTube2 Title",condition:()=>!0,getData:()=>({title:s.musicTitle,artist:s.channel})},{key:"ai",label:"AI Parsed",condition:()=>!!(s.song.ai?.artist||s.song.ai?.title),getData:()=>({artist:s.song.ai?.artist||"",title:s.song.ai?.title||""})},{key:"lastfm",label:"Last.fm Parsed",condition:()=>{const l=p(s.song.lastfm?.id);return!!(l.artist||l.title)},getData:()=>p(s.song.lastfm?.id)},{key:"musicbrainz",label:"MusicBrainz",condition:()=>!!s.song.musicbrainz?.trackMbid,getData:()=>({artist:s.song.artist||"",title:s.song.title})}],T=k(()=>b.filter(l=>l.condition()).map(l=>({key:l.key,label:l.label,data:O(l.getData())}))),C=async(l,n)=>{if(!n.artist||!n.title){alert("Please fill in both artist and title");return}if(!d.value)try{d.value=!0,await $fetch("/api/metadata/curate",{method:"POST",body:{youtubeId:s.song.youtubeId,artist:n.artist,title:n.title}}),a("success",n.artist,n.title)}catch(c){console.error("Error curating song:",c),alert("Failed to curate song metadata"),d.value=!1}};return(l,n)=>{const c=N,I=U;return r(),u("div",H,[e("div",K,[n[2]||(n[2]=e("h3",{class:"text-xl font-semibold text-primary-4"}," Choose Artist & Title ",-1)),i(d)?E("",!0):(r(),j(c,{key:0,variant:"secondary",icon:"i-mdi-close",onClick:n[0]||(n[0]=o=>l.$emit("cancel"))},{default:w(()=>[...n[1]||(n[1]=[m(" Skip ",-1)])]),_:1}))]),(r(!0),u(F,null,Y(i(T),o=>(r(),u("div",{key:o.key,class:"bg-primary-1 rounded-lg pl-3"},[e("div",X,[e("div",G,[f(I,{modelValue:o.data.artist,"onUpdate:modelValue":t=>o.data.artist=t,placeholder:"Artist",size:"small",label:"Artist"},null,8,["modelValue","onUpdate:modelValue"]),f(I,{modelValue:o.data.title,"onUpdate:modelValue":t=>o.data.title=t,placeholder:"Title",size:"small",label:"Title"},null,8,["modelValue","onUpdate:modelValue"])]),e("button",{onClick:t=>C(o.key,o.data),disabled:i(d),class:S(["w-12 h-12 flex items-center justify-center rounded-full transition-all",i(d)?"text-primary-3 cursor-not-allowed":"text-primary-3 hover:text-accent hover:bg-accent/10 hover:scale-110"]),title:"Save this option"},[i(d)?(r(),u("div",Q)):(r(),u("div",W))],10,J)])]))),128))])}}}),tt=Object.assign(Z,{__name:"CurationInterface"}),et={class:"container mx-auto px-4 py-8 max-w-4xl"},st={class:"flex items-center justify-between mb-8"},at={key:0,class:"flex items-center justify-center py-12"},nt={key:1,class:"bg-primary-1 border border-error rounded-lg p-6"},it={class:"flex items-center gap-2 text-error mb-4"},lt={key:2,class:"bg-primary-1 rounded-lg p-8 text-center"},ot={key:3,class:"space-y-6"},rt={class:"bg-bg-gradient rounded-lg p-6"},dt={class:"bg-primary-1 rounded-lg p-4"},ut={class:"flex items-center justify-between"},ct={class:"text-sm text-primary-3"},mt={class:"text-accent font-semibold"},pt={class:"bg-bg-gradient rounded-lg p-6"},gt={class:"mb-6 aspect-video rounded-lg overflow-hidden bg-black"},ft=["src"],vt={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},bt={class:"bg-primary-1 rounded-lg p-3 text-center"},yt={class:"bg-primary-1 rounded-lg p-3 text-center"},xt={class:"bg-primary-1 rounded-lg p-3 text-center"},Dt=P({__name:"curate",setup(V){R({title:"Curate Music Data - Music Playlist View",meta:[{name:"description",content:"Curate and improve music metadata"}]});const v=h(!0),s=h(""),a=h(null),d=h(""),p=z("curated-songs",[]),b=z("skipped-songs",[]),T=k(()=>p.value.length),C=k(()=>a.value?!!(a.value.odesli||a.value.musicbrainz?.externalIdsTrack||a.value.musicbrainz?.externalIdsArtist):!1),l=k(()=>a.value?!!(a.value.ai?.artist&&a.value.ai?.title):!1),n=k(()=>a.value?!!a.value.lastfm?.id:!1),c=async(o=!1)=>{try{o&&a.value?.youtubeId&&(b.value.includes(a.value.youtubeId)||b.value.push(a.value.youtubeId)),v.value=!0,s.value="";const y=(await $fetch("/playlist/PLHh-DPsAXiAUVUVA9DpRtiYRrwgvqg8Fx.json")).videos||[],D=await $fetch("/api/metadata/all",{method:"POST"}),$=y.filter(A=>{const x=D[A.id];if(p.value.includes(A.id)||b.value.includes(A.id)||x?.curated)return!1;const L=!!(x?.odesli||x?.musicbrainz?.externalIdsTrack||x?.musicbrainz?.externalIdsArtist),M=!!x?.lastfm?.id;return!L&&!M});if($.length===0){a.value=null;return}const g=$[Math.floor(Math.random()*$.length)],B=D[g.id];d.value=g.channel,a.value={youtubeId:g.id,title:g.title,musicTitle:g.musicTitle,artist:g.artist,lastFetched:new Date().toISOString(),...B}}catch(t){console.error("Error loading random song:",t),s.value="Failed to load songs for curation"}finally{v.value=!1}},I=(o,t)=>{a.value?.youtubeId&&(p.value.includes(a.value.youtubeId)||p.value.push(a.value.youtubeId)),console.log(`Successfully curated: ${o} - ${t}`),c()};return q(()=>{c()}),(o,t)=>{const y=N,D=tt;return r(),u("div",et,[e("div",st,[t[2]||(t[2]=e("h1",{class:"text-3xl font-bold flex items-center gap-3"},[e("div",{class:"i-mdi-music-note-plus"}),m(" Curate Music Data ")],-1)),f(y,{icon:"i-mdi-arrow-left",variant:"primary",to:"/"},{default:w(()=>[...t[1]||(t[1]=[m(" Back to Playlists ",-1)])]),_:1})]),i(v)?(r(),u("div",at,[...t[3]||(t[3]=[e("div",{class:"flex items-center gap-3 text-primary-3"},[e("div",{class:"i-mdi-loading animate-spin text-2xl"}),e("span",null,"Loading random song...")],-1)])])):i(s)?(r(),u("div",nt,[e("div",it,[t[4]||(t[4]=e("div",{class:"i-mdi-alert-circle"},null,-1)),t[5]||(t[5]=e("strong",null,"Error:",-1)),m(" "+_(i(s)),1)]),f(y,{variant:"primary",onClick:c},{default:w(()=>[...t[6]||(t[6]=[m(" Try Again ",-1)])]),_:1})])):i(a)?(r(),u("div",ot,[e("div",rt,[f(D,{song:i(a),channel:i(d),onCancel:t[0]||(t[0]=()=>c(!0)),onSuccess:I},null,8,["song","channel"])]),e("div",dt,[e("div",ut,[e("div",ct,[t[11]||(t[11]=m(" Songs curated this session: ",-1)),e("span",mt,_(i(T)),1)])])]),e("div",pt,[t[15]||(t[15]=e("h2",{class:"text-xl font-semibold mb-4 flex items-center gap-2"},[e("div",{class:"i-mdi-music"}),m(" Current Song ")],-1)),e("div",gt,[e("iframe",{src:`https://www.youtube.com/embed/${i(a).youtubeId}`,class:"w-full h-full",frameborder:"0",allow:`
							accelerometer;
							autoplay;
							clipboard-write;
							encrypted-media;
							gyroscope;
							picture-in-picture;
						`,allowfullscreen:""},null,8,ft)]),e("div",vt,[e("div",bt,[t[12]||(t[12]=e("div",{class:"text-xs text-primary-3 mb-1"},"External IDs",-1)),e("div",{class:S(["text-lg font-semibold",i(C)?"text-accent":"text-error"])},_(i(C)?"Yes":"No"),3)]),e("div",yt,[t[13]||(t[13]=e("div",{class:"text-xs text-primary-3 mb-1"},"AI Data",-1)),e("div",{class:S(["text-lg font-semibold",i(l)?"text-accent":"text-error"])},_(i(l)?"Yes":"No"),3)]),e("div",xt,[t[14]||(t[14]=e("div",{class:"text-xs text-primary-3 mb-1"},"Last.fm Data",-1)),e("div",{class:S(["text-lg font-semibold",i(n)?"text-accent":"text-error"])},_(i(n)?"Yes":"No"),3)])])])])):(r(),u("div",lt,[t[8]||(t[8]=e("div",{class:"i-mdi-music-note-off text-6xl text-primary-3 mb-4"},null,-1)),t[9]||(t[9]=e("h2",{class:"text-xl font-semibold text-primary-4 mb-2"}," No Songs Need Curation ",-1)),t[10]||(t[10]=e("p",{class:"text-primary-3 mb-4"}," All songs in the playlist have been curated or have metadata! ",-1)),f(y,{variant:"primary",to:"/"},{default:w(()=>[...t[7]||(t[7]=[m(" Back to Playlists ",-1)])]),_:1})]))])}}});export{Dt as default};
