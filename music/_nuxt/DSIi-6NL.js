import{_ as N}from"./BGN51c8H.js";import{_ as q}from"./B-HfUd4m.js";import{g as st,a as lt,b as at}from"./cTjeiag2.js";import{e as j,c as r,f as k,o as n,a as t,t as p,F as V,r as z,g as a,n as J,h as y,i as W,b as T,w as C,d as f,j as Q,v as Y,k as K,l as it,m as B,p as I,q as X,s as Z,u as nt}from"./CfW3McnN.js";import"./KFTfOdSb.js";const ot={key:0,class:"p-2 rounded text-xs"},rt={class:"font-medium text-primary-4 line-clamp-1"},dt={class:"text-primary-3 line-clamp-1"},ct={key:0,class:"text-primary-3 line-clamp-1"},ut={key:1,class:"mt-1 flex gap-2 flex-wrap"},mt=["title"],pt=["title"],gt={key:2,class:"mt-1 flex gap-1 flex-wrap"},ft=["title"],ht={key:3,class:"mt-1 text-xs text-primary-3"},yt={key:0,class:"mr-2"},vt={key:1},xt={key:4,class:"mt-2 flex gap-2 flex-wrap items-center"},bt=["href","title"],_t=j({__name:"AdminMusicDataDisplay",props:{songData:{default:void 0}},setup(c){return(g,u)=>c.songData?(n(),r("div",ot,[t("div",rt,p(c.songData.title),1),t("div",dt,"by "+p(c.songData.artist),1),c.songData.album?(n(),r("div",ct,p(c.songData.album),1)):k("",!0),c.songData.tags?.length||c.songData.genres?.length||c.songData.artistTags?.length?(n(),r("div",ut,[(n(!0),r(V,null,z(c.songData.tags?.slice(0,3)||[],l=>(n(),r("span",{key:`song-${l}`,class:"inline-block bg-accent/20 text-black px-1 rounded text-xs mr-1"},p(l),1))),128)),(n(!0),r(V,null,z(c.songData.genres?.slice(0,3)||[],l=>(n(),r("span",{key:`genre-${l}`,class:"inline-block bg-primary-3/30 text-primary-4 px-1 rounded text-xs mr-1",title:`Genre: ${l}`},p(l),9,mt))),128)),(n(!0),r(V,null,z(c.songData.artistTags?.slice(0,2)||[],l=>(n(),r("span",{key:`artist-${l}`,class:"inline-block bg-primary-2/60 text-primary-4 px-1 rounded text-xs mr-1",title:`Artist tag: ${l}`},p(l),9,pt))),128))])):k("",!0),c.songData.lastfmTags?.length?(n(),r("div",gt,[(n(!0),r(V,null,z(c.songData.lastfmTags.slice(0,3),l=>(n(),r("span",{key:`lastfm-${l}`,class:"inline-block bg-red-500/20 text-red-300 px-1 rounded text-xs",title:`Last.fm tag: ${l}`},p(l),9,ft))),128))])):k("",!0),c.songData.listeners||c.songData.playcount?(n(),r("div",ht,[c.songData.listeners?(n(),r("span",yt," ðŸŽ§ "+p(c.songData.listeners.toLocaleString()),1)):k("",!0),c.songData.playcount?(n(),r("span",vt," â–¶ï¸ "+p(c.songData.playcount.toLocaleString()),1)):k("",!0)])):k("",!0),c.songData.odesli&&Object.keys(c.songData.odesli).length>0?(n(),r("div",xt,[u[0]||(u[0]=t("span",{class:"text-xs text-primary-3 mr-1"},"Listen on:",-1)),(n(!0),r(V,null,z(c.songData.odesli,(l,o)=>(n(),r("a",{key:o,href:("getPlatformUrl"in g?g.getPlatformUrl:a(lt))(o,l),target:"_blank",rel:"noopener noreferrer",class:"text-primary-3 hover:text-accent transition-colors",title:`Listen on ${("getPlatformName"in g?g.getPlatformName:a(st))(o)}`},[t("div",{class:J([("getPlatformIcon"in g?g.getPlatformIcon:a(at))(o),"text-sm"])},null,2)],8,bt))),128))])):k("",!0)])):k("",!0)}}),$t=Object.assign(_t,{__name:"AdminMusicDataDisplay"}),kt={key:0,class:"space-y-4"},wt={class:"flex items-center justify-between mb-3"},Ct={class:"text-sm font-medium text-primary-4"},Tt={class:"overflow-x-auto"},St={class:"w-full border-collapse text-sm"},Dt={class:"p-2"},At=["onUpdate:modelValue","placeholder"],Et={class:"p-2 text-center"},Mt={class:"p-2"},Pt=["onUpdate:modelValue","placeholder"],Lt={class:"p-2"},Vt={class:"flex items-center gap-2"},Rt={class:"w-12 h-2 bg-primary-1 rounded-full overflow-hidden"},Ft={class:"text-xs text-primary-3 font-mono"},zt={class:"p-2"},Ot={key:0,class:"text-xs text-primary-3 text-center"},Bt={key:1,class:"mt-3 p-2 bg-red-500/10 border border-red-500/20 rounded text-xs text-red-400 text-center"},Ut=j({__name:"AdminSearchForm",props:{parsedTitles:{default:void 0},videoId:{}},emits:["searchComplete","searchError","cancel"],setup(c,{emit:g}){const u=c,l=g,o=y(null),d=y(null),w=y([]);W(()=>{u.parsedTitles&&(w.value=u.parsedTitles.map(x=>({artist:x.artist,title:x.title})))});const b=async x=>{o.value=x;const m=w.value[x];if(!m||!m.artist||!m.title){d.value="Artist and title are required",o.value=null;return}try{const $=await $fetch("/api/metadata/musicbrainz-search",{method:"POST",body:{artist:m.artist,title:m.title}});$.success&&$.results?.length>0?(d.value=null,l("searchComplete",$.results)):(d.value="No search results found",l("searchError","No search results found"))}catch($){const P=$ instanceof Error?$.message:"Unknown error occurred";d.value=`Search failed: ${P}`,l("searchError",`Search failed: ${P}`)}finally{o.value=null}},v=()=>{d.value=null,l("cancel")},S=x=>{const m=w.value[x];if(m){const $=m.artist;m.artist=m.title,m.title=$}};return(x,m)=>{const $=N;return c.parsedTitles?.length?(n(),r("div",kt,[t("div",wt,[t("h4",Ct," Parsed Titles ("+p(c.parsedTitles.length)+" found) ",1),T($,{size:"small",variant:"ghost",class:"text-xs",onClick:v},{default:C(()=>[...m[2]||(m[2]=[f(" Cancel ",-1)])]),_:1})]),t("div",Tt,[t("table",St,[m[8]||(m[8]=t("thead",null,[t("tr",{class:"border-b border-primary-2/50"},[t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Artist "),t("th",{class:"text-center p-2 font-medium text-primary-4 text-xs w-12"}),t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Title "),t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Confidence "),t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Action ")])],-1)),t("tbody",null,[(n(!0),r(V,null,z(c.parsedTitles,(P,L)=>(n(),r("tr",{key:L,class:"border-b border-primary-2/30 hover:bg-bg-gradient transition-colors"},[t("td",Dt,[Q(t("input",{"onUpdate:modelValue":F=>a(w)[L].artist=F,class:"w-full bg-transparent border border-primary-2/50 rounded px-2 py-1 text-primary-4 text-xs focus:border-accent focus:outline-none",placeholder:P.artist,"data-input":"",onKeydown:m[0]||(m[0]=K(()=>{},["stop"]))},null,40,At),[[Y,a(w)[L].artist]])]),t("td",Et,[T($,{size:"small",variant:"ghost",class:"!p-1 !min-w-0 hover:bg-accent/20",title:"Swap artist and title",onClick:F=>S(L)},{default:C(()=>[...m[3]||(m[3]=[t("div",{class:"i-mdi-swap-horizontal text-xs"},null,-1)])]),_:1},8,["onClick"])]),t("td",Mt,[Q(t("input",{"onUpdate:modelValue":F=>a(w)[L].title=F,class:"w-full bg-transparent border border-primary-2/50 rounded px-2 py-1 text-primary-3 text-xs focus:border-accent focus:outline-none",placeholder:P.title,"data-input":"",onKeydown:m[1]||(m[1]=K(()=>{},["stop"]))},null,40,Pt),[[Y,a(w)[L].title]])]),t("td",Lt,[t("div",Vt,[t("div",Rt,[t("div",{class:"h-full bg-accent rounded-full transition-all",style:it({width:`${P.confidence*100}%`})},null,4)]),t("span",Ft,p(Math.round(P.confidence*100))+"% ",1)])]),t("td",zt,[T($,{size:"small",variant:"primary",disabled:a(o)===L,class:"text-xs",onClick:F=>b(L)},{default:C(()=>[a(o)===L?(n(),r(V,{key:0},[m[4]||(m[4]=t("div",{class:"i-mdi-loading animate-spin mr-1"},null,-1)),m[5]||(m[5]=f(" Searching... ",-1))],64)):(n(),r(V,{key:1},[m[6]||(m[6]=t("div",{class:"i-mdi-magnify mr-1"},null,-1)),m[7]||(m[7]=f(" Search ",-1))],64))]),_:2},1032,["disabled","onClick"])])]))),128))])])]),a(o)!==null?(n(),r("div",Ot,' Searching MusicBrainz for "'+p(c.parsedTitles[a(o)]?.artist)+" - "+p(c.parsedTitles[a(o)]?.title)+'"... ',1)):k("",!0),a(d)?(n(),r("div",Bt,p(a(d)),1)):k("",!0)])):k("",!0)}}}),jt=Object.assign(Ut,{__name:"AdminSearchForm"}),Nt={key:0,class:"space-y-2"},Ht=["onClick"],It={class:"text-xs font-medium text-primary-4 line-clamp-1"},Kt={class:"text-xs text-primary-3 line-clamp-1"},Qt={class:"flex justify-between items-center mt-1"},Yt={class:"text-xs text-primary-3"},qt={class:"text-xs text-accent"},Jt=j({__name:"AdminSearchResultsSelection",props:{videoId:{},searchResults:{default:void 0}},emits:["matchComplete","matchError","cancel"],setup(c,{emit:g}){const u=c,l=g,o=y(!1),d=async b=>{o.value=!0;try{const v=await $fetch("/api/metadata/musicbrainz",{method:"POST",body:{videoId:u.videoId,mbid:b}});v.success&&v.data?l("matchComplete",v.data):l("matchError","Failed to match recording")}catch(v){const S=v instanceof Error?v.message:"Unknown error occurred";l("matchError",`Error matching recording: ${S}`)}finally{o.value=!1}},w=()=>{l("cancel")};return(b,v)=>{const S=N;return c.searchResults?.length?(n(),r("div",Nt,[v[2]||(v[2]=t("div",{class:"text-xs font-medium text-primary-4 mb-2"}," Select best match: ",-1)),(n(!0),r(V,null,z(c.searchResults.slice(0,3),x=>(n(),r("div",{key:x.id,class:J(["bg-primary-2 p-2 rounded cursor-pointer hover:bg-primary-3/20 transition-colors",{"opacity-50 pointer-events-none":a(o)}]),onClick:m=>d(x.id)},[t("div",It,p(x.title),1),t("div",Kt," by "+p(x.artist),1),t("div",Qt,[t("span",Yt,p(x.releaseCount)+" release"+p(x.releaseCount!==1?"s":""),1),t("span",qt,p(x.score)+"%",1)])],10,Ht))),128)),a(o)?(n(),B(S,{key:0,size:"small",variant:"ghost",disabled:"",class:"text-xs"},{default:C(()=>[...v[0]||(v[0]=[f(" Matching... ",-1)])]),_:1})):(n(),B(S,{key:1,size:"small",variant:"ghost",class:"text-xs",onClick:w},{default:C(()=>[...v[1]||(v[1]=[f(" Cancel ",-1)])]),_:1}))])):k("",!0)}}}),Wt=Object.assign(Jt,{__name:"AdminSearchResultsSelection"});function M(c){return c.replace(/\s*\((Original\s+Mix|Radio\s+Edit|Extended\s+Mix|Club\s+Mix|Remix|Remaster|Remastered|Version)\)\s*/gi,"").replace(/\s*[-â€“~|:]\s*$/,"").replace(/^\s*[-â€“~|:]\s*/,"").replace(/\s*[()\[\]{}]\s*$/,"").replace(/^\s*[()\[\]{}]\s*/,"").replace(/\s*[,;.!?]\s*$/,"").replace(/\s*[-â€“~|:]\s*[-â€“~|:]\s*/g," - ").replace(/\s+/g," ").trim()}function Xt(c){const g=[],u=Zt(c);let l=u.match(/^(.+?)\s*[-â€“]\s*([^-â€“]+?)(?:\s*[-â€“].*)?$/);if(l&&l[1]&&l[2]){const[,o,d]=l;g.push({artist:M(o),title:M(d),confidence:.9})}if(l=u.match(/^(.+?)\s*~\s*(.+?)(?:\s*~.*)?$/),l&&l[1]&&l[2]){const[,o,d]=l;g.push({artist:M(o),title:M(d),confidence:.85})}if(l=u.match(/^([^-]+?)\s*-\s*([^-]+?)(?:\s*-.*)?$/),l&&l[1]&&l[2]){const[,o,d]=l,w=["live","version","remix","cover","acoustic","instrumental","edit","remaster","demo","alternate","extended","radio","single"],b=["feat","ft","featuring","vs","x","with","and","&"],v=w.some($=>o.toLowerCase().includes($)),S=b.some($=>d.toLowerCase().includes($)),x=d.length<25&&d.split(" ").length<=3&&!/[()[\]]/.test(d);(v||x&&!S&&d.length<o.length*.7)&&g.push({artist:M(d),title:M(o),confidence:.75})}if(l=u.match(/^(.+?)\s*:\s*(.+)$/),l&&l[1]&&l[2]){const[,o,d]=l;g.push({artist:M(o),title:M(d),confidence:.8})}if(l=u.match(/^(.+?)\s*\|\s*([^|]+?)(?:\s*\|.*)?$/),l&&l[1]&&l[2]){const[,o,d]=l;g.push({artist:M(o),title:M(d),confidence:.8})}if(l=u.match(/^(.+?)\s*["'"](.+?)["'"].*$/),l&&l[1]&&l[2]){const[,o,d]=l;g.push({artist:M(o),title:M(d),confidence:.85})}if(l=u.match(/^(.+?)\s+([A-Z\s]{3,})(?:\s|$)/),l&&l[1]&&l[2]){const[,o,d]=l;d.trim().split(" ").length<=5&&g.push({artist:M(o),title:M(d),confidence:.7})}return g.length===0&&g.push({artist:"Unknown Artist",title:M(u||c),confidence:.1}),g.sort((o,d)=>d.confidence-o.confidence)}function Zt(c){return c.replace(/\s*\[Official Music Video\]/gi,"").replace(/\s*\[4K Remaster\]/gi,"").replace(/\s*\[(Official|Music|Video|Audio|Lyric|Live|HD|4K|HQ|MV)\s?(Video|Audio|Music|Performance|MV)?\]/gi,"").replace(/\s*\((Official|Music|Video|Audio|Lyric|Live|HD|4K|HQ|MV)\s?(Video|Audio|Music|Performance|MV)?\)/gi,"").replace(/\s*\(\d{4}\)/g,"").replace(/\s*\/\d{4}\/\s*/g,"").replace(/\s*\((Stereo|Mono|Remastered?|Remaster|\d{4}\s*Remaster(ed)?)\)/gi,"").replace(/\s*\[(Stereo|Mono|Remastered?|Remaster|\d{4}\s*Remaster(ed)?)\]/gi,"").replace(/\s*\b(HD|4K|1080p|720p|HQ|High Quality)\b/gi,"").replace(/\s*[fF]t\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*[Ff]eat\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*[Ff]eaturing\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*\([^)]*\)/g,"").replace(/\s+/g," ").trim()}function Gt(c){return M(c.replace(/\s*(Official|Music|VEVO|Records|Entertainment)$/gi,"").replace(/\s*-.*$/,"").trim())}const te={class:"rounded-lg shadow-sm"},ee={class:"flex items-center justify-between mb-4"},se={class:"text-lg font-semibold flex items-center gap-2"},le={key:0,class:"text-center py-8"},ae={key:1,class:"overflow-x-auto"},ie={class:"w-full border-collapse"},ne={class:"border-b border-primary-2/30 hover:bg-bg-gradient transition-colors"},oe={class:"p-3"},re={class:"flex items-center gap-3"},de={class:"flex-shrink-0"},ce=["src","alt"],ue={class:"flex-1 min-w-0"},me={class:"font-medium text-primary-4 line-clamp-2 text-sm"},pe=["href"],ge={class:"p-3"},fe={class:"text-sm text-primary-3"},he={class:"p-3"},ye={class:"text-sm text-primary-3 font-mono"},ve={class:"p-3"},xe={class:"min-w-48"},be={key:0,class:"text-xs text-primary-3"},_e={class:"p-3"},$e={class:"flex flex-wrap items-center gap-2"},ke={key:0,class:"border-b border-primary-2/30"},we={colspan:"5",class:"p-3 space-y-4"},Ce=j({__name:"AdminVideoList",props:{videos:{default:()=>[]}},setup(c){const g=c,u=y({}),l=y({}),o=y({}),d=y({}),w=async()=>{if(g.videos.length!==0)try{const i=await $fetch("/api/metadata/all",{method:"POST"}),s=g.videos.map(D=>D.id),A={};for(const D of s)i[D]&&(A[D]=i[D]);u.value={...u.value,...A}}catch(i){console.warn("Failed to load existing song data:",i)}};W(async()=>{await w()});const b=(i,s)=>{u.value[i]=s,delete l.value[i],delete o.value[i]},v=i=>{console.error("Match error:",i)},S=(i,s)=>{l.value[i]=s},x=i=>{console.error("Search error:",i)},m=i=>{delete l.value[i],delete o.value[i]},$=i=>{const s=Xt(i.title);if(s.length===0||s.length===1&&s[0]&&s[0].confidence<=.1){const D={artist:Gt(i.channel)||"Unknown Artist",title:i.title,confidence:.2};s.length===0?s.push(D):s[0]=D}o.value[i.id]=s},P=i=>{delete o.value[i]},L=i=>{delete u.value[i],delete l.value[i],delete o.value[i]},F=async i=>{try{d.value[i]=!0;const s=await $fetch("/api/musicbrainz/artist-tags",{method:"POST",body:{youtubeId:i}});s.success&&s.data&&(u.value[i]=s.data)}catch(s){console.error("Error fetching artist tags:",s)}finally{delete d.value[i]}},O=async i=>{try{d.value[i]=!0;const s=await $fetch("/api/metadata/odesli",{method:"POST",body:{youtubeId:i}});u.value[i]=s}catch(s){console.error("Error augmenting with Odesli:",s)}finally{delete d.value[i]}},U=async i=>{try{d.value[i]=!0;const s=u.value[i];if(!s?.artist||!s?.title){console.error("Cannot augment with Last.fm: missing artist or title");return}const A=await $fetch("/api/metadata/lastfm",{method:"POST",body:{youtubeId:i,artist:s.artist,title:s.title}});u.value[i]=A}catch(s){console.error("Error augmenting with Last.fm:",s)}finally{delete d.value[i]}};return(i,s)=>{const A=$t,D=N,R=jt,h=Wt;return n(),r("div",te,[t("div",ee,[t("h3",se,[s[2]||(s[2]=t("div",{class:"i-mdi-playlist-music"},null,-1)),f(" Video List ("+p(c.videos.length)+" videos) ",1)])]),c.videos.length?(n(),r("div",ae,[t("table",ie,[s[7]||(s[7]=t("thead",null,[t("tr",{class:"border-b border-primary-2"},[t("th",{class:"text-left p-3 font-medium text-primary-4"},"Video"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Channel"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Duration"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Music Data"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Actions")])],-1)),t("tbody",null,[(n(!0),r(V,null,z(c.videos,e=>(n(),r(V,{key:e.id},[t("tr",ne,[t("td",oe,[t("div",re,[t("div",de,[t("img",{src:`https://i.ytimg.com/vi/${e.id}/hqdefault.jpg`,alt:e.title,class:"w-12 h-12 rounded-full object-cover bg-primary-1"},null,8,ce)]),t("div",ue,[t("h4",me,p(e.title),1),t("a",{href:`https://www.youtube.com/watch?v=${e.id}`,target:"_blank",rel:"noopener noreferrer",class:"text-xs text-primary-3 hover:text-accent transition-colors"}," Watch on YouTube ",8,pe)])])]),t("td",ge,[t("span",fe,p(e.channel),1)]),t("td",he,[t("span",ye,p(e.duration),1)]),t("td",ve,[t("div",xe,[T(A,{"song-data":a(u)[e.id]},null,8,["song-data"]),!a(u)[e.id]&&!a(l)[e.id]?.length&&!a(o)[e.id]?.length?(n(),r("div",be)):k("",!0)])]),t("td",_e,[t("div",$e,[!a(u)[e.id]&&!a(o)[e.id]?.length?(n(),B(D,{key:0,icon:"i-mdi-text-search",size:"small",variant:"ghost",onClick:_=>$(e)},{default:C(()=>[...s[4]||(s[4]=[f(" Search ",-1)])]),_:1},8,["onClick"])):k("",!0),a(u)[e.id]&&!a(u)[e.id]?.artistTags?.length&&!a(u)[e.id]?.tags?.length?(n(),B(D,{key:1,icon:"i-mdi-tag-plus",size:"small",variant:"ghost",disabled:a(d)[e.id],onClick:_=>F(e.id)},{default:C(()=>[...s[5]||(s[5]=[f(" Add Artist Tags ",-1)])]),_:1},8,["disabled","onClick"])):k("",!0),T(D,{icon:"i-mdi-cloud-sync",size:"small",variant:"ghost",disabled:a(d)[e.id],onClick:_=>O(e.id)},{default:C(()=>[f(p(a(d)[e.id]?"Augmenting...":"Odesli"),1)]),_:2},1032,["disabled","onClick"]),T(D,{icon:"i-mdi-database-search",size:"small",variant:"ghost",disabled:a(d)[e.id]||!a(u)[e.id]?.artist||!a(u)[e.id]?.title,onClick:_=>U(e.id)},{default:C(()=>[f(p(a(d)[e.id]?"Augmenting...":"Last.fm"),1)]),_:2},1032,["disabled","onClick"]),a(u)[e.id]?(n(),B(D,{key:2,icon:"i-mdi-delete",size:"small",variant:"ghost",onClick:_=>L(e.id)},{default:C(()=>[...s[6]||(s[6]=[f(" Clear ",-1)])]),_:1},8,["onClick"])):k("",!0)])])]),a(o)[e.id]?.length||a(l)[e.id]?.length?(n(),r("tr",ke,[t("td",we,[a(o)[e.id]?.length?(n(),B(R,{key:0,"video-id":e.id,"parsed-titles":a(o)[e.id],onSearchComplete:_=>S(e.id,_),onSearchError:s[0]||(s[0]=_=>x(_)),onCancel:_=>P(e.id)},null,8,["video-id","parsed-titles","onSearchComplete","onCancel"])):k("",!0),a(l)[e.id]?.length?(n(),B(h,{key:1,"video-id":e.id,"search-results":a(l)[e.id],onMatchComplete:_=>b(e.id,_),onMatchError:s[1]||(s[1]=_=>v(_)),onCancel:_=>m(e.id)},null,8,["video-id","search-results","onMatchComplete","onCancel"])):k("",!0)])])):k("",!0)],64))),128))])])])):(n(),r("div",le,[...s[3]||(s[3]=[t("div",{class:"i-mdi-video-outline text-4xl mb-2"},null,-1),t("p",{class:""},"No videos found in this playlist.",-1)])]))])}}}),Te=Object.assign(Ce,{__name:"AdminVideoList"}),Se={class:"rounded-lg shadow-sm"},De={class:"flex items-center justify-between mb-4"},Ae={key:0,class:"text-center py-8"},Ee={key:1,class:"rounded-lg p-4 mb-6 bg-red-900/20 border border-red-500/30"},Me={class:"flex items-center gap-2 text-red-400"},Pe={key:2,class:"space-y-6"},Le={key:0,class:"rounded-lg p-4 bg-green-900/20 border border-green-500/30"},Ve={class:"flex items-center gap-2 text-green-400"},Re={class:"flex gap-4 text-sm"},Fe={class:"flex items-center gap-2"},ze={class:"flex items-center gap-2"},Oe={class:"mb-4"},Be={class:"text-lg font-medium mb-3 flex items-center gap-2"},Ue={key:0,class:"text-center py-8"},je={key:1,class:"flex flex-wrap gap-2 max-h-96 overflow-y-auto p-4 bg-primary-1 rounded-lg"},Ne=["onClick"],He={class:"text-lg font-medium mb-3 flex items-center gap-2"},Ie={key:0,class:"text-center py-8"},Ke={class:""},Qe={key:1,class:"flex flex-wrap gap-2 max-h-96 overflow-y-auto p-4 bg-red-900/10 rounded-lg border border-red-500/20"},Ye=["onClick"],qe={class:"flex items-center gap-3 pt-4 border-t border-primary-2"},Je=j({__name:"AdminTagBlacklist",setup(c){const g=y(!0),u=y(!1),l=y(""),o=y(""),d=y(""),w=y([]),b=y([]),v=y([]),S=I(()=>{const i=d.value.toLowerCase().trim(),s=w.value.filter(A=>!b.value.includes(A));return i?s.filter(A=>A.toLowerCase().includes(i)):s}),x=I(()=>{const i=d.value.toLowerCase().trim();return i?b.value.filter(s=>s.toLowerCase().includes(i)):b.value}),m=I(()=>{const i=[...b.value].sort(),s=[...v.value].sort();return JSON.stringify(i)!==JSON.stringify(s)}),$=async()=>{try{g.value=!0,l.value="",o.value="";const i=await $fetch("/api/playlists/tags");if(i.success)w.value=i.data.availableTags,b.value=[...i.data.blacklistedTags],v.value=[...i.data.blacklistedTags];else throw new Error("Failed to load tags")}catch(i){console.error("Error loading tags:",i),l.value=i.message||"Failed to load tags"}finally{g.value=!1}},P=i=>{b.value.includes(i)||(b.value.push(i),b.value.sort()),U()},L=i=>{const s=b.value.indexOf(i);s>-1&&b.value.splice(s,1),U()},F=async()=>{try{u.value=!0,l.value="",o.value="";const i=await $fetch("/api/playlists/tags",{method:"POST",body:{blacklistedTags:b.value}});if(i.success)v.value=[...b.value],o.value=i.message;else throw new Error("Failed to save blacklist")}catch(i){console.error("Error saving blacklist:",i),l.value=i.data?.message||i.message||"Failed to save blacklist"}finally{u.value=!1}},O=()=>{b.value=[...v.value],U()},U=()=>{l.value="",o.value=""};return X(async()=>{await $()}),(i,s)=>{const A=N,D=q;return n(),r("div",Se,[t("div",De,[s[2]||(s[2]=t("h2",{class:"text-xl font-semibold flex items-center gap-2"},[t("div",{class:"i-mdi-tag-multiple"}),f(" Tag Blacklist Management ")],-1)),T(A,{icon:"i-mdi-refresh",size:"small",loading:a(g),onClick:$},{default:C(()=>[...s[1]||(s[1]=[f(" Refresh ",-1)])]),_:1},8,["loading"])]),a(g)?(n(),r("div",Ae,[...s[3]||(s[3]=[t("div",{class:"i-mdi-loading animate-spin text-2xl mb-2"},null,-1),t("p",{class:""},"Loading tags...",-1)])])):a(l)?(n(),r("div",Ee,[t("div",Me,[s[4]||(s[4]=t("div",{class:"i-mdi-alert-circle"},null,-1)),s[5]||(s[5]=t("strong",null,"Error:",-1)),f(" "+p(a(l)),1)])])):(n(),r("div",Pe,[a(o)?(n(),r("div",Le,[t("div",Ve,[s[6]||(s[6]=t("div",{class:"i-mdi-check-circle"},null,-1)),s[7]||(s[7]=t("strong",null,"Success:",-1)),f(" "+p(a(o)),1)])])):k("",!0),t("div",Re,[t("div",Fe,[s[8]||(s[8]=t("div",{class:"i-mdi-tag text-primary-3"},null,-1)),t("span",null,p(a(w).length)+" total tags",1)]),t("div",ze,[s[9]||(s[9]=t("div",{class:"i-mdi-block-helper text-red-400"},null,-1)),t("span",null,p(a(b).length)+" blacklisted",1)])]),t("div",Oe,[T(D,{id:"tagFilter",modelValue:a(d),"onUpdate:modelValue":s[0]||(s[0]=R=>Z(d)?d.value=R:null),label:"Filter tags",placeholder:"Search tags...",icon:"i-mdi-magnify",class:"max-w-md"},null,8,["modelValue"])]),t("div",null,[t("h3",Be,[s[10]||(s[10]=t("div",{class:"i-mdi-tag-outline"},null,-1)),f(" Available Tags ("+p(a(S).length)+") ",1)]),a(S).length===0?(n(),r("div",Ue,[...s[11]||(s[11]=[t("div",{class:"i-mdi-tag-off text-4xl mb-2"},null,-1),t("p",{class:""},"No tags found matching your filter.",-1)])])):(n(),r("div",je,[(n(!0),r(V,null,z(a(S),R=>(n(),r("button",{key:R,class:"inline-flex items-center gap-1 px-3 py-1 text-sm rounded-full transition-colors bg-primary-2 text-primary-4 hover:bg-red-600 hover:text-white border border-primary-3",onClick:h=>P(R)},[f(p(R)+" ",1),s[12]||(s[12]=t("div",{class:"i-mdi-plus text-xs"},null,-1))],8,Ne))),128))]))]),t("div",null,[t("h3",He,[s[13]||(s[13]=t("div",{class:"i-mdi-block-helper text-red-400"},null,-1)),f(" Blacklisted Tags ("+p(a(x).length)+") ",1)]),a(x).length===0?(n(),r("div",Ie,[s[14]||(s[14]=t("div",{class:"i-mdi-tag-check text-4xl mb-2"},null,-1)),t("p",Ke," No blacklisted tags"+p(a(d)?" matching your filter":"")+". ",1)])):(n(),r("div",Qe,[(n(!0),r(V,null,z(a(x),R=>(n(),r("button",{key:R,class:"inline-flex items-center gap-1 px-3 py-1 text-sm rounded-full transition-colors bg-red-600 text-white hover:bg-green-600 border border-red-500",onClick:h=>L(R)},[f(p(R)+" ",1),s[15]||(s[15]=t("div",{class:"i-mdi-close text-xs"},null,-1))],8,Ye))),128))]))]),t("div",qe,[T(A,{icon:"i-mdi-content-save",loading:a(u),disabled:!a(m),onClick:F},{default:C(()=>[...s[16]||(s[16]=[f(" Save Changes ",-1)])]),_:1},8,["loading","disabled"]),T(A,{icon:"i-mdi-undo",variant:"ghost",disabled:!a(m),onClick:O},{default:C(()=>[...s[17]||(s[17]=[f(" Reset Changes ",-1)])]),_:1},8,["disabled"])])]))])}}}),We=Object.assign(Je,{__name:"AdminTagBlacklist"}),Xe={class:"p-8 max-w-6xl mx-auto"},Ze={class:"flex items-center justify-between mb-8"},Ge={class:"flex flex-col gap-6"},ts={class:"rounded-lg mb-8 shadow-sm"},es={key:0,class:"rounded-lg p-4 mb-8"},ss={class:"flex items-center gap-2"},ls={key:1,class:"rounded-lg p-4 mb-8"},as={class:"flex items-center gap-2"},is={class:"rounded-lg shadow-sm"},ns={class:"flex items-center justify-between mb-4"},os={key:0,class:"text-center py-8"},rs={key:1,class:"text-center py-8"},ds={key:2,class:"space-y-4"},cs={class:"flex-1"},us={class:"font-medium text-primary-3"},ms={class:"text-sm"},ps={key:0,class:"text-xs mt-1 line-clamp-2"},gs={class:"flex items-center gap-2 ml-4"},fs={key:2,class:"rounded-lg shadow-sm"},hs={class:"flex items-center justify-between mb-4"},ys={class:"text-xl font-semibold flex items-center gap-2"},vs={key:0,class:"text-center py-8"},xs={key:2,class:"text-center py-8"},Cs=j({__name:"admin",setup(c){nt({title:"Admin Panel - Music Playlist View",meta:[{name:"description",content:"Manage your YouTube playlists"}]});const g=y(""),u=y(!1),l=y(""),o=y(""),d=y([]),w=y(!0),b=y(null),v=y(null),S=y(null),x=y(null),m=y(null),$=y([]),P=y(!1);X(async()=>{await O()});const L=h=>{const e=h.trim(),_=e.match(/[?&]list=([a-zA-Z0-9_-]+)/);return _&&_[1]?_[1]:e},F=async()=>{if(g.value.trim()){u.value=!0,l.value="",o.value="";try{const h=L(g.value);if(!h)throw new Error("Invalid playlist ID or URL");const e=await $fetch(`/api/playlists/${h}`);if(e.success)o.value=`Successfully loaded playlist: ${e.data.title}`,g.value="",await O();else throw new Error("Failed to fetch playlist")}catch(h){console.error("Error fetching playlist:",h),l.value=h.data?.message||h.message||"Failed to fetch playlist. Please check the playlist ID and try again."}finally{u.value=!1}}},O=async()=>{try{w.value=!0;const h=await $fetch("/index.json");h.success&&(d.value=h.data)}catch(h){console.error("Error loading cached playlists:",h)}finally{w.value=!1}},U=async h=>{try{b.value=h;const e=await $fetch(`/api/playlists/${h}`);e.success&&(await O(),o.value=`Successfully updated playlist: ${e.data.title}`,l.value="")}catch(e){console.error("Error refreshing playlist:",e),l.value="Failed to refresh playlist",o.value=""}finally{b.value=null}},i=async h=>{if(confirm("Are you sure you want to delete this cached playlist?"))try{v.value=h,await $fetch(`/api/playlists/${h}`,{method:"DELETE"}),await O(),o.value="Successfully deleted cached playlist",l.value=""}catch(e){console.error("Error deleting playlist:",e),l.value="Failed to delete playlist",o.value=""}finally{v.value=null}},s=h=>new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),A=async h=>{try{S.value=h.id,P.value=!0;const e=await $fetch(`/playlist/${h.fileName}`);if(e)m.value=h,$.value=e.videos||[];else throw new Error("Failed to load playlist videos")}catch(e){console.error("Error loading playlist for editing:",e),l.value="Failed to load playlist videos",o.value=""}finally{S.value=null,P.value=!1}},D=()=>{m.value=null,$.value=[]},R=async h=>{try{x.value=h,l.value="",o.value="";const e=await $fetch("/api/playlists/update-data",{method:"POST",body:{playlistId:h}});if(e.success)o.value=e.message,await O();else throw new Error("Failed to update playlist music data")}catch(e){console.error("Error updating playlist music data:",e),l.value=e.data?.message||e.message||"Failed to update playlist music data",o.value=""}finally{x.value=null}};return(h,e)=>{const _=N,G=q,tt=Te,et=We;return n(),r("div",Xe,[t("div",Ze,[e[2]||(e[2]=t("h1",{class:"text-3xl font-bold flex items-center gap-3"},[t("div",{class:"i-mdi-cog"}),f(" Admin Panel ")],-1)),T(_,{icon:"i-mdi-arrow-left",variant:"primary",to:"/"},{default:C(()=>[...e[1]||(e[1]=[f(" Back to Playlists ",-1)])]),_:1})]),t("div",Ge,[t("div",ts,[e[3]||(e[3]=t("h2",{class:"text-xl font-semibold mb-4 flex items-center gap-2"},[t("div",{class:"i-mdi-plus"}),f(" Add New Playlist ")],-1)),t("form",{class:"space-y-4",onSubmit:K(F,["prevent"])},[T(G,{id:"playlistId",modelValue:a(g),"onUpdate:modelValue":e[0]||(e[0]=E=>Z(g)?g.value=E:null),label:"YouTube Playlist ID or URL",placeholder:"Enter playlist ID (e.g., PLrAXtmRdnEQy8VVXvSgb5eKzwJJxd0FMz) or full URL",class:"max-w-xl","help-text":"You can paste either the playlist ID or the full YouTube playlist URL",disabled:a(u),required:""},null,8,["modelValue","disabled"]),T(_,{type:"submit",icon:"i-mdi-download",size:"medium",disabled:!a(g).trim(),loading:a(u),"show-text-while-loading":!0},{default:C(()=>[f(p(a(u)?"Loading...":"Load Playlist"),1)]),_:1},8,["disabled","loading"])],32)]),a(o)?(n(),r("div",es,[t("div",ss,[e[4]||(e[4]=t("div",{class:"i-mdi-check-circle"},null,-1)),e[5]||(e[5]=t("strong",null,"Success:",-1)),f(" "+p(a(o)),1)])])):k("",!0),a(l)?(n(),r("div",ls,[t("div",as,[e[6]||(e[6]=t("div",{class:"i-mdi-alert-circle"},null,-1)),e[7]||(e[7]=t("strong",null,"Error:",-1)),f(" "+p(a(l)),1)])])):k("",!0),t("div",is,[t("div",ns,[e[9]||(e[9]=t("h2",{class:"text-xl font-semibold flex items-center gap-2"},[t("div",{class:"i-mdi-playlist-play"}),f(" Cached Playlists ")],-1)),T(_,{icon:"i-mdi-refresh",size:"small",loading:a(w),onClick:O},{default:C(()=>[...e[8]||(e[8]=[f(" Refresh ",-1)])]),_:1},8,["loading"])]),a(w)?(n(),r("div",os,[...e[10]||(e[10]=[t("div",{class:"i-mdi-loading animate-spin text-2xl mb-2"},null,-1),t("p",{class:""},"Loading cached playlists...",-1)])])):a(d).length?(n(),r("div",ds,[(n(!0),r(V,null,z(a(d),E=>(n(),r("div",{key:E.id,class:"flex items-center justify-between rounded-lg hover:bg-bg-gradient py-6"},[t("div",cs,[t("h3",us,p(E.title),1),t("p",ms,p(E.videoCount)+" videos â€¢ Last updated: "+p(s(E.lastFetched)),1),E.description?(n(),r("p",ps,p(E.description),1)):k("",!0)]),t("div",gs,[T(_,{icon:"i-mdi-database-plus",size:"small",variant:"primary",loading:a(x)===E.id,onClick:H=>R(E.id)},{default:C(()=>[...e[12]||(e[12]=[f(" Update All Music Data ",-1)])]),_:1},8,["loading","onClick"]),T(_,{icon:"i-mdi-pencil",size:"small",variant:"secondary",loading:a(S)===E.id,onClick:H=>A(E)},{default:C(()=>[...e[13]||(e[13]=[f(" Edit ",-1)])]),_:1},8,["loading","onClick"]),T(_,{icon:"i-mdi-refresh",size:"small",loading:a(b)===E.id,onClick:H=>U(E.id)},{default:C(()=>[...e[14]||(e[14]=[f(" Update ",-1)])]),_:1},8,["loading","onClick"]),T(_,{icon:"i-mdi-delete",size:"small",variant:"danger",loading:a(v)===E.id,onClick:H=>i(E.id)},{default:C(()=>[...e[15]||(e[15]=[f(" Delete ",-1)])]),_:1},8,["loading","onClick"])])]))),128))])):(n(),r("div",rs,[...e[11]||(e[11]=[t("div",{class:"i-mdi-playlist-remove text-4xl mb-2"},null,-1),t("p",{class:""},"No cached playlists found.",-1)])]))]),a(m)?(n(),r("div",fs,[t("div",hs,[t("h2",ys,[e[16]||(e[16]=t("div",{class:"i-mdi-pencil"},null,-1)),f(" Editing: "+p(a(m).title),1)]),T(_,{icon:"i-mdi-close",size:"small",variant:"ghost",onClick:D},{default:C(()=>[...e[17]||(e[17]=[f(" Close ",-1)])]),_:1})]),a(P)?(n(),r("div",vs,[...e[18]||(e[18]=[t("div",{class:"i-mdi-loading animate-spin text-2xl mb-2"},null,-1),t("p",{class:""},"Loading playlist videos...",-1)])])):a($).length?(n(),B(tt,{key:1,videos:a($)},null,8,["videos"])):(n(),r("div",xs,[...e[19]||(e[19]=[t("div",{class:"i-mdi-video-off text-4xl mb-2"},null,-1),t("p",{class:""},"No videos found in this playlist.",-1)])]))])):k("",!0),T(et)])])}}});export{Cs as default};
