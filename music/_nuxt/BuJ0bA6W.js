import{_ as M}from"./B4hImmCI.js";import{e as $,c as h,f as G,o as v,a as n,b as m,t as Y,w as g,g as X,x as V,y as Z,m as ee,A as te,B as ae,k as ne,j as r,l as oe}from"./BoYY0jN1.js";import{u as q}from"./Fu4FK5OI.js";import"./CZSfC71C.js";const le={key:0,class:"fixed bottom-0 left-1/2 transform -translate-x-1/2 z-40 bg-primary-1 p-4 max-w-9xl rounded-xl mb-3"},se={class:"max-w-7xl mx-auto flex items-center gap-4"},ie=["src","alt"],re={class:"flex-1 min-w-0"},de={class:"text-primary-4 font-medium text-sm line-clamp-1"},ce={class:"text-primary-3 text-xs line-clamp-1"},ue={class:"flex items-center gap-2"},ye={key:0,class:"i-mdi-pause w-5 h-5"},pe={key:1,class:"i-mdi-play w-5 h-5"},me={class:"text-primary-3 text-xs flex-shrink-0 hidden sm:block"},ve=$({__name:"VideoPlayerBar",props:{currentVideo:{default:null},isPlaying:{type:Boolean,default:!1},canPlayPrevious:{type:Boolean,default:!1},canPlayNext:{type:Boolean,default:!1}},emits:["togglePlayPause","previous","next","close"],setup(l,{emit:c}){const a=c,u=()=>{a("togglePlayPause")},i=()=>{a("previous")},y=()=>{a("next")},f=()=>{a("close")};return(P,s)=>{const d=M;return l.currentVideo?(v(),h("div",le,[n("div",se,[n("img",{src:l.currentVideo.thumbnail,alt:l.currentVideo.title,class:"w-12 h-9 object-cover rounded flex-shrink-0"},null,8,ie),n("div",re,[n("h3",de,Y(l.currentVideo.title),1),n("p",ce,Y(l.currentVideo.channel),1)]),n("div",ue,[m(d,{variant:"secondary",onClick:i,disabled:!l.canPlayPrevious,class:"!p-2"},{default:g(()=>[...s[0]||(s[0]=[n("div",{class:"i-mdi-skip-previous w-4 h-4"},null,-1)])]),_:1},8,["disabled"]),m(d,{variant:"primary",onClick:u,class:"!p-2"},{default:g(()=>[l.isPlaying?(v(),h("div",ye)):(v(),h("div",pe))]),_:1}),m(d,{variant:"secondary",onClick:y,disabled:!l.canPlayNext,class:"!p-2"},{default:g(()=>[...s[1]||(s[1]=[n("div",{class:"i-mdi-skip-next w-4 h-4"},null,-1)])]),_:1},8,["disabled"])]),n("div",me,Y(l.currentVideo.duration),1),m(d,{variant:"ghost",onClick:f,class:"!p-2"},{default:g(()=>[...s[2]||(s[2]=[n("div",{class:"i-mdi-close text-xl"},null,-1)])]),_:1})])])):G("",!0)}}}),fe=Object.assign(ve,{__name:"VideoPlayerBar"}),Pe={key:0,class:"fixed top-20 sm:top-1/2 left-1/2 sm:left-auto right-auto sm:right-4 z-50 w-full max-w-xs -translate-x-1/2 sm:translate-x-0 sm:-translate-y-1/2"},ge={class:"bg-primary-1 rounded-2xl shadow-xl overflow-hidden"},he={class:"absolute top-2 right-2"},we={class:"p-4"},xe={class:"aspect-video bg-black rounded-2xl overflow-hidden"},_e=$({__name:"VideoPlayer",props:{isOpen:{type:Boolean,default:!1},playlist:{default:()=>[]},initialVideoIndex:{default:0}},emits:["close","videoChange"],setup(l,{emit:c}){const a=l,u=c,{currentVideo:i,currentIndex:y,isPlaying:f,isPlayerReady:P,playlist:s,canPlayNext:d,setIsPlaying:p,setIsPlayerReady:w,setPlaylist:C,setCurrentIndex:k,previousVideo:E,nextVideo:x,closePlayer:N,initializeGlobalPlayer:B}=q(),_=X();let t=null;V([()=>a.playlist,()=>a.initialVideoIndex],([e,o])=>{e&&e.length>0&&(C(e),o!==void 0&&k(o))},{immediate:!0}),V(()=>a.isOpen,e=>{e?Z(()=>{T()}):O()}),V([i,y],([e,o])=>{e&&(J(),u("videoChange",e,o))}),V(()=>a.isOpen,e=>{e&&s.value.length>0&&B(s.value,y.value)});const T=()=>{if(i.value){if(window.YT&&window.YT.Player)b();else if(!window.onYouTubeIframeAPIReady){const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";const o=document.getElementsByTagName("script")[0];o&&o.parentNode?o.parentNode.insertBefore(e,o):document.head.appendChild(e),window.onYouTubeIframeAPIReady=()=>{b()}}}},b=()=>{!_.value||!i.value||(O(),t=new window.YT.Player("youtube-player",{height:"100%",width:"100%",videoId:i.value.id,playerVars:{autoplay:1,controls:1,modestbranding:1,rel:0,showinfo:0},events:{onReady:I,onStateChange:H}}))},I=()=>{w(!0),p(!0)},H=e=>{const o=e.data,A=0,Q=1,W=2;switch(o){case Q:p(!0);break;case W:p(!1);break;case A:p(!1),d.value&&x();break}},J=()=>{!t||!P.value||!i.value||t.loadVideoById(i.value.id)},O=()=>{t&&typeof t.destroy=="function"&&(t.destroy(),t=null,w(!1))},L=()=>{N(),u("close")},D=()=>{!t||!P.value||(f.value?t.pauseVideo():t.playVideo())},R=()=>{E()},S=()=>{x()},z=e=>{if(a.isOpen)switch(e.code){case"Escape":L();break;case"Space":e.preventDefault(),D();break;case"ArrowLeft":e.preventDefault(),R();break;case"ArrowRight":e.preventDefault(),S();break}},j=()=>{a.isOpen&&D()},F=()=>{a.isOpen&&R()},U=()=>{a.isOpen&&S()},K=()=>{a.isOpen&&L()};return ee(()=>{document.addEventListener("keydown",z),window.addEventListener("globalPlayerToggle",j),window.addEventListener("globalPlayerPrevious",F),window.addEventListener("globalPlayerNext",U),window.addEventListener("globalPlayerClose",K)}),te(()=>{document.removeEventListener("keydown",z),window.removeEventListener("globalPlayerToggle",j),window.removeEventListener("globalPlayerPrevious",F),window.removeEventListener("globalPlayerNext",U),window.removeEventListener("globalPlayerClose",K),O()}),(e,o)=>{const A=M;return l.isOpen?(v(),h("div",Pe,[n("div",ge,[n("div",he,[m(A,{variant:"ghost",onClick:L,class:"!p-2"},{default:g(()=>[...o[0]||(o[0]=[n("div",{class:"i-mdi-close w-5 h-5"},null,-1)])]),_:1})]),n("div",we,[n("div",xe,[n("div",{ref_key:"playerContainer",ref:_,id:"youtube-player",class:"w-full h-full"},null,512)])])])])):G("",!0)}}}),be=Object.assign(_e,{__name:"VideoPlayer"}),Ne=$({__name:"default",setup(l){const{showPlayerBar:c,currentVideo:a,currentIndex:u,playlist:i,isPlaying:y,canPlayPrevious:f,canPlayNext:P,isFloatingPlayerOpen:s,previousVideo:d,nextVideo:p,closePlayer:w,closeFloatingPlayer:C}=q(),k=()=>{const t=new CustomEvent("globalPlayerToggle");window.dispatchEvent(t)},E=()=>{d();const t=new CustomEvent("globalPlayerPrevious");window.dispatchEvent(t)},x=()=>{p();const t=new CustomEvent("globalPlayerNext");window.dispatchEvent(t)},N=()=>{w();const t=new CustomEvent("globalPlayerClose");window.dispatchEvent(t)},B=()=>{C()},_=(t,T)=>{};return(t,T)=>{const b=fe,I=be;return v(),h("div",{class:oe(["min-h-screen bg-bg-color",{"pb-20":r(c)}])},[ae(t.$slots,"default"),r(c)?(v(),ne(b,{key:0,"current-video":r(a),"is-playing":r(y),"can-play-previous":r(f),"can-play-next":r(P),onTogglePlayPause:k,onPrevious:E,onNext:x,onClose:N},null,8,["current-video","is-playing","can-play-previous","can-play-next"])):G("",!0),m(I,{isOpen:r(s),playlist:r(i),initialVideoIndex:r(u),onClose:B,onVideoChange:_},null,8,["isOpen","playlist","initialVideoIndex"])],2)}}});export{Ne as default};
