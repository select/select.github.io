import{_ as O}from"./Bpf3KNyn.js";import{_ as X}from"./DFThldQB.js";import{e as U,c as u,f as w,o as i,a as t,t as f,F as R,r as F,g as b,h as Y,b as E,w as A,d as _,i as K,v as Q,j as l,k as H,n as Z,l as L,m as G,u as W,p as tt,q as et}from"./BffPBOTX.js";import"./DAowvAmj.js";const st={key:0,class:"p-2 rounded text-xs"},at={class:"font-medium text-primary-4 line-clamp-1"},lt={class:"text-primary-3 line-clamp-1"},it={key:0,class:"text-primary-3 line-clamp-1"},nt={key:1,class:"mt-1 flex gap-2 flex-wrap"},ot=["title"],rt=["title"],ct=U({__name:"AdminMusicDataDisplay",props:{songData:{default:void 0}},setup(m){return(g,h)=>m.songData?(i(),u("div",st,[t("div",at,f(m.songData.title),1),t("div",lt,"by "+f(m.songData.artist),1),m.songData.album?(i(),u("div",it,f(m.songData.album),1)):w("",!0),m.songData.tags?.length||m.songData.genres?.length||m.songData.artistTags?.length?(i(),u("div",nt,[(i(!0),u(R,null,F(m.songData.tags?.slice(0,3)||[],e=>(i(),u("span",{key:`song-${e}`,class:"inline-block bg-accent/20 text-black px-1 rounded text-xs mr-1"},f(e),1))),128)),(i(!0),u(R,null,F(m.songData.genres?.slice(0,3)||[],e=>(i(),u("span",{key:`genre-${e}`,class:"inline-block bg-primary-3/30 text-primary-4 px-1 rounded text-xs mr-1",title:`Genre: ${e}`},f(e),9,ot))),128)),(i(!0),u(R,null,F(m.songData.artistTags?.slice(0,2)||[],e=>(i(),u("span",{key:`artist-${e}`,class:"inline-block bg-primary-2/60 text-primary-4 px-1 rounded text-xs mr-1",title:`Artist tag: ${e}`},f(e),9,rt))),128))])):w("",!0)])):w("",!0)}}),dt=Object.assign(ct,{__name:"AdminMusicDataDisplay"}),ut={key:0,class:"space-y-4"},mt={class:"flex items-center justify-between mb-3"},pt={class:"text-sm font-medium text-primary-4"},ht={class:"overflow-x-auto"},ft={class:"w-full border-collapse text-sm"},gt={class:"p-2"},yt=["onUpdate:modelValue","placeholder"],xt={class:"p-2 text-center"},vt={class:"p-2"},_t=["onUpdate:modelValue","placeholder"],bt={class:"p-2"},$t={class:"flex items-center gap-2"},wt={class:"w-12 h-2 bg-primary-1 rounded-full overflow-hidden"},kt={class:"text-xs text-primary-3 font-mono"},Ct={class:"p-2"},At={key:0,class:"text-xs text-primary-3 text-center"},St={key:1,class:"mt-3 p-2 bg-red-500/10 border border-red-500/20 rounded text-xs text-red-400 text-center"},Mt=U({__name:"AdminSearchForm",props:{parsedTitles:{default:void 0},videoId:{}},emits:["searchComplete","searchError","cancel"],setup(m,{emit:g}){const h=m,e=g,a=b(null),r=b(null),$=b([]);Y(()=>{h.parsedTitles&&($.value=h.parsedTitles.map(y=>({artist:y.artist,title:y.title})))});const T=async y=>{a.value=y;const c=$.value[y];if(!c||!c.artist||!c.title){r.value="Artist and title are required",a.value=null;return}try{const v=await $fetch("/api/musicbrainz/search",{method:"POST",body:{artist:c.artist,title:c.title}});v.success&&v.results?.length>0?(r.value=null,e("searchComplete",v.results)):(r.value="No search results found",e("searchError","No search results found"))}catch(v){const M=v instanceof Error?v.message:"Unknown error occurred";r.value=`Search failed: ${M}`,e("searchError",`Search failed: ${M}`)}finally{a.value=null}},x=()=>{r.value=null,e("cancel")},S=y=>{const c=$.value[y];if(c){const v=c.artist;c.artist=c.title,c.title=v}};return(y,c)=>{const v=O;return m.parsedTitles?.length?(i(),u("div",ut,[t("div",mt,[t("h4",pt," Parsed Titles ("+f(m.parsedTitles.length)+" found) ",1),E(v,{size:"small",variant:"ghost",class:"text-xs",onClick:x},{default:A(()=>[...c[2]||(c[2]=[_(" Cancel ",-1)])]),_:1})]),t("div",ht,[t("table",ft,[c[8]||(c[8]=t("thead",null,[t("tr",{class:"border-b border-primary-2/50"},[t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Artist "),t("th",{class:"text-center p-2 font-medium text-primary-4 text-xs w-12"}),t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Title "),t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Confidence "),t("th",{class:"text-left p-2 font-medium text-primary-4 text-xs"}," Action ")])],-1)),t("tbody",null,[(i(!0),u(R,null,F(m.parsedTitles,(M,D)=>(i(),u("tr",{key:D,class:"border-b border-primary-2/30 hover:bg-bg-gradient transition-colors"},[t("td",gt,[K(t("input",{"onUpdate:modelValue":P=>l($)[D].artist=P,class:"w-full bg-transparent border border-primary-2/50 rounded px-2 py-1 text-primary-4 text-xs focus:border-accent focus:outline-none",placeholder:M.artist,"data-input":"",onKeydown:c[0]||(c[0]=H(()=>{},["stop"]))},null,40,yt),[[Q,l($)[D].artist]])]),t("td",xt,[E(v,{size:"small",variant:"ghost",class:"!p-1 !min-w-0 hover:bg-accent/20",title:"Swap artist and title",onClick:P=>S(D)},{default:A(()=>[...c[3]||(c[3]=[t("div",{class:"i-mdi-swap-horizontal text-xs"},null,-1)])]),_:1},8,["onClick"])]),t("td",vt,[K(t("input",{"onUpdate:modelValue":P=>l($)[D].title=P,class:"w-full bg-transparent border border-primary-2/50 rounded px-2 py-1 text-primary-3 text-xs focus:border-accent focus:outline-none",placeholder:M.title,"data-input":"",onKeydown:c[1]||(c[1]=H(()=>{},["stop"]))},null,40,_t),[[Q,l($)[D].title]])]),t("td",bt,[t("div",$t,[t("div",wt,[t("div",{class:"h-full bg-accent rounded-full transition-all",style:Z({width:`${M.confidence*100}%`})},null,4)]),t("span",kt,f(Math.round(M.confidence*100))+"% ",1)])]),t("td",Ct,[E(v,{size:"small",variant:"primary",disabled:l(a)===D,class:"text-xs",onClick:P=>T(D)},{default:A(()=>[l(a)===D?(i(),u(R,{key:0},[c[4]||(c[4]=t("div",{class:"i-mdi-loading animate-spin mr-1"},null,-1)),c[5]||(c[5]=_(" Searching... ",-1))],64)):(i(),u(R,{key:1},[c[6]||(c[6]=t("div",{class:"i-mdi-magnify mr-1"},null,-1)),c[7]||(c[7]=_(" Search ",-1))],64))]),_:2},1032,["disabled","onClick"])])]))),128))])])]),l(a)!==null?(i(),u("div",At,' Searching MusicBrainz for "'+f(m.parsedTitles[l(a)]?.artist)+" - "+f(m.parsedTitles[l(a)]?.title)+'"... ',1)):w("",!0),l(r)?(i(),u("div",St,f(l(r)),1)):w("",!0)])):w("",!0)}}}),Dt=Object.assign(Mt,{__name:"AdminSearchForm"}),Et={key:0,class:"space-y-2"},Tt=["onClick"],Vt={class:"text-xs font-medium text-primary-4 line-clamp-1"},Rt={class:"text-xs text-primary-3 line-clamp-1"},Pt={class:"flex justify-between items-center mt-1"},zt={class:"text-xs text-primary-3"},Lt={class:"text-xs text-accent"},Ft=U({__name:"AdminSearchResultsSelection",props:{videoId:{},searchResults:{default:void 0}},emits:["matchComplete","matchError","cancel"],setup(m,{emit:g}){const h=m,e=g,a=b(!1),r=async T=>{a.value=!0;try{const x=await $fetch("/api/musicbrainz/match",{method:"POST",body:{videoId:h.videoId,selectedMbid:T}});x.success&&x.data?e("matchComplete",x.data):e("matchError","Failed to match recording")}catch(x){const S=x instanceof Error?x.message:"Unknown error occurred";e("matchError",`Error matching recording: ${S}`)}finally{a.value=!1}},$=()=>{e("cancel")};return(T,x)=>{const S=O;return m.searchResults?.length?(i(),u("div",Et,[x[2]||(x[2]=t("div",{class:"text-xs font-medium text-primary-4 mb-2"}," Select best match: ",-1)),(i(!0),u(R,null,F(m.searchResults.slice(0,3),y=>(i(),u("div",{key:y.id,class:G(["bg-primary-2 p-2 rounded cursor-pointer hover:bg-primary-3/20 transition-colors",{"opacity-50 pointer-events-none":l(a)}]),onClick:c=>r(y.id)},[t("div",Vt,f(y.title),1),t("div",Rt," by "+f(y.artist),1),t("div",Pt,[t("span",zt,f(y.releaseCount)+" release"+f(y.releaseCount!==1?"s":""),1),t("span",Lt,f(y.score)+"%",1)])],10,Tt))),128)),l(a)?(i(),L(S,{key:0,size:"small",variant:"ghost",disabled:"",class:"text-xs"},{default:A(()=>[...x[0]||(x[0]=[_(" Matching... ",-1)])]),_:1})):(i(),L(S,{key:1,size:"small",variant:"ghost",class:"text-xs",onClick:$},{default:A(()=>[...x[1]||(x[1]=[_(" Cancel ",-1)])]),_:1}))])):w("",!0)}}}),Ut=Object.assign(Ft,{__name:"AdminSearchResultsSelection"});function C(m){return m.replace(/\s*\((Original\s+Mix|Radio\s+Edit|Extended\s+Mix|Club\s+Mix|Remix|Remaster|Remastered|Version)\)\s*/gi,"").replace(/\s*[-–~|:]\s*$/,"").replace(/^\s*[-–~|:]\s*/,"").replace(/\s*[()\[\]{}]\s*$/,"").replace(/^\s*[()\[\]{}]\s*/,"").replace(/\s*[,;.!?]\s*$/,"").replace(/\s*[-–~|:]\s*[-–~|:]\s*/g," - ").replace(/\s+/g," ").trim()}function jt(m){const g=[],h=Ot(m);let e=h.match(/^(.+?)\s*[-–]\s*([^-–]+?)(?:\s*[-–].*)?$/);if(e&&e[1]&&e[2]){const[,a,r]=e;g.push({artist:C(a),title:C(r),confidence:.9})}if(e=h.match(/^(.+?)\s*~\s*(.+?)(?:\s*~.*)?$/),e&&e[1]&&e[2]){const[,a,r]=e;g.push({artist:C(a),title:C(r),confidence:.85})}if(e=h.match(/^([^-]+?)\s*-\s*([^-]+?)(?:\s*-.*)?$/),e&&e[1]&&e[2]){const[,a,r]=e,$=["live","version","remix","cover","acoustic","instrumental","edit","remaster","demo","alternate","extended","radio","single"],T=["feat","ft","featuring","vs","x","with","and","&"],x=$.some(v=>a.toLowerCase().includes(v)),S=T.some(v=>r.toLowerCase().includes(v)),y=r.length<25&&r.split(" ").length<=3&&!/[()[\]]/.test(r);(x||y&&!S&&r.length<a.length*.7)&&g.push({artist:C(r),title:C(a),confidence:.75})}if(e=h.match(/^(.+?)\s*:\s*(.+)$/),e&&e[1]&&e[2]){const[,a,r]=e;g.push({artist:C(a),title:C(r),confidence:.8})}if(e=h.match(/^(.+?)\s*\|\s*([^|]+?)(?:\s*\|.*)?$/),e&&e[1]&&e[2]){const[,a,r]=e;g.push({artist:C(a),title:C(r),confidence:.8})}if(e=h.match(/^(.+?)\s*["'"](.+?)["'"].*$/),e&&e[1]&&e[2]){const[,a,r]=e;g.push({artist:C(a),title:C(r),confidence:.85})}if(e=h.match(/^(.+?)\s+([A-Z\s]{3,})(?:\s|$)/),e&&e[1]&&e[2]){const[,a,r]=e;r.trim().split(" ").length<=5&&g.push({artist:C(a),title:C(r),confidence:.7})}return g.length===0&&g.push({artist:"Unknown Artist",title:C(h||m),confidence:.1}),g.sort((a,r)=>r.confidence-a.confidence)}function Ot(m){return m.replace(/\s*\[Official Music Video\]/gi,"").replace(/\s*\[4K Remaster\]/gi,"").replace(/\s*\[(Official|Music|Video|Audio|Lyric|Live|HD|4K|HQ|MV)\s?(Video|Audio|Music|Performance|MV)?\]/gi,"").replace(/\s*\((Official|Music|Video|Audio|Lyric|Live|HD|4K|HQ|MV)\s?(Video|Audio|Music|Performance|MV)?\)/gi,"").replace(/\s*\(\d{4}\)/g,"").replace(/\s*\/\d{4}\/\s*/g,"").replace(/\s*\((Stereo|Mono|Remastered?|Remaster|\d{4}\s*Remaster(ed)?)\)/gi,"").replace(/\s*\[(Stereo|Mono|Remastered?|Remaster|\d{4}\s*Remaster(ed)?)\]/gi,"").replace(/\s*\b(HD|4K|1080p|720p|HQ|High Quality)\b/gi,"").replace(/\s*[fF]t\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*[Ff]eat\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*[Ff]eaturing\.?\s+[^-~|:]+?(?=\s*[-~|:]|$)/g,"").replace(/\s*\([^)]*\)/g,"").replace(/\s+/g," ").trim()}function It(m){return C(m.replace(/\s*(Official|Music|VEVO|Records|Entertainment)$/gi,"").replace(/\s*-.*$/,"").trim())}const Nt={class:"rounded-lg shadow-sm"},Bt={class:"flex items-center justify-between mb-4"},Ht={class:"text-lg font-semibold flex items-center gap-2"},Kt={key:0,class:"text-center py-8"},Qt={key:1,class:"overflow-x-auto"},Yt={class:"w-full border-collapse"},qt={class:"border-b border-primary-2/30 hover:bg-bg-gradient transition-colors"},Jt={class:"p-3"},Xt={class:"flex items-center gap-3"},Zt={class:"flex-shrink-0"},Gt=["src","alt"],Wt={class:"flex-1 min-w-0"},te={class:"font-medium text-primary-4 line-clamp-2 text-sm"},ee=["href"],se={class:"p-3"},ae={class:"text-sm text-primary-3"},le={class:"p-3"},ie={class:"text-sm text-primary-3 font-mono"},ne={class:"p-3"},oe={class:"min-w-48"},re={key:0,class:"text-xs text-primary-3"},ce={class:"p-3"},de={class:"flex flex-wrap items-center gap-2"},ue={key:0,class:"border-b border-primary-2/30"},me={colspan:"5",class:"p-3 space-y-4"},pe=U({__name:"AdminVideoList",props:{videos:{default:()=>[]}},setup(m){const g=m,h=b({}),e=b({}),a=b({}),r=b({}),$=async()=>{for(const d of g.videos)try{const o=await $fetch(`/api/songs/${d.id}`);o.success&&o.data&&(h.value[d.id]=o.data)}catch{}};Y(async()=>{await $()});const T=(d,o)=>{h.value[d]=o,delete e.value[d],delete a.value[d]},x=d=>{console.error("Match error:",d)},S=(d,o)=>{e.value[d]=o},y=d=>{console.error("Search error:",d)},c=d=>{delete e.value[d],delete a.value[d]},v=d=>{const o=jt(d.title);if(o.length===0||o.length===1&&o[0]&&o[0].confidence<=.1){const z={artist:It(d.channel)||"Unknown Artist",title:d.title,confidence:.2};o.length===0?o.push(z):o[0]=z}a.value[d.id]=o},M=d=>{delete a.value[d]},D=d=>{delete h.value[d],delete e.value[d],delete a.value[d]},P=async d=>{try{r.value[d]=!0;const o=await $fetch("/api/musicbrainz/artist-tags",{method:"POST",body:{youtubeId:d}});o.success&&o.data&&(h.value[d]=o.data)}catch(o){console.error("Error fetching artist tags:",o)}finally{delete r.value[d]}};return(d,o)=>{const j=dt,z=O,I=Dt,N=Ut;return i(),u("div",Nt,[t("div",Bt,[t("h3",Ht,[o[2]||(o[2]=t("div",{class:"i-mdi-playlist-music"},null,-1)),_(" Video List ("+f(m.videos.length)+" videos) ",1)])]),m.videos.length?(i(),u("div",Qt,[t("table",Yt,[o[7]||(o[7]=t("thead",null,[t("tr",{class:"border-b border-primary-2"},[t("th",{class:"text-left p-3 font-medium text-primary-4"},"Video"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Channel"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Duration"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Music Data"),t("th",{class:"text-left p-3 font-medium text-primary-4"},"Actions")])],-1)),t("tbody",null,[(i(!0),u(R,null,F(m.videos,p=>(i(),u(R,{key:p.id},[t("tr",qt,[t("td",Jt,[t("div",Xt,[t("div",Zt,[t("img",{src:`https://i.ytimg.com/vi/${p.id}/hqdefault.jpg`,alt:p.title,class:"w-12 h-12 rounded-full object-cover bg-primary-1"},null,8,Gt)]),t("div",Wt,[t("h4",te,f(p.title),1),t("a",{href:`https://www.youtube.com/watch?v=${p.id}`,target:"_blank",rel:"noopener noreferrer",class:"text-xs text-primary-3 hover:text-accent transition-colors"}," Watch on YouTube ",8,ee)])])]),t("td",se,[t("span",ae,f(p.channel),1)]),t("td",le,[t("span",ie,f(p.duration),1)]),t("td",ne,[t("div",oe,[E(j,{"song-data":l(h)[p.id]},null,8,["song-data"]),!l(h)[p.id]&&!l(e)[p.id]?.length&&!l(a)[p.id]?.length?(i(),u("div",re)):w("",!0)])]),t("td",ce,[t("div",de,[!l(h)[p.id]&&!l(a)[p.id]?.length?(i(),L(z,{key:0,icon:"i-mdi-text-search",size:"small",variant:"ghost",onClick:n=>v(p)},{default:A(()=>[...o[4]||(o[4]=[_(" Search ",-1)])]),_:1},8,["onClick"])):w("",!0),l(h)[p.id]&&!l(h)[p.id]?.artistTags?.length&&!l(h)[p.id]?.tags?.length?(i(),L(z,{key:1,icon:"i-mdi-tag-plus",size:"small",variant:"ghost",disabled:l(r)[p.id],onClick:n=>P(p.id)},{default:A(()=>[...o[5]||(o[5]=[_(" Add Artist Tags ",-1)])]),_:1},8,["disabled","onClick"])):w("",!0),l(h)[p.id]?(i(),L(z,{key:2,icon:"i-mdi-delete",size:"small",variant:"ghost",onClick:n=>D(p.id)},{default:A(()=>[...o[6]||(o[6]=[_(" Clear ",-1)])]),_:1},8,["onClick"])):w("",!0)])])]),l(a)[p.id]?.length||l(e)[p.id]?.length?(i(),u("tr",ue,[t("td",me,[l(a)[p.id]?.length?(i(),L(I,{key:0,"video-id":p.id,"parsed-titles":l(a)[p.id],onSearchComplete:n=>S(p.id,n),onSearchError:o[0]||(o[0]=n=>y(n)),onCancel:n=>M(p.id)},null,8,["video-id","parsed-titles","onSearchComplete","onCancel"])):w("",!0),l(e)[p.id]?.length?(i(),L(N,{key:1,"video-id":p.id,"search-results":l(e)[p.id],onMatchComplete:n=>T(p.id,n),onMatchError:o[1]||(o[1]=n=>x(n)),onCancel:n=>c(p.id)},null,8,["video-id","search-results","onMatchComplete","onCancel"])):w("",!0)])])):w("",!0)],64))),128))])])])):(i(),u("div",Kt,[...o[3]||(o[3]=[t("div",{class:"i-mdi-video-outline text-4xl mb-2"},null,-1),t("p",{class:""},"No videos found in this playlist.",-1)])]))])}}}),he=Object.assign(pe,{__name:"AdminVideoList"}),fe={class:"p-8 max-w-6xl mx-auto"},ge={class:"flex items-center justify-between mb-8"},ye={class:"flex flex-col gap-6"},xe={class:"rounded-lg mb-8 shadow-sm"},ve={key:0,class:"rounded-lg p-4 mb-8"},_e={class:"flex items-center gap-2"},be={key:1,class:"rounded-lg p-4 mb-8"},$e={class:"flex items-center gap-2"},we={class:"rounded-lg shadow-sm"},ke={class:"flex items-center justify-between mb-4"},Ce={key:0,class:"text-center py-8"},Ae={key:1,class:"text-center py-8"},Se={key:2,class:"space-y-4"},Me={class:"flex-1"},De={class:"font-medium text-primary-3"},Ee={class:"text-sm"},Te={key:0,class:"text-xs mt-1 line-clamp-2"},Ve={class:"flex items-center gap-2 ml-4"},Re={key:2,class:"rounded-lg shadow-sm"},Pe={class:"flex items-center justify-between mb-4"},ze={class:"text-xl font-semibold flex items-center gap-2"},Le={key:0,class:"text-center py-8"},Fe={key:2,class:"text-center py-8"},Ne=U({__name:"admin",setup(m){W({title:"Admin Panel - Music Playlist View",meta:[{name:"description",content:"Manage your YouTube playlists"}]});const g=b(""),h=b(!1),e=b(""),a=b(""),r=b([]),$=b(!0),T=b(null),x=b(null),S=b(null),y=b(null),c=b(null),v=b([]),M=b(!1);tt(async()=>{await d()});const D=n=>{const s=n.trim(),V=s.match(/[?&]list=([a-zA-Z0-9_-]+)/);return V&&V[1]?V[1]:s},P=async()=>{if(g.value.trim()){h.value=!0,e.value="",a.value="";try{const n=D(g.value);if(!n)throw new Error("Invalid playlist ID or URL");const s=await $fetch(`/api/playlists/${n}`);if(s.success)a.value=`Successfully loaded playlist: ${s.data.title}`,g.value="",await d();else throw new Error("Failed to fetch playlist")}catch(n){console.error("Error fetching playlist:",n),e.value=n.data?.message||n.message||"Failed to fetch playlist. Please check the playlist ID and try again."}finally{h.value=!1}}},d=async()=>{try{$.value=!0;const n=await $fetch("/index.json");n.success&&(r.value=n.data)}catch(n){console.error("Error loading cached playlists:",n)}finally{$.value=!1}},o=async n=>{try{T.value=n;const s=await $fetch(`/api/playlists/${n}`);s.success&&(await d(),a.value=`Successfully updated playlist: ${s.data.title}`,e.value="")}catch(s){console.error("Error refreshing playlist:",s),e.value="Failed to refresh playlist",a.value=""}finally{T.value=null}},j=async n=>{if(confirm("Are you sure you want to delete this cached playlist?"))try{x.value=n,await $fetch(`/api/playlists/${n}`,{method:"DELETE"}),await d(),a.value="Successfully deleted cached playlist",e.value=""}catch(s){console.error("Error deleting playlist:",s),e.value="Failed to delete playlist",a.value=""}finally{x.value=null}},z=n=>new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),I=async n=>{try{S.value=n.id,M.value=!0;const s=await $fetch(`/playlist/${n.fileName}`);if(s)c.value=n,v.value=s.videos||[];else throw new Error("Failed to load playlist videos")}catch(s){console.error("Error loading playlist for editing:",s),e.value="Failed to load playlist videos",a.value=""}finally{S.value=null,M.value=!1}},N=()=>{c.value=null,v.value=[]},p=async n=>{try{y.value=n,e.value="",a.value="";const s=await $fetch("/api/playlists/update-data",{method:"POST",body:{playlistId:n}});if(s.success)a.value=s.message,await d();else throw new Error("Failed to update playlist music data")}catch(s){console.error("Error updating playlist music data:",s),e.value=s.data?.message||s.message||"Failed to update playlist music data",a.value=""}finally{y.value=null}};return(n,s)=>{const V=O,q=X,J=he;return i(),u("div",fe,[t("div",ge,[s[2]||(s[2]=t("h1",{class:"text-3xl font-bold flex items-center gap-3"},[t("div",{class:"i-mdi-cog"}),_(" Admin Panel ")],-1)),E(V,{icon:"i-mdi-arrow-left",variant:"primary",to:"/"},{default:A(()=>[...s[1]||(s[1]=[_(" Back to Playlists ",-1)])]),_:1})]),t("div",ye,[t("div",xe,[s[3]||(s[3]=t("h2",{class:"text-xl font-semibold mb-4 flex items-center gap-2"},[t("div",{class:"i-mdi-plus"}),_(" Add New Playlist ")],-1)),t("form",{class:"space-y-4",onSubmit:H(P,["prevent"])},[E(q,{id:"playlistId",modelValue:l(g),"onUpdate:modelValue":s[0]||(s[0]=k=>et(g)?g.value=k:null),label:"YouTube Playlist ID or URL",placeholder:"Enter playlist ID (e.g., PLrAXtmRdnEQy8VVXvSgb5eKzwJJxd0FMz) or full URL",class:"max-w-xl","help-text":"You can paste either the playlist ID or the full YouTube playlist URL",disabled:l(h),required:""},null,8,["modelValue","disabled"]),E(V,{type:"submit",icon:"i-mdi-download",size:"medium",disabled:!l(g).trim(),loading:l(h),"show-text-while-loading":!0},{default:A(()=>[_(f(l(h)?"Loading...":"Load Playlist"),1)]),_:1},8,["disabled","loading"])],32)]),l(a)?(i(),u("div",ve,[t("div",_e,[s[4]||(s[4]=t("div",{class:"i-mdi-check-circle"},null,-1)),s[5]||(s[5]=t("strong",null,"Success:",-1)),_(" "+f(l(a)),1)])])):w("",!0),l(e)?(i(),u("div",be,[t("div",$e,[s[6]||(s[6]=t("div",{class:"i-mdi-alert-circle"},null,-1)),s[7]||(s[7]=t("strong",null,"Error:",-1)),_(" "+f(l(e)),1)])])):w("",!0),t("div",we,[t("div",ke,[s[9]||(s[9]=t("h2",{class:"text-xl font-semibold flex items-center gap-2"},[t("div",{class:"i-mdi-playlist-play"}),_(" Cached Playlists ")],-1)),E(V,{icon:"i-mdi-refresh",size:"small",loading:l($),onClick:d},{default:A(()=>[...s[8]||(s[8]=[_(" Refresh ",-1)])]),_:1},8,["loading"])]),l($)?(i(),u("div",Ce,[...s[10]||(s[10]=[t("div",{class:"i-mdi-loading animate-spin text-2xl mb-2"},null,-1),t("p",{class:""},"Loading cached playlists...",-1)])])):l(r).length?(i(),u("div",Se,[(i(!0),u(R,null,F(l(r),k=>(i(),u("div",{key:k.id,class:"flex items-center justify-between rounded-lg hover:bg-bg-gradient py-6"},[t("div",Me,[t("h3",De,f(k.title),1),t("p",Ee,f(k.videoCount)+" videos • Last updated: "+f(z(k.lastFetched)),1),k.description?(i(),u("p",Te,f(k.description),1)):w("",!0)]),t("div",Ve,[E(V,{icon:"i-mdi-database-plus",size:"small",variant:"primary",loading:l(y)===k.id,onClick:B=>p(k.id)},{default:A(()=>[...s[12]||(s[12]=[_(" Update All Music Data ",-1)])]),_:1},8,["loading","onClick"]),E(V,{icon:"i-mdi-pencil",size:"small",variant:"secondary",loading:l(S)===k.id,onClick:B=>I(k)},{default:A(()=>[...s[13]||(s[13]=[_(" Edit ",-1)])]),_:1},8,["loading","onClick"]),E(V,{icon:"i-mdi-refresh",size:"small",loading:l(T)===k.id,onClick:B=>o(k.id)},{default:A(()=>[...s[14]||(s[14]=[_(" Update ",-1)])]),_:1},8,["loading","onClick"]),E(V,{icon:"i-mdi-delete",size:"small",variant:"danger",loading:l(x)===k.id,onClick:B=>j(k.id)},{default:A(()=>[...s[15]||(s[15]=[_(" Delete ",-1)])]),_:1},8,["loading","onClick"])])]))),128))])):(i(),u("div",Ae,[...s[11]||(s[11]=[t("div",{class:"i-mdi-playlist-remove text-4xl mb-2"},null,-1),t("p",{class:""},"No cached playlists found.",-1)])]))]),l(c)?(i(),u("div",Re,[t("div",Pe,[t("h2",ze,[s[16]||(s[16]=t("div",{class:"i-mdi-pencil"},null,-1)),_(" Editing: "+f(l(c).title),1)]),E(V,{icon:"i-mdi-close",size:"small",variant:"ghost",onClick:N},{default:A(()=>[...s[17]||(s[17]=[_(" Close ",-1)])]),_:1})]),l(M)?(i(),u("div",Le,[...s[18]||(s[18]=[t("div",{class:"i-mdi-loading animate-spin text-2xl mb-2"},null,-1),t("p",{class:""},"Loading playlist videos...",-1)])])):l(v).length?(i(),L(J,{key:1,videos:l(v)},null,8,["videos"])):(i(),u("div",Fe,[...s[19]||(s[19]=[t("div",{class:"i-mdi-video-off text-4xl mb-2"},null,-1),t("p",{class:""},"No videos found in this playlist.",-1)])]))])):w("",!0)])])}}});export{Ne as default};
